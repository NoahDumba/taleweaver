{"version":3,"sources":["../../../packages/core/dist/tw/util/id.js","../../../packages/core/dist/tw/event/emitter.js","../../../packages/core/dist/tw/command/registry.js","../../../packages/core/dist/tw/command/service.js","../../../packages/core/dist/tw/tree/node-list.js","../../../packages/core/dist/tw/tree/node.js","../../../packages/core/dist/tw/view/node.js","../../../packages/core/dist/tw/view/line.js","../../../packages/core/dist/tw/component/line-component.js","../../../packages/core/dist/tw/component/components/line.js","../../../packages/core/dist/tw/view/page.js","../../../packages/core/dist/tw/component/page-component.js","../../../packages/core/dist/tw/component/components/page.js","../../../packages/core/dist/tw/component/registry.js","../../../packages/core/dist/tw/component/service.js","../../../packages/core/dist/tw/config/service.js","../../../packages/core/dist/tw/command/handlers/clipboard.js","../../../packages/core/dist/tw/util/dom.js","../../../packages/core/dist/tw/layout/position.js","../../../packages/core/dist/tw/transform/transformation.js","../../../packages/core/dist/tw/command/handlers/cursor.js","../../../packages/core/dist/tw/command/handlers/history.js","../../../packages/core/dist/tw/model/change/change.js","../../../packages/core/dist/tw/model/change/mapping.js","../../../packages/core/dist/tw/model/change/apply-attribute.js","../../../packages/core/dist/tw/model/change/replace.js","../../../packages/core/dist/tw/command/handlers/state.js","../../../packages/core/dist/tw/command/handlers/view.js","../../../packages/core/dist/tw/model/node.js","../../../packages/core/dist/tw/model/root.js","../../../packages/core/dist/tw/render/node.js","../../../packages/core/dist/tw/render/doc.js","../../../packages/core/dist/tw/view/doc.js","../../../packages/core/dist/tw/component/component.js","../../../packages/core/dist/tw/component/components/doc.js","../../../packages/core/dist/tw/model/branch.js","../../../packages/core/dist/tw/render/block.js","../../../packages/core/dist/tw/render/text.js","../../../packages/core/dist/tw/text/service.js","../../../packages/core/dist/tw/view/block.js","../../../packages/core/dist/tw/view/text.js","../../../packages/core/dist/tw/component/components/paragraph.js","../../../packages/core/dist/tw/model/leaf.js","../../../packages/core/dist/tw/component/components/text.js","../../../packages/core/dist/tw/config/util.js","../../../packages/core/dist/tw/cursor/state.js","../../../packages/core/dist/tw/cursor/service.js","../../../packages/core/dist/tw/dom/service.js","../../../packages/core/dist/tw/history/action.js","../../../packages/core/dist/tw/history/state.js","../../../packages/core/dist/tw/history/service.js","../../../packages/core/dist/tw/util/platform.js","../../../packages/core/dist/tw/key-binding/service.js","../../../packages/core/dist/tw/layout/node.js","../../../packages/core/dist/tw/layout/atom.js","../../../packages/core/dist/tw/layout/block.js","../../../packages/core/dist/tw/layout/doc.js","../../../packages/core/dist/tw/layout/line.js","../../../packages/core/dist/tw/layout/page.js","../../../packages/core/dist/tw/layout/text.js","../../../packages/core/dist/tw/layout/word.js","../../../packages/core/dist/tw/layout/engine.js","../../../packages/core/dist/tw/layout/state.js","../../../packages/core/dist/tw/layout/service.js","../../../packages/core/dist/tw/model/state.js","../../../packages/core/dist/tw/model/service.js","../../../packages/core/dist/tw/render/state.js","../../../packages/core/dist/tw/render/service.js","../../../packages/core/dist/tw/service/registry.js","../../../packages/core/dist/tw/transform/service.js","../../../packages/core/dist/tw/view/cursor.js","../../../packages/core/dist/tw/view/clipboard-observer.js","../../../packages/core/dist/tw/view/focus-observer.js","../../../packages/core/dist/tw/view/keyboard-observer.js","../../../packages/core/dist/tw/view/pointer-observer.js","../../../packages/core/dist/tw/view/dom-controller.js","../../../packages/core/dist/tw/view/state.js","../../../packages/core/dist/tw/view/service.js","../../../packages/core/dist/tw/taleweaver.js","Editor/ToolBar.tsx","Editor/Editor.tsx","Editor/index.ts","../../../packages/core/dist/tw/util/serialize.js","samples/littleRedRidingHood.ts","App.tsx","serviceWorker.ts","index.tsx"],"names":["bytes16","Uint8Array","generateId","Buffer","from","String","fromCharCode","apply","Array","crypto","randomFillSync","toString","EventEmitter","this","listeners","prototype","on","listener","_this","push","dispose","index","indexOf","splice","emit","event","forEach","CommandRegistry","commandsMap","Map","registerCommand","commandId","commandHandler","set","getCommandHandler","get","__awaiter","thisArg","_arguments","P","generator","Promise","resolve","reject","fulfilled","value","step","next","e","rejected","result","done","then","__generator","body","f","y","t","g","_","label","sent","trys","ops","verb","Symbol","iterator","n","v","op","TypeError","call","pop","length","__spreadArrays","s","i","il","arguments","r","k","a","j","jl","CommandService","configService","serviceRegistry","willExecuteCommandEventEmitter","didExecuteCommandEventEmitter","registry","_i","_a","Object","entries","getConfig","commands","_b","onWillExecuteCommand","onDidExecuteCommand","executeCommand","args","NodeList","nodes","defineProperty","enumerable","configurable","at","Error","node","findIndex","id","callbackFn","map","reduce","initialValue","filter","callbackfn","slice","start","end","find","Node","parent","internalChildren","children","siblings","ownIndex","previousSibling","root","parentPreviousSibling","previousCrossParentSibling","lastChild","nextSibling","parentNextSibling","nextCrossParentSibling","firstChild","findDescendant","leaf","nn","boundOffset","offset","Math","min","contentLength","max","__extends","extendStatics","d","b","setPrototypeOf","__proto__","p","hasOwnProperty","__","constructor","create","ViewNode","_super","domContainer","componentId","renderId","layoutId","text","style","domService","child","undefined","internalSize","size","ViewLine","LineComponent","width","height","paddingTop","paddingBottom","paddingLeft","paddingRight","innerHTML","appendChild","AbstractViewLine","buildViewNode","getService","AbstractLineComponent","ViewPage","PageComponent","position","marginLeft","marginRight","domContentContainer","findOrCreateDOMContentContainer","setAttribute","getAttribute","createElement","AbstractViewPage","AbstractPageComponent","ComponentRegistry","componentsMap","registerComponent","component","registerPageComponent","pageComponent","registerLineComponent","lineComponent","getComponent","getPageComponent","getLineComponent","ComponentService","components","Component","convertModelToDOM","to","fromOffset","toOffset","toDOM","partId","attributes","substring","domChildren","ConfigService","config","externalConfig","applyExternalConfig","coreConfig","page","iframe","window","document","scrolling","src","border","zIndex","opacity","overflow","left","top","createHiddenIframe","copy","cursorService","modelService","renderService","componentService","anchor","head","html","iframeDocument","hasCursor","getCursor","getRoot","resolvePosition","convertRenderToModelPosition","outerHTML","contentDocument","execCommand","paste","atLine","type","atWord","Transformation","changes","modelCursorHead","modelCursorAnchor","keepLeftLock","layoutService","originalCursorModelAnchor","originalCursorModelHead","changeResults","applyChanges","cursorAnchor","cursorHead","convertModelToRenderPosition","setCursor","_c","line","linePosition","setLeftLock","resolveBoundingBoxes","boundingBoxes","reverseChanges","reverseMappings","changeResult","reverseChange","reverseMapping","mapping","reverse","TransformationResult","mappings","_loop_1","change","shift","applyChange","c","getDocSize","transformation","reverseTransformation","atPreviousLine","leftLock","previousLine","convertCoordinatesToPosition","atNextLine","nextLine","atPreviousWord","word","wordPosition","previousWord","atNextWord","whitespaceSize","nextWord","atLineStart","atLineEnd","move","transformService","modelOffset","applyTransformation","moveBackward","newModelPosition","newPosition","moveForward","moveBackwardByLine","moveForwardByLine","moveBackwardByWord","moveForwardByWord","moveToLineStart","moveToLineEnd","moveToDocStart","moveToDocEnd","moveHead","modelAnchor","newModelHead","moveHeadBackward","moveHeadForward","moveHeadBackwardByLine","newHead","moveHeadForwardByLine","moveHeadBackwardByWord","moveHeadForwardByWord","moveHeadToLineStart","moveHeadToLineEnd","moveHeadToDocStart","moveHeadToDocEnd","selectAll","newModelAnchor","selectWord","newAnchor","selectBlock","block","blockPosition","atBlock","undo","redo","ModelChange","Mapping","descs","desc","internalMap","toBefore","toAfter","isPositionGreaterThanOrEqualTo","position1","position2","console","log","identity","ApplyAttribute","key","applyNode","originalValue","applyAttribute","Remover","ran","run","remove","replace","removed","joinedChildrenAt","joinNodes","removedChildFragment","node1","node2","Inserter","fragment","internalInsertedTo","insertedTo","insert","trimEnds","insertAt","fragmentDepth","ceil","positionDepth","beforeContents","afterContents","childInsertedExtra","splitAt","splitNode","child1","child2","contents","mergeContents","resolvedFrom","fromLeaf","removeNode","mapFrom","mapToBefore","resolvedTo","toLeaf","previousLeaf","content2","buildModelNode","mergedContent","content","concat","ReplaceChange","correctPosition","inserter","resolvedOffset","__assign","assign","findNodesByComponentIdAndPartId","results","cloneNodeWithAttribute","attributeKey","attributeValue","textFrom","textTo","cumulatedOffset","childFrom","childTo","modelFrom","modelTo","newModelOffset","deleteBackward","deleteForward","breakLine","findResults","nodePosition","nodeFrom","nodeTo","depth","currentNode","getNodeEdgeDepth","unshift","applyAttributeAround","buildModelPosition","focus","requestFocus","blur","requestBlur","ModelNode","internalNeedRender","childDidUpdateDisposableMap","didUpdateEventEmitter","handleChildDidUpdate","internalText","onDidUpdate","canJoin","clearNeedRender","replacedContent","resolvedPosition","ModelRoot","RenderNode","modelId","internalNeedLayout","clearNeedLayout","cumulatedSize","childSize","modelPosition","renderPosition","nextNonModelSize","m","nextChild","RenderDoc","ViewDoc","attached","ModelDoc","AbstractRenderDoc","textAlign","cursor","userSelect","AbstractViewDoc","DocComponent","buildRenderNode","pageConfig","$element_1","ModelBranch","RenderBlock","RenderText","DEFAULT_FONT","weight","family","letterSpacing","underline","italic","strikethrough","color","BREAKABLE_CHARS","TextService","$canvas","measure","font","fontWithDefault","applyDefaultFont","ctx","getContext","fixFontFamily","measurement","measureText","breakIntoWords","words","char","includes","fontConfigWithDefault","fontFamily","ViewBlock","ViewText","ModelParagraph","RenderParagraph","RenderParagraphLineBreak","ViewParagraph","lineHeight","ViewParagraphLineBreak","ParagraphComponent","ModelLeaf","ModelText","JSON","stringify","textService","AbstractRenderText","display","whiteSpace","fontSize","fontWeight","textDecoration","fontStyle","AbstractViewText","TextComponent","$element","innerText","buildBaseConfig","clipboardCommandHandlers","cursorCommandHandlers","historyCommandHandlers","stateCommandHandlers","viewCommandHandlers","doc","paragraph","disable","caretColor","caretInactiveColor","selectionColor","selectionInactiveColor","history","collapseThreshold","maxCollapseDuration","keyBindings","common","command","preventDefault","right","up","down","backspace","delete","enter","macos","windows","home","linux","CursorState","internalCursor","assertCursor","CursorService","state","DOMService","getWindow","getDocument","getBody","tagName","createContainer","container","createMutationObserver","callback","MutationObserver","HistoryAction","internalTransformationResults","beganAt","Date","now","internalEndedAt","recordTransformationResult","transformationResult","transformationResults","HistoryState","actions","handleDidApplyTransformation","some","tnResult","recordToNewAction","currentItem","endedAt","recordToLastAction","onDidApplyTransformation","action","consumeNextUndoableAction","consumeNextRedoableAction","HistoryService","detectPlatform","navigator","platform","startsWith","KeyBindingService","commandService","viewService","handleDidPressKey","keyBinding","originalKeyboardEvent","keyBindingsConfig","bindKeys","onDidPressKey","binding","LayoutNode","internalNeedView","paddingHorizontal","paddingVertical","clearNeedView","LayoutAtom","x","innerWidth","innerHeight","bottom","LayoutBlock","internalHeight","cumulatedHeight","childHeight","resolvedChildren","childFrom_1","childTo_1","childResult","boundingBox","LayoutDoc","resolvedChild","LayoutLine","internalContentWidth","contentWidth","cumulatedWidth","childWidth","lastWord","left1","left2","box","LayoutPage","internalContentHeight","contentHeight","contentX","contentY","LayoutText","internalWidth","internalTrimmedWidth","trimmedWidth","LayoutWord","trimmedText","lastWidth","width_1","breakAt","LayoutEngine","updateDoc","renderDoc","needLayout","pages","childrenMap","newChildren","updateBlock","buildDoc","reflowPages","blocks","renderBlock","lines","blocks_1","renderChild","updateText","updateAtom","buildBlock","reflowLines","texts","renderText","buildWord","buildText","atoms","renderAtom","buildAtom","newPages","reflowNeeded","currentHeight","nodeChildren","mm","nodeChild","newPage","newLines","currentWidth","newNodeChildren","brokenNodeChild1","brokenNodeChild2","newLine","LayoutState","didUpdateLayoutStateEventEmitter","engine","internalDoc","getDoc","onDidUpdateRenderState","handleDidUpdateRenderStateEvent","onDidUpdateLayoutState","update","LayoutService","ModelState","ModelService","getRootSize","onDidUpdateModelState","RenderState","didUpdateRenderStateEventEmitter","modelRoot","updateNode","handleDidUpdateModelState","modelNode","needRender","modelChild","buildNode","RenderService","resolveFont","_d","_e","_f","_g","_h","resolvedFont","nodeQueue","nodeFont","fontProp","childOffset_1","childIndex","ServiceRegistry","services","registerService","service","TransformService","didApplyTransformationEventEmitter","tn","CursorView","instanceId","blinkInterval","blinkState","domSelections","cursorConfig","domCaret","className","pointerEvents","onDidFocus","handleDidFocus","onDidBlur","handleDidBlur","attach","updateView","clearDOMSelections","headPageId","headLeft","headTop","headHeight","rect","docBoxResult","viewDoc","layoutDoc","focused","isFocused","firstPageId","firstBoxOffset","lastPageId","lastBoxOffset","pageBoxResult","pageOffset","boxOffset","domSelection","buildDOMSelection","background","pageDOMContentContainer","parentElement","removeChild","blinkStop","blinkStart","setInterval","updateDOMBlink","visibility","clearInterval","ClipboardObserver","$contentEditable","didCopyEventEmitter","didPasteEventEmitter","handleCopy","handlePaste","data","clipboardData","addEventListener","onDidCopy","onDidPaste","FocusObserver","didFocusEventEmitter","didBlurEventEmitter","handleFocus","handleBlur","KeyboardObserver","composing","didInsertEventEmitter","didPressKeyEventEmitter","compositionDidStartEventEmitter","compositionDidEndEventEmitter","keyInterpreter","KeyInterpreter","handleDidMutate","setTimeout","handleKeyDown","interpretFromKeyboardEvent","handleCompositionStart","handleCompositionEnd","mutationObserver","observe","subtree","characterData","childList","onDidInsert","onCompositionDidStart","onCompositionDidEnd","toLowerCase","metaKey","altKey","shiftKey","ctrlKey","PointerObserver","clickThreshold","consecutiveClickThreshold","lastPointerDown","lastClick","consecutiveClickCount","pointerDidDownEventEmitter","pointerDidMoveEventEmitter","pointerDidUpEventEmitter","pointerDidClickEventEmitter","handleMouseDown","resolveOffset","clientX","clientY","timestamp","consecutive","handleMouseMove","pointerDown","handleMouseUp","clicked","consecutiveCount","onPointerDidDown","onPointerDidMove","onPointerDidUp","onPointerDidClick","viewPage","layoutPage","pageBoundingClientRect","getBoundingClientRect","pageX","pageY","DOMController","mouseDown","handleDidInsert","handleCompositionDidStart","handleCompositionDidEnd","handlePointerDidDown","handlePointerDidMove","handlePointerDidClick","getData","$container","$body","querySelector","domNodes","createContentEditable","keyboardObserver","pointerObserver","focusObserver","clipboardObserver","isComposing","contentEditable","ViewState","didUpdateViewStateEventEmitter","handleDidUpdateLayoutStateEvent","onDidUpdateViewState","reattachDoc","layoutNode","renderNode","needView","renderChildrenMap","layoutChild","buildPageNode","buildLineNode","join","applyMetadataToDOMContainer","viewNode","ViewService","domController","Taleweaver","historyService","keyBindingService","getServiceRegistry","Wrapper","styled","div","Container","Group","Item","button","disabled","active","SelectItem","select","ItemColorLine","ToolBar","taleweaver","useState","setFont","refreshFront","useCallback","useEffect","onChange","onClick","EditorWrapper","initialDoc","containerRef","useRef","current","setTaleweaver","mergedConfig","internalParse","parse","ref","Hero","BrandWrapper","Brand","span","Tagline","h1","SupportingTagline","h2","Links","Link","DemoHintWrapper","DemoHint","App","React","render","href","sample","Boolean","location","hostname","match","ReactDOM","getElementById","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.5a1a4242.chunk.js","sourcesContent":["import crypto from 'crypto';\nvar bytes16 = new Uint8Array(16);\nfunction generateRandomBytes16() {\n    return crypto.randomFillSync(bytes16);\n}\nexport function generateId() {\n    return Buffer.from(String.fromCharCode.apply(String, Array.from(generateRandomBytes16()))).toString('base64');\n}\n","var EventEmitter = /** @class */ (function () {\n    function EventEmitter() {\n        this.listeners = [];\n    }\n    EventEmitter.prototype.on = function (listener) {\n        var _this = this;\n        this.listeners.push(listener);\n        return {\n            dispose: function () {\n                var index = _this.listeners.indexOf(listener);\n                if (index < 0) {\n                    return;\n                }\n                _this.listeners.splice(index, 1);\n            },\n        };\n    };\n    EventEmitter.prototype.emit = function (event) {\n        this.listeners.forEach(function (listener) { return listener(event); });\n    };\n    return EventEmitter;\n}());\nexport { EventEmitter };\n","var CommandRegistry = /** @class */ (function () {\n    function CommandRegistry() {\n        this.commandsMap = new Map();\n    }\n    CommandRegistry.prototype.registerCommand = function (commandId, commandHandler) {\n        this.commandsMap.set(commandId, commandHandler);\n    };\n    CommandRegistry.prototype.getCommandHandler = function (commandId) {\n        return this.commandsMap.get(commandId);\n    };\n    return CommandRegistry;\n}());\nexport { CommandRegistry };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { EventEmitter } from '../event/emitter';\nimport { CommandRegistry } from './registry';\nvar CommandService = /** @class */ (function () {\n    function CommandService(configService, serviceRegistry) {\n        this.serviceRegistry = serviceRegistry;\n        this.willExecuteCommandEventEmitter = new EventEmitter();\n        this.didExecuteCommandEventEmitter = new EventEmitter();\n        this.registry = new CommandRegistry();\n        for (var _i = 0, _a = Object.entries(configService.getConfig().commands); _i < _a.length; _i++) {\n            var _b = _a[_i], commandId = _b[0], commandHandler = _b[1];\n            this.registry.registerCommand(commandId, commandHandler);\n        }\n    }\n    CommandService.prototype.onWillExecuteCommand = function (listener) {\n        return this.willExecuteCommandEventEmitter.on(listener);\n    };\n    CommandService.prototype.onDidExecuteCommand = function (listener) {\n        return this.didExecuteCommandEventEmitter.on(listener);\n    };\n    CommandService.prototype.executeCommand = function (commandId) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        return __awaiter(this, void 0, void 0, function () {\n            var commandHandler;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        commandHandler = this.registry.getCommandHandler(commandId);\n                        if (!commandHandler) {\n                            return [2 /*return*/];\n                        }\n                        this.willExecuteCommandEventEmitter.emit({ commandId: commandId, args: args });\n                        return [4 /*yield*/, commandHandler.apply(void 0, __spreadArrays([this.serviceRegistry], args))];\n                    case 1:\n                        _a.sent();\n                        this.didExecuteCommandEventEmitter.emit({ commandId: commandId, args: args });\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return CommandService;\n}());\nexport { CommandService };\n","var NodeList = /** @class */ (function () {\n    function NodeList(nodes) {\n        if (nodes === void 0) { nodes = []; }\n        this.nodes = nodes;\n    }\n    Object.defineProperty(NodeList.prototype, \"length\", {\n        get: function () {\n            return this.nodes.length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    NodeList.prototype.at = function (index) {\n        if (index < 0 || index >= this.nodes.length) {\n            throw new Error(\"Index \" + index + \" is out of range.\");\n        }\n        return this.nodes[index];\n    };\n    NodeList.prototype.indexOf = function (node) {\n        return this.nodes.findIndex(function (n) { return n.id === node.id; });\n    };\n    NodeList.prototype.forEach = function (callbackFn) {\n        return this.nodes.forEach(callbackFn);\n    };\n    NodeList.prototype.map = function (callbackFn) {\n        return this.nodes.map(callbackFn);\n    };\n    NodeList.prototype.reduce = function (callbackFn, initialValue) {\n        return this.nodes.reduce(callbackFn, initialValue);\n    };\n    NodeList.prototype.filter = function (callbackfn) {\n        return this.nodes.filter(callbackfn);\n    };\n    NodeList.prototype.slice = function (start, end) {\n        return this.nodes.slice(start, end);\n    };\n    NodeList.prototype.find = function (callbackFn) {\n        return this.nodes.find(callbackFn);\n    };\n    return NodeList;\n}());\nexport { NodeList };\n","import { NodeList } from './node-list';\nvar Node = /** @class */ (function () {\n    function Node(id) {\n        this.id = id;\n        this.parent = null;\n        this.internalChildren = new NodeList();\n    }\n    Object.defineProperty(Node.prototype, \"children\", {\n        get: function () {\n            return this.internalChildren;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Node.prototype, \"firstChild\", {\n        get: function () {\n            if (this.children.length === 0) {\n                return null;\n            }\n            return this.children.at(0);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Node.prototype, \"lastChild\", {\n        get: function () {\n            if (this.children.length === 0) {\n                return null;\n            }\n            return this.children.at(this.children.length - 1);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Node.prototype, \"previousSibling\", {\n        get: function () {\n            if (!this.parent) {\n                return null;\n            }\n            var siblings = this.parent.children;\n            var ownIndex = siblings.indexOf(this);\n            if (ownIndex < 0) {\n                throw new Error('Node is not a child of parent.');\n            }\n            if (ownIndex === 0) {\n                return null;\n            }\n            return siblings.at(ownIndex - 1);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Node.prototype, \"nextSibling\", {\n        get: function () {\n            if (!this.parent) {\n                return null;\n            }\n            var siblings = this.parent.children;\n            var ownIndex = siblings.indexOf(this);\n            if (ownIndex < 0) {\n                throw new Error('Node is not a child of parent.');\n            }\n            if (ownIndex === siblings.length - 1) {\n                return null;\n            }\n            return siblings.at(ownIndex + 1);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Node.prototype, \"previousCrossParentSibling\", {\n        get: function () {\n            var previousSibling = this.previousSibling;\n            if (previousSibling) {\n                return previousSibling;\n            }\n            var parent = this.parent;\n            if (!parent || parent.root) {\n                return null;\n            }\n            var parentPreviousSibling = parent.previousCrossParentSibling;\n            if (!parentPreviousSibling) {\n                return null;\n            }\n            return parentPreviousSibling.lastChild;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(Node.prototype, \"nextCrossParentSibling\", {\n        get: function () {\n            var nextSibling = this.nextSibling;\n            if (nextSibling) {\n                return nextSibling;\n            }\n            var parent = this.parent;\n            if (!parent || parent.root) {\n                return null;\n            }\n            var parentNextSibling = parent.nextCrossParentSibling;\n            if (!parentNextSibling) {\n                return null;\n            }\n            return parentNextSibling.firstChild;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Node.prototype.findDescendant = function (id) {\n        if (this.id === id) {\n            return this;\n        }\n        if (this.leaf) {\n            return null;\n        }\n        for (var n = 0, nn = this.children.length; n < nn; n++) {\n            var child = this.children.at(n);\n            var result = child.findDescendant(id);\n            if (result) {\n                return result;\n            }\n        }\n        return null;\n    };\n    Node.prototype.boundOffset = function (offset) {\n        return Math.min(this.contentLength, Math.max(0, offset));\n    };\n    return Node;\n}());\nexport { Node };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { Node } from '../tree/node';\nimport { NodeList } from '../tree/node-list';\nvar ViewNode = /** @class */ (function (_super) {\n    __extends(ViewNode, _super);\n    function ViewNode(domContainer, componentId, renderId, layoutId, text, style, children, domService) {\n        var _this = _super.call(this, layoutId) || this;\n        _this.domContainer = domContainer;\n        _this.componentId = componentId;\n        _this.renderId = renderId;\n        _this.layoutId = layoutId;\n        _this.text = text;\n        _this.style = style;\n        _this.domService = domService;\n        _this.internalChildren = new NodeList(children);\n        children.forEach(function (child) {\n            child.parent = _this;\n        });\n        return _this;\n    }\n    Object.defineProperty(ViewNode.prototype, \"contentLength\", {\n        get: function () {\n            if (this.leaf) {\n                return this.text.length;\n            }\n            return this.children.length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewNode.prototype, \"size\", {\n        get: function () {\n            if (this.internalSize === undefined) {\n                if (this.leaf) {\n                    this.internalSize = this.text.length;\n                }\n                else {\n                    this.internalSize = this.children.reduce(function (size, child) { return size + child.size; }, 0);\n                }\n            }\n            return this.internalSize;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ViewNode;\n}(Node));\nexport { ViewNode };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ViewNode } from './node';\nvar ViewLine = /** @class */ (function (_super) {\n    __extends(ViewLine, _super);\n    function ViewLine(domContainer, componentId, layoutId, children, domService) {\n        var _this = _super.call(this, domContainer, componentId, null, layoutId, '', null, children, domService) || this;\n        _this.layoutId = layoutId;\n        return _this;\n    }\n    Object.defineProperty(ViewLine.prototype, \"type\", {\n        get: function () {\n            return 'line';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewLine.prototype, \"root\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewLine.prototype, \"leaf\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ViewLine;\n}(ViewNode));\nexport { ViewLine };\n","var LineComponent = /** @class */ (function () {\n    function LineComponent(id, serviceRegistry) {\n        this.id = id;\n        this.serviceRegistry = serviceRegistry;\n    }\n    return LineComponent;\n}());\nexport { LineComponent };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ViewLine as AbstractViewLine } from '../../view/line';\nimport { LineComponent as AbstractLineComponent } from '../line-component';\nvar ViewLine = /** @class */ (function (_super) {\n    __extends(ViewLine, _super);\n    function ViewLine(domContainer, componentId, layoutId, children, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight, domService) {\n        var _this = _super.call(this, domContainer, componentId, layoutId, children, domService) || this;\n        _this.width = width;\n        _this.height = height;\n        _this.paddingTop = paddingTop;\n        _this.paddingBottom = paddingBottom;\n        _this.paddingLeft = paddingLeft;\n        _this.paddingRight = paddingRight;\n        _this.domContainer.style.width = width + \"px\";\n        _this.domContainer.style.height = height + \"px\";\n        _this.domContainer.style.paddingTop = paddingTop + \"px\";\n        _this.domContainer.style.paddingBottom = paddingBottom + \"px\";\n        _this.domContainer.style.paddingLeft = paddingLeft + \"px\";\n        _this.domContainer.style.paddingRight = paddingRight + \"px\";\n        _this.domContainer.innerHTML = '';\n        children.map(function (child) { return _this.domContainer.appendChild(child.domContainer); });\n        return _this;\n    }\n    Object.defineProperty(ViewLine.prototype, \"partId\", {\n        get: function () {\n            return 'line';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewLine.prototype, \"domContentContainer\", {\n        get: function () {\n            return this.domContainer;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ViewLine;\n}(AbstractViewLine));\nexport { ViewLine };\nvar LineComponent = /** @class */ (function (_super) {\n    __extends(LineComponent, _super);\n    function LineComponent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    LineComponent.prototype.buildViewNode = function (domContainer, layoutId, children, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight) {\n        var domService = this.serviceRegistry.getService('dom');\n        return new ViewLine(domContainer, this.id, layoutId, children, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight, domService);\n    };\n    return LineComponent;\n}(AbstractLineComponent));\nexport { LineComponent };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ViewNode } from './node';\nvar ViewPage = /** @class */ (function (_super) {\n    __extends(ViewPage, _super);\n    function ViewPage(domContainer, componentId, layoutId, children, domService) {\n        var _this = _super.call(this, domContainer, componentId, null, layoutId, '', null, children, domService) || this;\n        _this.layoutId = layoutId;\n        return _this;\n    }\n    Object.defineProperty(ViewPage.prototype, \"type\", {\n        get: function () {\n            return 'page';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewPage.prototype, \"root\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewPage.prototype, \"leaf\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ViewPage;\n}(ViewNode));\nexport { ViewPage };\n","var PageComponent = /** @class */ (function () {\n    function PageComponent(id, serviceRegistry) {\n        this.id = id;\n        this.serviceRegistry = serviceRegistry;\n    }\n    return PageComponent;\n}());\nexport { PageComponent };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ViewPage as AbstractViewPage } from '../../view/page';\nimport { PageComponent as AbstractPageComponent } from '../page-component';\nvar ViewPage = /** @class */ (function (_super) {\n    __extends(ViewPage, _super);\n    function ViewPage(domContainer, componentId, layoutId, children, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight, domService) {\n        var _this = _super.call(this, domContainer, componentId, layoutId, children, domService) || this;\n        _this.domContainer.style.position = 'relative';\n        _this.domContainer.style.marginLeft = 'auto';\n        _this.domContainer.style.marginRight = 'auto';\n        _this.domContainer.style.width = width + \"px\";\n        _this.domContainer.style.height = height + \"px\";\n        _this.domContainer.style.paddingTop = paddingTop + \"px\";\n        _this.domContainer.style.paddingBottom = paddingBottom + \"px\";\n        _this.domContainer.style.paddingLeft = paddingLeft + \"px\";\n        _this.domContainer.style.paddingRight = paddingRight + \"px\";\n        _this.domContainer.innerHTML = '';\n        _this.domContentContainer = _this.findOrCreateDOMContentContainer();\n        _this.domContentContainer.setAttribute('data-tw-role', 'content-container');\n        children.map(function (child) { return _this.domContentContainer.appendChild(child.domContainer); });\n        _this.domContainer.appendChild(_this.domContentContainer);\n        return _this;\n    }\n    Object.defineProperty(ViewPage.prototype, \"partId\", {\n        get: function () {\n            return 'page';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ViewPage.prototype.findOrCreateDOMContentContainer = function () {\n        for (var n = 0, nn = this.domContainer.children.length; n < nn; n++) {\n            var child = this.domContainer.children[n];\n            if (child.getAttribute('data-tw-role') === 'content-container') {\n                return child;\n            }\n        }\n        return this.domService.createElement('div');\n    };\n    return ViewPage;\n}(AbstractViewPage));\nexport { ViewPage };\nvar PageComponent = /** @class */ (function (_super) {\n    __extends(PageComponent, _super);\n    function PageComponent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    PageComponent.prototype.buildViewNode = function (domContainer, layoutId, children, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight) {\n        var domService = this.serviceRegistry.getService('dom');\n        return new ViewPage(domContainer, this.id, layoutId, children, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight, domService);\n    };\n    return PageComponent;\n}(AbstractPageComponent));\nexport { PageComponent };\n","var ComponentRegistry = /** @class */ (function () {\n    function ComponentRegistry() {\n        this.componentsMap = new Map();\n    }\n    ComponentRegistry.prototype.registerComponent = function (componentId, component) {\n        this.componentsMap.set(componentId, component);\n    };\n    ComponentRegistry.prototype.registerPageComponent = function (pageComponent) {\n        this.pageComponent = pageComponent;\n    };\n    ComponentRegistry.prototype.registerLineComponent = function (lineComponent) {\n        this.lineComponent = lineComponent;\n    };\n    ComponentRegistry.prototype.getComponent = function (componentId) {\n        var component = this.componentsMap.get(componentId);\n        if (!component) {\n            throw new Error(\"Component \" + componentId + \" is not registered.\");\n        }\n        return component;\n    };\n    ComponentRegistry.prototype.getPageComponent = function () {\n        if (!this.pageComponent) {\n            throw new Error('Page component is not registered.');\n        }\n        return this.pageComponent;\n    };\n    ComponentRegistry.prototype.getLineComponent = function () {\n        if (!this.lineComponent) {\n            throw new Error('Line component is not registered.');\n        }\n        return this.lineComponent;\n    };\n    return ComponentRegistry;\n}());\nexport { ComponentRegistry };\n","import { LineComponent } from './components/line';\nimport { PageComponent } from './components/page';\nimport { ComponentRegistry } from './registry';\nvar ComponentService = /** @class */ (function () {\n    function ComponentService(configService, serviceRegistry) {\n        this.configService = configService;\n        this.serviceRegistry = serviceRegistry;\n        this.registry = new ComponentRegistry();\n        for (var _i = 0, _a = Object.entries(configService.getConfig().components); _i < _a.length; _i++) {\n            var _b = _a[_i], componentId = _b[0], Component = _b[1];\n            this.registry.registerComponent(componentId, new Component(componentId, serviceRegistry));\n        }\n        this.registry.registerPageComponent(new PageComponent('page', serviceRegistry));\n        this.registry.registerLineComponent(new LineComponent('line', serviceRegistry));\n    }\n    ComponentService.prototype.getComponent = function (componentId) {\n        return this.registry.getComponent(componentId);\n    };\n    ComponentService.prototype.getPageComponent = function () {\n        return this.registry.getPageComponent();\n    };\n    ComponentService.prototype.getLineComponent = function () {\n        return this.registry.getLineComponent();\n    };\n    ComponentService.prototype.convertModelToDOM = function (node, from, to) {\n        var fromOffset = from ? from[0].offset : 0;\n        var toOffset = to ? to[0].offset : node.contentLength - 1;\n        var component = this.getComponent(node.componentId);\n        if (node.leaf) {\n            return component.toDOM(node.partId, node.attributes, node.text.substring(fromOffset, toOffset), []);\n        }\n        var domChildren = [];\n        for (var n = fromOffset; n <= toOffset; n++) {\n            var child = node.children.at(n);\n            domChildren.push(this.convertModelToDOM(child, from && n === fromOffset ? from.slice(1) : null, to && n === toOffset ? to.slice(1) : null));\n        }\n        return component.toDOM(node.partId, node.attributes, '', domChildren);\n    };\n    return ComponentService;\n}());\nexport { ComponentService };\n","var ConfigService = /** @class */ (function () {\n    function ConfigService(config, externalConfig) {\n        this.config = config;\n        this.applyExternalConfig(externalConfig);\n    }\n    ConfigService.prototype.getConfig = function () {\n        return this.config;\n    };\n    ConfigService.prototype.applyExternalConfig = function (externalConfig) {\n        var coreConfig = externalConfig['tw.core'];\n        if (coreConfig) {\n            if (coreConfig.page) {\n                this.config.page = coreConfig.page;\n            }\n        }\n    };\n    return ConfigService;\n}());\nexport { ConfigService };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { createHiddenIframe, isDOMAvailable } from '../../util/dom';\nvar iframe;\nif (isDOMAvailable()) {\n    iframe = createHiddenIframe();\n    document.body.appendChild(iframe);\n}\nexport var copy = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var cursorService, modelService, renderService, componentService, _a, anchor, head, html, iframeDocument;\n    return __generator(this, function (_b) {\n        if (!iframe) {\n            return [2 /*return*/];\n        }\n        cursorService = serviceRegistry.getService('cursor');\n        modelService = serviceRegistry.getService('model');\n        renderService = serviceRegistry.getService('render');\n        componentService = serviceRegistry.getService('component');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        if (anchor === head) {\n            return [2 /*return*/];\n        }\n        html = componentService.convertModelToDOM(modelService.getRoot(), modelService.resolvePosition(renderService.convertRenderToModelPosition(Math.min(anchor, head))), modelService.resolvePosition(renderService.convertRenderToModelPosition(Math.max(anchor, head)))).outerHTML;\n        iframeDocument = iframe.contentDocument;\n        if (!iframeDocument) {\n            return [2 /*return*/];\n        }\n        iframeDocument.body.innerHTML = html;\n        iframeDocument.execCommand('selectAll');\n        iframeDocument.execCommand('copy');\n        iframeDocument.body.innerHTML = '';\n        return [2 /*return*/];\n    });\n}); };\nexport var paste = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n        return [2 /*return*/];\n    });\n}); };\n","export function isDOMAvailable() {\n    return typeof window !== 'undefined';\n}\nexport function createHiddenIframe() {\n    var iframe = document.createElement('iframe');\n    iframe.scrolling = 'no';\n    iframe.src = 'about:blank';\n    iframe.style.width = '0';\n    iframe.style.height = '0';\n    iframe.style.border = 'none';\n    iframe.style.position = 'fixed';\n    iframe.style.zIndex = '-1';\n    iframe.style.opacity = '0';\n    iframe.style.overflow = 'hidden';\n    iframe.style.left = '-1000000px';\n    iframe.style.top = '-1000000px';\n    return iframe;\n}\n","export function atLine(position) {\n    for (var n = position.length - 1; n >= 0; n--) {\n        if (position[n].node.type === 'line') {\n            return position[n];\n        }\n    }\n    throw new Error('No line found.');\n}\nexport function atWord(position) {\n    for (var n = position.length - 1; n >= 0; n--) {\n        if (position[n].node.type === 'word') {\n            return position[n];\n        }\n    }\n    throw new Error('No word found.');\n}\nexport function atBlock(position) {\n    for (var n = position.length - 1; n >= 0; n--) {\n        if (position[n].node.type === 'block') {\n            return position[n];\n        }\n    }\n    throw new Error('No block found.');\n}\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { atLine } from '../layout/position';\nvar Transformation = /** @class */ (function () {\n    function Transformation(changes, modelCursorHead, modelCursorAnchor, keepLeftLock) {\n        if (keepLeftLock === void 0) { keepLeftLock = false; }\n        this.changes = changes;\n        this.modelCursorHead = modelCursorHead;\n        this.modelCursorAnchor = modelCursorAnchor;\n        this.keepLeftLock = keepLeftLock;\n    }\n    Transformation.prototype.apply = function (modelService, cursorService, renderService, layoutService) {\n        var originalCursorModelAnchor = undefined;\n        var originalCursorModelHead = undefined;\n        if (cursorService.hasCursor()) {\n            var _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n            originalCursorModelAnchor = renderService.convertRenderToModelPosition(anchor);\n            originalCursorModelHead = renderService.convertRenderToModelPosition(head);\n        }\n        var changeResults = this.applyChanges(modelService);\n        if (cursorService.hasCursor()) {\n            var _b = cursorService.getCursor(), cursorAnchor = _b.anchor, cursorHead = _b.head;\n            if (this.modelCursorHead !== undefined) {\n                cursorHead = renderService.convertModelToRenderPosition(this.modelCursorHead);\n                cursorAnchor = cursorHead;\n                if (this.modelCursorAnchor !== undefined) {\n                    cursorAnchor = renderService.convertModelToRenderPosition(this.modelCursorAnchor);\n                }\n            }\n            cursorAnchor = this.boundOffset(cursorAnchor, renderService);\n            cursorHead = this.boundOffset(cursorHead, renderService);\n            cursorService.setCursor(cursorAnchor, cursorHead);\n            if (!this.keepLeftLock) {\n                var _c = atLine(layoutService.resolvePosition(cursorService.getCursor().head)), line = _c.node, linePosition = _c.position;\n                cursorService.setLeftLock(line.resolveBoundingBoxes(linePosition, linePosition).boundingBoxes[0].left);\n            }\n        }\n        var reverseChanges = [];\n        var reverseMappings = [];\n        for (var n = changeResults.length - 1; n >= 0; n--) {\n            var changeResult = changeResults[n];\n            reverseChanges.push(reverseMappings.reduce(function (reverseChange, reverseMapping) { return reverseChange.map(reverseMapping); }, changeResult.reverseChange));\n            reverseMappings.push(changeResult.mapping.reverse());\n        }\n        return new TransformationResult(this, changeResults, new Transformation(reverseChanges, originalCursorModelHead, originalCursorModelAnchor, this.keepLeftLock));\n    };\n    Transformation.prototype.applyChanges = function (modelService) {\n        var changeResults = [];\n        var mappings = [];\n        var changes = __spreadArrays(this.changes);\n        var _loop_1 = function () {\n            var change = changes.shift();\n            var changeResult = modelService.applyChange(change);\n            var mapping = changeResult.mapping;\n            mappings.push(mapping);\n            changes = changes.map(function (c) { return c.map(mapping); });\n            changeResults.push(changeResult);\n        };\n        while (changes.length > 0) {\n            _loop_1();\n        }\n        return changeResults;\n    };\n    Transformation.prototype.boundOffset = function (offset, renderService) {\n        return Math.max(0, Math.min(renderService.getDocSize() - 1, offset));\n    };\n    return Transformation;\n}());\nexport { Transformation };\nvar TransformationResult = /** @class */ (function () {\n    function TransformationResult(transformation, changeResults, reverseTransformation) {\n        this.transformation = transformation;\n        this.changeResults = changeResults;\n        this.reverseTransformation = reverseTransformation;\n    }\n    return TransformationResult;\n}());\nexport { TransformationResult };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { atBlock, atLine, atWord } from '../../layout/position';\nimport { Transformation } from '../../transform/transformation';\nfunction atPreviousLine(position, leftLock, layoutService) {\n    var _a = atLine(layoutService.resolvePosition(position)), line = _a.node, linePosition = _a.position;\n    var previousLine = line.previousCrossParentSibling;\n    if (!previousLine) {\n        return position - linePosition;\n    }\n    return position - linePosition - previousLine.size + previousLine.convertCoordinatesToPosition(leftLock, 0);\n}\nfunction atNextLine(position, leftLock, layoutService) {\n    var _a = atLine(layoutService.resolvePosition(position)), line = _a.node, linePosition = _a.position;\n    var nextLine = line.nextCrossParentSibling;\n    if (!nextLine) {\n        return position - linePosition + line.size - 1;\n    }\n    return position - linePosition + line.size + nextLine.convertCoordinatesToPosition(leftLock, 0);\n}\nfunction atPreviousWord(position, layoutService) {\n    var _a = atWord(layoutService.resolvePosition(position)), word = _a.node, wordPosition = _a.offset;\n    if (wordPosition > 0) {\n        return position - wordPosition;\n    }\n    var previousWord = word.previousCrossParentSibling;\n    if (!previousWord) {\n        return position;\n    }\n    return position - previousWord.size;\n}\nfunction atNextWord(position, layoutService) {\n    var _a = atWord(layoutService.resolvePosition(position)), word = _a.node, wordPosition = _a.offset;\n    if (wordPosition < word.size - 1) {\n        return position - wordPosition + word.size - word.whitespaceSize;\n    }\n    var nextWord = word.nextCrossParentSibling;\n    if (!nextWord) {\n        return position;\n    }\n    return position - wordPosition + word.size + nextWord.size - nextWord.whitespaceSize;\n}\nfunction atLineStart(position, layoutService) {\n    var linePosition = atLine(layoutService.resolvePosition(position)).position;\n    if (linePosition === 0) {\n        return position;\n    }\n    return position - linePosition;\n}\nfunction atLineEnd(position, layoutService) {\n    var _a = atLine(layoutService.resolvePosition(position)), line = _a.node, linePosition = _a.position;\n    if (linePosition >= line.size - 1) {\n        return position;\n    }\n    return position - linePosition + line.size - 1;\n}\nexport var move = function (serviceRegistry, position) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, renderService, modelOffset;\n    return __generator(this, function (_a) {\n        transformService = serviceRegistry.getService('transform');\n        renderService = serviceRegistry.getService('render');\n        modelOffset = renderService.convertRenderToModelPosition(position);\n        transformService.applyTransformation(new Transformation([], modelOffset));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveBackward = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, _a, anchor, head, newModelPosition, newPosition;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        if (anchor === head) {\n            newModelPosition = renderService.convertRenderToModelPosition(anchor - 1);\n        }\n        else {\n            newPosition = Math.min(anchor, head);\n            newModelPosition = renderService.convertRenderToModelPosition(newPosition);\n        }\n        transformService.applyTransformation(new Transformation([], newModelPosition));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveForward = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, _a, anchor, head, newModelPosition, newPosition;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        if (anchor === head) {\n            newModelPosition = renderService.convertRenderToModelPosition(anchor + 1);\n        }\n        else {\n            newPosition = Math.max(anchor, head);\n            newModelPosition = renderService.convertRenderToModelPosition(newPosition);\n        }\n        transformService.applyTransformation(new Transformation([], newModelPosition));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveBackwardByLine = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, layoutService, _a, anchor, head, leftLock, position, newPosition, renderService, newModelPosition;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        layoutService = serviceRegistry.getService('layout');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head, leftLock = _a.leftLock;\n        position = Math.min(anchor, head);\n        newPosition = atPreviousLine(position, leftLock, layoutService);\n        renderService = serviceRegistry.getService('render');\n        newModelPosition = renderService.convertRenderToModelPosition(newPosition);\n        transformService.applyTransformation(new Transformation([], newModelPosition, newModelPosition, true));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveForwardByLine = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, layoutService, _a, anchor, head, leftLock, position, newPosition, renderService, newModelPosition;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        layoutService = serviceRegistry.getService('layout');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head, leftLock = _a.leftLock;\n        position = Math.max(anchor, head);\n        newPosition = atNextLine(position, leftLock, layoutService);\n        renderService = serviceRegistry.getService('render');\n        newModelPosition = renderService.convertRenderToModelPosition(newPosition);\n        transformService.applyTransformation(new Transformation([], newModelPosition, newModelPosition, true));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveBackwardByWord = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, layoutService, _a, anchor, head, position, newPosition, renderService, newModelPosition;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        layoutService = serviceRegistry.getService('layout');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        position = Math.min(anchor, head);\n        newPosition = atPreviousWord(position, layoutService);\n        renderService = serviceRegistry.getService('render');\n        newModelPosition = renderService.convertRenderToModelPosition(newPosition);\n        transformService.applyTransformation(new Transformation([], newModelPosition));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveForwardByWord = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, layoutService, _a, anchor, head, position, newPosition, renderService, newModelPosition;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        layoutService = serviceRegistry.getService('layout');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        position = Math.max(anchor, head);\n        newPosition = atNextWord(position, layoutService);\n        renderService = serviceRegistry.getService('render');\n        newModelPosition = renderService.convertRenderToModelPosition(newPosition);\n        transformService.applyTransformation(new Transformation([], newModelPosition));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveToLineStart = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, layoutService, _a, anchor, head, position, newPosition, renderService, newModelPosition;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        layoutService = serviceRegistry.getService('layout');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        position = Math.min(anchor, head);\n        newPosition = atLineStart(position, layoutService);\n        renderService = serviceRegistry.getService('render');\n        newModelPosition = renderService.convertRenderToModelPosition(newPosition);\n        transformService.applyTransformation(new Transformation([], newModelPosition));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveToLineEnd = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, layoutService, _a, anchor, head, position, newPosition, renderService, newModelPosition;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        layoutService = serviceRegistry.getService('layout');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        position = Math.max(anchor, head);\n        newPosition = atLineEnd(position, layoutService);\n        renderService = serviceRegistry.getService('render');\n        newModelPosition = renderService.convertRenderToModelPosition(newPosition);\n        transformService.applyTransformation(new Transformation([], newModelPosition));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveToDocStart = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, renderService, newPosition, newModelPosition;\n    return __generator(this, function (_a) {\n        transformService = serviceRegistry.getService('transform');\n        renderService = serviceRegistry.getService('render');\n        newPosition = 0;\n        newModelPosition = renderService.convertRenderToModelPosition(newPosition);\n        transformService.applyTransformation(new Transformation([], newModelPosition));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveToDocEnd = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, renderService, newPosition, newModelPosition;\n    return __generator(this, function (_a) {\n        transformService = serviceRegistry.getService('transform');\n        renderService = serviceRegistry.getService('render');\n        newPosition = renderService.getDocSize() - 1;\n        newModelPosition = renderService.convertRenderToModelPosition(newPosition);\n        transformService.applyTransformation(new Transformation([], newModelPosition));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveHead = function (serviceRegistry, position) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, anchor, modelAnchor, newModelHead;\n    return __generator(this, function (_a) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        anchor = cursorService.getCursor().anchor;\n        modelAnchor = renderService.convertRenderToModelPosition(anchor);\n        newModelHead = renderService.convertRenderToModelPosition(position);\n        transformService.applyTransformation(new Transformation([], newModelHead, modelAnchor));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveHeadBackward = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, _a, anchor, head, modelAnchor, newModelHead;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        modelAnchor = renderService.convertRenderToModelPosition(anchor);\n        newModelHead = renderService.convertRenderToModelPosition(head - 1);\n        transformService.applyTransformation(new Transformation([], newModelHead, modelAnchor));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveHeadForward = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, _a, anchor, head, modelAnchor, newModelHead;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        modelAnchor = renderService.convertRenderToModelPosition(anchor);\n        newModelHead = renderService.convertRenderToModelPosition(head + 1);\n        transformService.applyTransformation(new Transformation([], newModelHead, modelAnchor));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveHeadBackwardByLine = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, layoutService, _a, anchor, head, leftLock, newHead, modelAnchor, newModelHead;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        layoutService = serviceRegistry.getService('layout');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head, leftLock = _a.leftLock;\n        newHead = atPreviousLine(head, leftLock, layoutService);\n        modelAnchor = renderService.convertRenderToModelPosition(anchor);\n        newModelHead = renderService.convertRenderToModelPosition(newHead);\n        transformService.applyTransformation(new Transformation([], newModelHead, modelAnchor));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveHeadForwardByLine = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, layoutService, _a, anchor, head, leftLock, newHead, modelAnchor, newModelHead;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        layoutService = serviceRegistry.getService('layout');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head, leftLock = _a.leftLock;\n        newHead = atNextLine(head, leftLock, layoutService);\n        modelAnchor = renderService.convertRenderToModelPosition(anchor);\n        newModelHead = renderService.convertRenderToModelPosition(newHead);\n        transformService.applyTransformation(new Transformation([], newModelHead, modelAnchor));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveHeadBackwardByWord = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, layoutService, _a, anchor, head, newHead, modelAnchor, newModelHead;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        layoutService = serviceRegistry.getService('layout');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        newHead = atPreviousWord(head, layoutService);\n        modelAnchor = renderService.convertRenderToModelPosition(anchor);\n        newModelHead = renderService.convertRenderToModelPosition(newHead);\n        transformService.applyTransformation(new Transformation([], newModelHead, modelAnchor));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveHeadForwardByWord = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, layoutService, _a, anchor, head, newHead, modelAnchor, newModelHead;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        layoutService = serviceRegistry.getService('layout');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        newHead = atNextWord(head, layoutService);\n        modelAnchor = renderService.convertRenderToModelPosition(anchor);\n        newModelHead = renderService.convertRenderToModelPosition(newHead);\n        transformService.applyTransformation(new Transformation([], newModelHead, modelAnchor));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveHeadToLineStart = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, layoutService, _a, anchor, head, newHead, modelAnchor, newModelHead;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        layoutService = serviceRegistry.getService('layout');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        newHead = atLineStart(head, layoutService);\n        modelAnchor = renderService.convertRenderToModelPosition(anchor);\n        newModelHead = renderService.convertRenderToModelPosition(newHead);\n        transformService.applyTransformation(new Transformation([], newModelHead, modelAnchor));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveHeadToLineEnd = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, layoutService, _a, anchor, head, newHead, modelAnchor, newModelHead;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        layoutService = serviceRegistry.getService('layout');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        newHead = atLineEnd(head, layoutService);\n        modelAnchor = renderService.convertRenderToModelPosition(anchor);\n        newModelHead = renderService.convertRenderToModelPosition(newHead);\n        transformService.applyTransformation(new Transformation([], newModelHead, modelAnchor));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveHeadToDocStart = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, anchor, newHead, modelAnchor, newModelHead;\n    return __generator(this, function (_a) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        anchor = cursorService.getCursor().anchor;\n        newHead = 0;\n        modelAnchor = renderService.convertRenderToModelPosition(anchor);\n        newModelHead = renderService.convertRenderToModelPosition(newHead);\n        transformService.applyTransformation(new Transformation([], newModelHead, modelAnchor));\n        return [2 /*return*/];\n    });\n}); };\nexport var moveHeadToDocEnd = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, anchor, newHead, modelAnchor, newModelHead;\n    return __generator(this, function (_a) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        anchor = cursorService.getCursor().anchor;\n        newHead = renderService.getDocSize() - 1;\n        modelAnchor = renderService.convertRenderToModelPosition(anchor);\n        newModelHead = renderService.convertRenderToModelPosition(newHead);\n        transformService.applyTransformation(new Transformation([], newModelHead, modelAnchor));\n        return [2 /*return*/];\n    });\n}); };\nexport var selectAll = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, newAnchor, newHead, newModelAnchor, newModelHead;\n    return __generator(this, function (_a) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        newAnchor = 0;\n        newHead = renderService.getDocSize() - 1;\n        newModelAnchor = renderService.convertRenderToModelPosition(newAnchor);\n        newModelHead = renderService.convertRenderToModelPosition(newHead);\n        transformService.applyTransformation(new Transformation([], newModelHead, newModelAnchor));\n        return [2 /*return*/];\n    });\n}); };\nexport var selectWord = function (serviceRegistry, position) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, layoutService, _a, word, wordPosition, previousWord, newHead, newAnchor, newModelHead, newModelAnchor;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        layoutService = serviceRegistry.getService('layout');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = atWord(layoutService.resolvePosition(position)), word = _a.node, wordPosition = _a.position;\n        if (word.size - word.whitespaceSize === 0) {\n            previousWord = word.previousCrossParentSibling;\n            if (!previousWord) {\n                return [2 /*return*/];\n            }\n            word = previousWord;\n            wordPosition += word.size;\n        }\n        newHead = position - wordPosition + word.size - word.whitespaceSize;\n        newAnchor = position - wordPosition;\n        newModelHead = renderService.convertRenderToModelPosition(newHead);\n        newModelAnchor = renderService.convertRenderToModelPosition(newAnchor);\n        transformService.applyTransformation(new Transformation([], newModelHead, newModelAnchor));\n        return [2 /*return*/];\n    });\n}); };\nexport var selectBlock = function (serviceRegistry, position) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, layoutService, _a, block, blockPosition, newHead, newAnchor, newModelHead, newModelAnchor;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        layoutService = serviceRegistry.getService('layout');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = atBlock(layoutService.resolvePosition(position)), block = _a.node, blockPosition = _a.position;\n        newHead = position - blockPosition + block.size - 1;\n        newAnchor = position - blockPosition;\n        newModelHead = renderService.convertRenderToModelPosition(newHead);\n        newModelAnchor = renderService.convertRenderToModelPosition(newAnchor);\n        transformService.applyTransformation(new Transformation([], newModelHead, newModelAnchor));\n        return [2 /*return*/];\n    });\n}); };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nexport var undo = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n        serviceRegistry.getService('history').undo();\n        return [2 /*return*/];\n    });\n}); };\nexport var redo = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n        serviceRegistry.getService('history').redo();\n        return [2 /*return*/];\n    });\n}); };\n","var ModelChange = /** @class */ (function () {\n    function ModelChange() {\n    }\n    return ModelChange;\n}());\nexport { ModelChange };\n","var Mapping = /** @class */ (function () {\n    function Mapping(descs) {\n        this.descs = descs;\n    }\n    Mapping.prototype.map = function (position) {\n        var _this = this;\n        return this.descs.reduce(function (newPosition, desc) { return _this.internalMap(newPosition, desc.from, desc.toBefore, desc.toAfter); }, position);\n    };\n    Mapping.prototype.reverse = function () {\n        return new Mapping(this.descs.map(function (desc) { return ({ from: desc.from, toBefore: desc.toAfter, toAfter: desc.toBefore }); }));\n    };\n    Mapping.prototype.internalMap = function (position, from, toBefore, toAfter) {\n        if (!isPositionGreaterThanOrEqualTo(position, toBefore)) {\n            return position;\n        }\n        console.log(position, toBefore);\n        var newPosition = [toAfter[0] + position[0] - toBefore[0]];\n        console.log(position[0], toAfter[0], toBefore[0]);\n        if (position[0] === toBefore[0]) {\n            newPosition.push.apply(newPosition, this.internalMap(position.slice(1), from.slice(1), toBefore.slice(1), toAfter.slice(1)));\n        }\n        else {\n            newPosition.push.apply(newPosition, position.slice(1));\n        }\n        return newPosition;\n    };\n    return Mapping;\n}());\nexport { Mapping };\nexport var identity = {\n    map: function (position) { return position; },\n    reverse: function () { return identity; },\n};\nfunction isPositionGreaterThanOrEqualTo(position1, position2) {\n    if (position1.length === 0 || position2.length === 0) {\n        return false;\n    }\n    if (position1[0] < position2[0]) {\n        return false;\n    }\n    if (position1[0] > position2[0]) {\n        return true;\n    }\n    if (position1.length === 1 && position2.length === 1) {\n        return true;\n    }\n    return isPositionGreaterThanOrEqualTo(position1.slice(1), position2.slice(1));\n}\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ModelChange } from './change';\nimport { identity } from './mapping';\nvar ApplyAttribute = /** @class */ (function (_super) {\n    __extends(ApplyAttribute, _super);\n    function ApplyAttribute(position, key, value) {\n        var _this = _super.call(this) || this;\n        _this.position = position;\n        _this.key = key;\n        _this.value = value;\n        return _this;\n    }\n    ApplyAttribute.prototype.map = function (mapping) {\n        return this;\n    };\n    ApplyAttribute.prototype.apply = function (root, componentService) {\n        return this.applyNode(root, this.position);\n    };\n    ApplyAttribute.prototype.applyNode = function (node, position) {\n        if (position.length === 0) {\n            var originalValue = node.applyAttribute(this.key, this.value);\n            return {\n                change: this,\n                reverseChange: new ApplyAttribute(this.position, this.key, originalValue),\n                mapping: identity,\n            };\n        }\n        var offset = position[0];\n        return this.applyNode(node.children.at(offset), position.slice(1));\n    };\n    return ApplyAttribute;\n}(ModelChange));\nexport { ApplyAttribute };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { generateId } from '../../util/id';\nimport { ModelChange } from './change';\nimport { Mapping } from './mapping';\nvar Remover = /** @class */ (function () {\n    function Remover(root, from, to) {\n        this.root = root;\n        this.from = from;\n        this.to = to;\n        this.ran = false;\n    }\n    Remover.prototype.run = function () {\n        if (this.ran) {\n            throw new Error('Remover already ran.');\n        }\n        this.remove(this.root, this.from, this.to);\n        this.ran = true;\n    };\n    Remover.prototype.remove = function (node, from, to) {\n        if (node.leaf) {\n            return [node.replace(from[0], to[0], '')];\n        }\n        var removed = [];\n        var child = node.children.at(from[0]);\n        var joinedChildrenAt = 0;\n        if (from[0] < to[0]) {\n            removed.push(node.replace(from[0] + 1, to[0], []));\n            joinedChildrenAt = child.contentLength;\n            this.joinNodes(child, node.children.at(from[0] + 1));\n        }\n        var removedChildFragment = this.remove(child, from.slice(1), __spreadArrays([joinedChildrenAt + to[1]], to.slice(2)));\n        removed.splice.apply(removed, __spreadArrays([0, 0], removedChildFragment.slice(0, joinedChildrenAt)));\n        removed.push.apply(removed, removedChildFragment.slice(joinedChildrenAt));\n        return removed;\n    };\n    Remover.prototype.joinNodes = function (node1, node2) {\n        if (node1.leaf) {\n            node1.replace(0, node1.text.length, node1.text + node2.text);\n        }\n        else {\n            node1.replace(0, node1.children.length, __spreadArrays(node1.children.slice(), node2.children.slice()));\n        }\n        var parent = node1.parent;\n        parent.replace(0, parent.children.length, parent.children.filter(function (child) { return child !== node2; }));\n    };\n    return Remover;\n}());\nvar Inserter = /** @class */ (function () {\n    function Inserter(root, position, fragment, componentService) {\n        this.root = root;\n        this.position = position;\n        this.fragment = fragment;\n        this.componentService = componentService;\n        this.ran = false;\n        this.internalInsertedTo = [];\n    }\n    Object.defineProperty(Inserter.prototype, \"insertedTo\", {\n        get: function () {\n            return this.internalInsertedTo;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Inserter.prototype.run = function () {\n        if (this.ran) {\n            throw new Error('Inserter already ran.');\n        }\n        this.insertedTo.push(this.position[0]);\n        this.insert(this.root, this.position, this.fragment);\n        this.trimEnds();\n        this.ran = true;\n    };\n    Inserter.prototype.insert = function (node, position, fragment) {\n        var insertAt = position[0];\n        var fragmentDepth = Math.ceil(fragment.length / 2);\n        var positionDepth = position.length;\n        if (fragmentDepth < positionDepth) {\n            this.insertedTo.push(position[1]);\n            this.insert(node.children.at(insertAt), position.slice(1), fragment);\n            return 0;\n        }\n        var beforeContents = fragment.slice(0, fragmentDepth - 1);\n        var afterContents = fragment.slice(fragment.length - fragmentDepth + 1);\n        if (positionDepth > 1) {\n            this.insertedTo.push(0);\n            var child = node.children.at(insertAt);\n            var childInsertedExtra = this.insert(child, position.slice(1), __spreadArrays(beforeContents, afterContents));\n            var splitAt = position[1] + beforeContents[beforeContents.length - 1].length + childInsertedExtra;\n            var _a = this.splitNode(child, splitAt), child1 = _a[0], child2 = _a[1];\n            node.replace(insertAt, insertAt + 1, [child1, child2]);\n            insertAt++;\n        }\n        var contents = fragment.slice(fragmentDepth - 1, fragment.length - fragmentDepth + 1);\n        node.replace(insertAt, insertAt, this.mergeContents(contents));\n        this.insertedTo[this.insertedTo.length - position.length] += contents[contents.length - 1].length;\n        if (!node.leaf) {\n            this.insertedTo[this.insertedTo.length - position.length]++;\n        }\n        return insertAt - position[0];\n    };\n    Inserter.prototype.trimEnds = function () {\n        var from = this.position;\n        var resolvedFrom = this.root.resolvePosition(from);\n        var fromLeaf = resolvedFrom[resolvedFrom.length - 1].node;\n        if (fromLeaf.text.length === 0) {\n            var nextLeaf = fromLeaf.nextSibling;\n            if (nextLeaf) {\n                this.removeNode(fromLeaf);\n                var mapFrom = from;\n                var mapToBefore = __spreadArrays(from.slice(0, from.length - 2), [from[from.length - 2] + 1, 0]);\n                var mapToAfter = from;\n                var mapping = new Mapping([{ from: mapFrom, toBefore: mapToBefore, toAfter: mapToAfter }]);\n                this.internalInsertedTo = mapping.map(this.insertedTo);\n            }\n        }\n        var to = this.insertedTo;\n        var resolvedTo = this.root.resolvePosition(to);\n        var toLeaf = resolvedTo[resolvedTo.length - 1].node;\n        if (toLeaf.text.length === 0) {\n            var previousLeaf = toLeaf.previousSibling;\n            if (previousLeaf) {\n                this.removeNode(toLeaf);\n                var mapFrom = __spreadArrays(to.slice(0, to.length - 2), [to[to.length - 2] - 1, previousLeaf.contentLength]);\n                var mapToBefore = to;\n                var mapToAfter = mapFrom;\n                var mapping = new Mapping([{ from: mapFrom, toBefore: mapToBefore, toAfter: mapToAfter }]);\n                this.internalInsertedTo = mapping.map(this.insertedTo);\n            }\n        }\n    };\n    Inserter.prototype.removeNode = function (node) {\n        var parent = node.parent;\n        parent.replace(0, parent.children.length, parent.children.filter(function (child) { return child !== node; }));\n    };\n    Inserter.prototype.splitNode = function (node, offset) {\n        var component = this.componentService.getComponent(node.componentId);\n        var node2;\n        if (node.leaf) {\n            var content2 = node.replace(0, offset, '');\n            node2 = component.buildModelNode(node.partId, generateId(), content2, node.attributes, []);\n        }\n        else {\n            var content2 = node.replace(0, offset, []);\n            node2 = component.buildModelNode(node.partId, generateId(), '', node.attributes, content2);\n        }\n        return [node2, node];\n    };\n    Inserter.prototype.mergeContents = function (contents) {\n        if (typeof contents[0] === 'string') {\n            var textContents = contents;\n            return textContents.reduce(function (mergedContent, content) { return mergedContent + content; }, '');\n        }\n        var nodeContents = contents;\n        return nodeContents.reduce(function (mergedContent, content) { return mergedContent.concat(content); }, []);\n    };\n    return Inserter;\n}());\nvar ReplaceChange = /** @class */ (function (_super) {\n    __extends(ReplaceChange, _super);\n    function ReplaceChange(from, to, fragment) {\n        var _this = _super.call(this) || this;\n        _this.from = from;\n        _this.to = to;\n        _this.fragment = fragment;\n        if (fragment.length % 2 !== 1) {\n            throw new Error('Fragment is invalid.');\n        }\n        return _this;\n    }\n    ReplaceChange.prototype.map = function (mapping) {\n        var from = mapping.map(this.from);\n        var to = mapping.map(this.to);\n        return new ReplaceChange(from, to, this.fragment);\n    };\n    ReplaceChange.prototype.apply = function (root, componentService) {\n        var from = this.correctPosition(root, this.from);\n        var to = this.correctPosition(root, this.to);\n        var remover = new Remover(root, from, to);\n        remover.run();\n        var inserter = new Inserter(root, from, this.fragment, componentService);\n        inserter.run();\n        return {\n            change: this,\n            reverseChange: new ReplaceChange(from, inserter.insertedTo, ['TODO']),\n            mapping: new Mapping([{ from: from, toBefore: to, toAfter: inserter.insertedTo }]),\n        };\n    };\n    ReplaceChange.prototype.correctPosition = function (root, position) {\n        return root.resolvePosition(position).map(function (resolvedOffset) { return resolvedOffset.offset; });\n    };\n    return ReplaceChange;\n}(ModelChange));\nexport { ReplaceChange };\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { ApplyAttribute } from '../../model/change/apply-attribute';\nimport { ReplaceChange } from '../../model/change/replace';\nimport { Transformation } from '../../transform/transformation';\nimport { generateId } from '../../util/id';\nfunction findNodesByComponentIdAndPartId(node, componentId, partId, from, to, position) {\n    if (position === void 0) { position = []; }\n    var results = [];\n    if (node.componentId === componentId && node.partId === partId) {\n        results.push({\n            node: node,\n            position: position,\n            from: from ? from[0].offset : 0,\n            to: to ? to[0].offset : node.contentLength,\n        });\n    }\n    if (!node.leaf) {\n        var fromOffset = from ? from[0].offset : 0;\n        var toOffset = to ? to[0].offset : node.contentLength - 1;\n        for (var n = fromOffset; n <= toOffset; n++) {\n            var child = node.children.at(n);\n            results.push.apply(results, findNodesByComponentIdAndPartId(child, componentId, partId, from && n === fromOffset ? from.slice(1) : null, to && n === toOffset ? to.slice(1) : null, __spreadArrays(position, [n])));\n        }\n    }\n    return results;\n}\nfunction cloneNodeWithAttribute(node, attributeKey, attributeValue, from, to, componentService) {\n    var _a, _b;\n    var component = componentService.getComponent(node.componentId);\n    if (node.leaf) {\n        var textFrom = Math.max(0, from);\n        var textTo = Math.min(node.text.length, to);\n        return component.buildModelNode(node.partId, generateId(), node.text.substring(textFrom, textTo), __assign(__assign({}, node.attributes), (_a = {}, _a[attributeKey] = attributeValue, _a)), []);\n    }\n    var children = [];\n    var cumulatedOffset = 1;\n    node.children.forEach(function (child) {\n        var childFrom = Math.max(0, from - cumulatedOffset);\n        var childTo = Math.min(child.size, to - cumulatedOffset);\n        if (cumulatedOffset <= to && from <= cumulatedOffset + child.size) {\n            children.push(cloneNodeWithAttribute(child, attributeKey, attributeValue, childFrom, childTo, componentService));\n        }\n        cumulatedOffset += child.size;\n    });\n    return component.buildModelNode(node.partId, generateId(), '', __assign(__assign({}, node.attributes), (_b = {}, _b[attributeKey] = attributeValue, _b)), children);\n}\nfunction getNodeEdgeDepth(node) {\n    var currentNode = node;\n    var depth = -1;\n    while (currentNode) {\n        depth++;\n        currentNode = currentNode.firstChild;\n    }\n    return depth;\n}\nfunction buildModelPosition(node) {\n    var position = [];\n    var currentNode = node;\n    while (currentNode.parent) {\n        position.unshift(currentNode.parent.children.indexOf(currentNode));\n        currentNode = currentNode.parent;\n    }\n    return position;\n}\nexport var insert = function (serviceRegistry, content) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, _a, anchor, head, from, to, modelFrom, modelTo, newModelOffset;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        from = Math.min(anchor, head);\n        to = Math.max(anchor, head);\n        modelFrom = renderService.convertRenderToModelPosition(from);\n        modelTo = renderService.convertRenderToModelPosition(to);\n        newModelOffset = __spreadArrays(modelFrom);\n        newModelOffset[newModelOffset.length - 1] += content.length;\n        transformService.applyTransformation(new Transformation([new ReplaceChange(modelFrom, modelTo, [content])], newModelOffset));\n        return [2 /*return*/];\n    });\n}); };\nexport var deleteBackward = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, _a, anchor, head, from, to, modelFrom, modelTo;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        if (anchor === head) {\n            if (head === 0) {\n                return [2 /*return*/];\n            }\n            from = head - 1;\n            to = head;\n        }\n        else {\n            from = Math.min(anchor, head);\n            to = Math.max(anchor, head);\n        }\n        modelFrom = renderService.convertRenderToModelPosition(from);\n        modelTo = renderService.convertRenderToModelPosition(to);\n        transformService.applyTransformation(new Transformation([new ReplaceChange(modelFrom, modelTo, [''])], modelFrom));\n        return [2 /*return*/];\n    });\n}); };\nexport var deleteForward = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, _a, anchor, head, from, to, modelFrom, modelTo;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        if (anchor === head) {\n            if (head >= renderService.getDocSize() - 1) {\n                return [2 /*return*/];\n            }\n            from = head;\n            to = head + 1;\n        }\n        else {\n            from = Math.min(anchor, head);\n            to = Math.max(anchor, head);\n        }\n        modelFrom = renderService.convertRenderToModelPosition(from);\n        modelTo = renderService.convertRenderToModelPosition(to);\n        transformService.applyTransformation(new Transformation([new ReplaceChange(modelFrom, modelTo, [''])], modelFrom));\n        return [2 /*return*/];\n    });\n}); };\nexport var breakLine = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, _a, anchor, head, from, to, modelFrom, modelTo, newModelOffset;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        if (!cursorService.hasCursor()) {\n            return [2 /*return*/];\n        }\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        from = Math.min(anchor, head);\n        to = Math.max(anchor, head);\n        modelFrom = renderService.convertRenderToModelPosition(from);\n        modelTo = renderService.convertRenderToModelPosition(to);\n        newModelOffset = __spreadArrays(modelFrom);\n        newModelOffset[newModelOffset.length - 3]++;\n        newModelOffset[newModelOffset.length - 2] = 0;\n        newModelOffset[newModelOffset.length - 1] = 0;\n        transformService.applyTransformation(new Transformation([new ReplaceChange(modelFrom, modelTo, ['', [], [], [], ''])], newModelOffset));\n        return [2 /*return*/];\n    });\n}); };\nexport var applyAttribute = function (serviceRegistry, componentId, partId, attributeKey, attributeValue) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, componentService, cursorService, renderService, modelService, _a, anchor, head, from, to, modelFrom, modelTo, findResults;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        componentService = serviceRegistry.getService('component');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        modelService = serviceRegistry.getService('model');\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        from = Math.min(anchor, head);\n        to = Math.max(anchor, head);\n        modelFrom = renderService.convertRenderToModelPosition(from);\n        modelTo = renderService.convertRenderToModelPosition(to);\n        findResults = findNodesByComponentIdAndPartId(modelService.getRoot(), componentId, partId, modelService.resolvePosition(modelFrom), modelService.resolvePosition(modelTo));\n        transformService.applyTransformation(new Transformation(findResults\n            .filter(function (_a) {\n            var node = _a.node;\n            return node.attributes[attributeKey] !== attributeValue;\n        })\n            .filter(function (_a) {\n            var nodeFrom = _a.from, nodeTo = _a.to;\n            return nodeFrom !== nodeTo;\n        })\n            .map(function (_a) {\n            var node = _a.node, nodePosition = _a.position, nodeFrom = _a.from, nodeTo = _a.to;\n            if (nodeFrom === 0 && nodeTo === node.size) {\n                return new ApplyAttribute(nodePosition, attributeKey, attributeValue);\n            }\n            var newNode = cloneNodeWithAttribute(node, attributeKey, attributeValue, nodeFrom, nodeTo, componentService);\n            var depth = getNodeEdgeDepth(newNode);\n            var fragment = [\n                [\n                    cloneNodeWithAttribute(node, attributeKey, attributeValue, nodeFrom, nodeTo, componentService),\n                ],\n            ];\n            for (var n = 0; n < depth; n++) {\n                fragment.unshift([]);\n                fragment.push([]);\n            }\n            fragment.unshift('');\n            fragment.push('');\n            return new ReplaceChange(__spreadArrays(nodePosition, [nodeFrom]), __spreadArrays(nodePosition, [nodeTo]), fragment);\n        })));\n        return [2 /*return*/];\n    });\n}); };\nexport var applyAttributeAround = function (serviceRegistry, componentId, partId, attributeKey, attributeValue) { return __awaiter(void 0, void 0, void 0, function () {\n    var transformService, cursorService, renderService, modelService, _a, anchor, head, from, to, modelFrom, modelTo, findResults;\n    return __generator(this, function (_b) {\n        transformService = serviceRegistry.getService('transform');\n        cursorService = serviceRegistry.getService('cursor');\n        renderService = serviceRegistry.getService('render');\n        modelService = serviceRegistry.getService('model');\n        _a = cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        from = Math.min(anchor, head);\n        to = Math.max(anchor, head);\n        modelFrom = renderService.convertRenderToModelPosition(from);\n        modelTo = renderService.convertRenderToModelPosition(to);\n        findResults = findNodesByComponentIdAndPartId(modelService.getRoot(), componentId, partId, modelService.resolvePosition(modelFrom), modelService.resolvePosition(modelTo));\n        transformService.applyTransformation(new Transformation(findResults.map(function (_a) {\n            var node = _a.node;\n            return new ApplyAttribute(buildModelPosition(node), attributeKey, attributeValue);\n        })));\n        return [2 /*return*/];\n    });\n}); };\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (_) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nexport var focus = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n        serviceRegistry.getService('view').requestFocus();\n        return [2 /*return*/];\n    });\n}); };\nexport var blur = function (serviceRegistry) { return __awaiter(void 0, void 0, void 0, function () {\n    return __generator(this, function (_a) {\n        serviceRegistry.getService('view').requestBlur();\n        return [2 /*return*/];\n    });\n}); };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { EventEmitter } from '../event/emitter';\nimport { Node } from '../tree/node';\nimport { NodeList } from '../tree/node-list';\nvar ModelNode = /** @class */ (function (_super) {\n    __extends(ModelNode, _super);\n    function ModelNode(componentId, id, text, attributes, children) {\n        var _this = _super.call(this, id) || this;\n        _this.componentId = componentId;\n        _this.attributes = attributes;\n        _this.internalNeedRender = true;\n        _this.childDidUpdateDisposableMap = new Map();\n        _this.didUpdateEventEmitter = new EventEmitter();\n        _this.handleChildDidUpdate = function () {\n            _this.didUpdateEventEmitter.emit({});\n        };\n        _this.internalText = text;\n        _this.internalChildren = new NodeList(children);\n        children.forEach(function (child) {\n            child.parent = _this;\n            _this.childDidUpdateDisposableMap.set(child.id, child.onDidUpdate(_this.handleChildDidUpdate));\n        });\n        _this.onDidUpdate(function () {\n            _this.internalSize = undefined;\n            _this.internalNeedRender = true;\n        });\n        return _this;\n    }\n    Object.defineProperty(ModelNode.prototype, \"text\", {\n        get: function () {\n            return this.internalText;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ModelNode.prototype, \"contentLength\", {\n        get: function () {\n            if (this.leaf) {\n                return this.text.length;\n            }\n            return this.children.length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ModelNode.prototype, \"size\", {\n        get: function () {\n            if (this.internalSize === undefined) {\n                if (this.leaf) {\n                    this.internalSize = 2 + this.text.length;\n                }\n                else {\n                    this.internalSize = this.children.reduce(function (size, child) { return size + child.size; }, 2);\n                }\n            }\n            return this.internalSize;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ModelNode.prototype, \"needRender\", {\n        get: function () {\n            return this.internalNeedRender;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ModelNode.prototype.canJoin = function (node) {\n        return false;\n    };\n    ModelNode.prototype.clearNeedRender = function () {\n        this.internalNeedRender = false;\n    };\n    ModelNode.prototype.applyAttribute = function (key, value) {\n        // @ts-ignore\n        var originalValue = this.attributes[key];\n        // @ts-ignore\n        this.attributes[key] = value;\n        this.didUpdateEventEmitter.emit({});\n        return originalValue;\n    };\n    ModelNode.prototype.replace = function (from, to, content) {\n        var _this = this;\n        if (from > to) {\n            throw new Error('Range is invalid.');\n        }\n        if (this.leaf) {\n            if (typeof content !== 'string') {\n                throw new Error('Leaf node content must be string.');\n            }\n            if (from < 0 || to > this.text.length) {\n                throw new Error('Range is invalid.');\n            }\n        }\n        else {\n            if (typeof content === 'string') {\n                throw new Error('Non-leaf node content must not be string.');\n            }\n            if (from < 0 || to > this.children.length) {\n                throw new Error('Range is invalid.');\n            }\n        }\n        var replacedContent;\n        if (typeof content === 'string') {\n            replacedContent = this.internalText.substring(from, to);\n            this.internalText = this.internalText.slice(0, from) + content + this.internalText.slice(to);\n        }\n        else {\n            replacedContent = this.children.slice(from, to);\n            this.internalChildren = new NodeList(__spreadArrays(this.children.slice(0, from), content, this.children.slice(to)));\n            var removedNodes = this.children.slice(from, to);\n            removedNodes.forEach(function (node) { var _a; return (_a = _this.childDidUpdateDisposableMap.get(node.id)) === null || _a === void 0 ? void 0 : _a.dispose(); });\n            content.forEach(function (node) {\n                node.parent = _this;\n                _this.childDidUpdateDisposableMap.set(node.id, node.onDidUpdate(_this.handleChildDidUpdate));\n            });\n        }\n        this.didUpdateEventEmitter.emit({});\n        return replacedContent;\n    };\n    ModelNode.prototype.resolvePosition = function (position) {\n        if (position.length === 0) {\n            position = [0];\n        }\n        var offset = this.boundOffset(position[0]);\n        var resolvedPosition = [{ node: this, offset: offset }];\n        if (!this.leaf) {\n            if (offset < this.children.length) {\n                var child = this.children.at(offset);\n                resolvedPosition.push.apply(resolvedPosition, child.resolvePosition(position.slice(1)));\n            }\n            else {\n                var child = this.children.at(this.children.length - 1);\n                resolvedPosition.push.apply(resolvedPosition, child.resolvePosition([child.contentLength]));\n            }\n        }\n        return resolvedPosition;\n    };\n    ModelNode.prototype.onDidUpdate = function (listener) {\n        return this.didUpdateEventEmitter.on(listener);\n    };\n    return ModelNode;\n}(Node));\nexport { ModelNode };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ModelNode } from './node';\nvar ModelRoot = /** @class */ (function (_super) {\n    __extends(ModelRoot, _super);\n    function ModelRoot(componentId, id, attributes, children) {\n        var _this = _super.call(this, componentId, id, '', attributes, children) || this;\n        if (children.length === 0) {\n            throw new Error('Doc node must have children.');\n        }\n        return _this;\n    }\n    Object.defineProperty(ModelRoot.prototype, \"root\", {\n        get: function () {\n            return true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ModelRoot.prototype, \"leaf\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ModelRoot;\n}(ModelNode));\nexport { ModelRoot };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { Node } from '../tree/node';\nimport { NodeList } from '../tree/node-list';\nimport { generateId } from '../util/id';\nvar RenderNode = /** @class */ (function (_super) {\n    __extends(RenderNode, _super);\n    function RenderNode(componentId, modelId, text, attributes, children) {\n        var _this = _super.call(this, generateId()) || this;\n        _this.componentId = componentId;\n        _this.modelId = modelId;\n        _this.text = text;\n        _this.attributes = attributes;\n        _this.internalNeedLayout = true;\n        _this.internalChildren = new NodeList(children);\n        children.forEach(function (child) {\n            child.parent = _this;\n        });\n        return _this;\n    }\n    Object.defineProperty(RenderNode.prototype, \"contentLength\", {\n        get: function () {\n            if (this.leaf) {\n                return this.text.length;\n            }\n            return this.children.length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderNode.prototype, \"size\", {\n        get: function () {\n            if (this.internalSize === undefined) {\n                if (this.leaf) {\n                    this.internalSize = this.contentLength;\n                }\n                else {\n                    this.internalSize = this.children.reduce(function (size, child) { return size + child.size; }, 0);\n                }\n            }\n            return this.internalSize;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderNode.prototype, \"needLayout\", {\n        get: function () {\n            return this.internalNeedLayout;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    RenderNode.prototype.clearNeedLayout = function () {\n        this.internalNeedLayout = false;\n    };\n    RenderNode.prototype.resolvePosition = function (position) {\n        if (position < 0 || position >= this.size) {\n            throw new Error(\"Offset \" + position + \" is out of range.\");\n        }\n        if (this.leaf) {\n            return [{ node: this, offset: position, position: position }];\n        }\n        var cumulatedSize = 0;\n        for (var n = 0, nn = this.children.length; n < nn; n++) {\n            var child = this.children.at(n);\n            var childSize = child.size;\n            if (cumulatedSize + childSize > position) {\n                return __spreadArrays([\n                    { node: this, offset: n, position: cumulatedSize }\n                ], child.resolvePosition(position - cumulatedSize));\n            }\n            cumulatedSize += childSize;\n        }\n        throw new Error('Offset cannot be resolved.');\n    };\n    RenderNode.prototype.convertModelToRenderPosition = function (modelPosition) {\n        var modelOffset = this.boundOffset(modelPosition[0]);\n        if (this.leaf) {\n            return modelOffset;\n        }\n        var offset = 0;\n        var cumulatedSize = 0;\n        for (var n = 0, nn = this.children.length; n < nn; n++) {\n            var child = this.children.at(n);\n            if (child.modelId) {\n                if (offset === modelOffset) {\n                    return cumulatedSize + child.convertModelToRenderPosition(modelPosition.slice(1));\n                }\n                offset++;\n            }\n            cumulatedSize += child.size;\n        }\n        throw new Error(\"Model offset \" + modelOffset + \" is out of range.\");\n    };\n    RenderNode.prototype.convertRenderToModelPosition = function (renderPosition) {\n        if (renderPosition < 0 || renderPosition > this.size) {\n            throw new Error('Render position is out of range.');\n        }\n        if (this.leaf) {\n            return [this.boundOffset(renderPosition)];\n        }\n        var cumulatedSize = 0;\n        var modelOffset = 0;\n        for (var n = 0, nn = this.children.length; n < nn; n++) {\n            var child = this.children.at(n);\n            var childSize = child.size;\n            if (child.modelId) {\n                var nextNonModelSize = 0;\n                for (var m = n + 1; m < nn; m++) {\n                    var nextChild = this.children.at(m);\n                    if (nextChild.modelId) {\n                        break;\n                    }\n                    nextNonModelSize += nextChild.size;\n                }\n                if (cumulatedSize + childSize + nextNonModelSize > renderPosition) {\n                    return __spreadArrays([modelOffset], child.convertRenderToModelPosition(renderPosition - cumulatedSize));\n                }\n                modelOffset++;\n            }\n            cumulatedSize += childSize;\n        }\n        throw new Error(\"Render offset \" + renderPosition + \" is out of range.\");\n    };\n    return RenderNode;\n}(Node));\nexport { RenderNode };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { RenderNode } from './node';\nvar RenderDoc = /** @class */ (function (_super) {\n    __extends(RenderDoc, _super);\n    function RenderDoc(componentId, modelId, attributes, children) {\n        return _super.call(this, componentId, modelId, '', attributes, children) || this;\n    }\n    Object.defineProperty(RenderDoc.prototype, \"type\", {\n        get: function () {\n            return 'doc';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderDoc.prototype, \"root\", {\n        get: function () {\n            return true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderDoc.prototype, \"leaf\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return RenderDoc;\n}(RenderNode));\nexport { RenderDoc };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ViewNode } from './node';\nvar ViewDoc = /** @class */ (function (_super) {\n    __extends(ViewDoc, _super);\n    function ViewDoc(domContainer, componentId, renderId, layoutId, style, children, domService) {\n        var _this = _super.call(this, domContainer, componentId, renderId, layoutId, '', style, children, domService) || this;\n        _this.attached = false;\n        return _this;\n    }\n    Object.defineProperty(ViewDoc.prototype, \"type\", {\n        get: function () {\n            return 'doc';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewDoc.prototype, \"root\", {\n        get: function () {\n            return true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewDoc.prototype, \"leaf\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ViewDoc;\n}(ViewNode));\nexport { ViewDoc };\n","var Component = /** @class */ (function () {\n    function Component(id, serviceRegistry) {\n        this.id = id;\n        this.serviceRegistry = serviceRegistry;\n    }\n    return Component;\n}());\nexport { Component };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ModelRoot } from '../../model/root';\nimport { RenderDoc as AbstractRenderDoc } from '../../render/doc';\nimport { ViewDoc as AbstractViewDoc } from '../../view/doc';\nimport { Component } from '../component';\nvar ModelDoc = /** @class */ (function (_super) {\n    __extends(ModelDoc, _super);\n    function ModelDoc() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(ModelDoc.prototype, \"partId\", {\n        get: function () {\n            return 'doc';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ModelDoc;\n}(ModelRoot));\nexport { ModelDoc };\nvar RenderDoc = /** @class */ (function (_super) {\n    __extends(RenderDoc, _super);\n    function RenderDoc(componentId, modelId, attributes, children, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight) {\n        var _this = _super.call(this, componentId, modelId, attributes, children) || this;\n        _this.width = width;\n        _this.height = height;\n        _this.paddingTop = paddingTop;\n        _this.paddingBottom = paddingBottom;\n        _this.paddingLeft = paddingLeft;\n        _this.paddingRight = paddingRight;\n        return _this;\n    }\n    Object.defineProperty(RenderDoc.prototype, \"partId\", {\n        get: function () {\n            return 'doc';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderDoc.prototype, \"pseudo\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderDoc.prototype, \"style\", {\n        get: function () {\n            return {};\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return RenderDoc;\n}(AbstractRenderDoc));\nexport { RenderDoc };\nvar ViewDoc = /** @class */ (function (_super) {\n    __extends(ViewDoc, _super);\n    function ViewDoc(domContainer, componentId, renderId, layoutId, style, children, domService) {\n        var _this = _super.call(this, domContainer, componentId, renderId, layoutId, style, children, domService) || this;\n        _this.domContainer.style.textAlign = 'left';\n        _this.domContainer.style.cursor = 'text';\n        _this.domContainer.style.userSelect = 'none';\n        _this.domContainer.innerHTML = '';\n        var domContentContainer = domService.createElement('div');\n        domContentContainer.setAttribute('data-tw-role', 'content-container');\n        children.map(function (child) { return domContentContainer.appendChild(child.domContainer); });\n        _this.domContainer.appendChild(domContentContainer);\n        return _this;\n    }\n    Object.defineProperty(ViewDoc.prototype, \"partId\", {\n        get: function () {\n            return 'doc';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ViewDoc;\n}(AbstractViewDoc));\nexport { ViewDoc };\nvar DocComponent = /** @class */ (function (_super) {\n    __extends(DocComponent, _super);\n    function DocComponent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    DocComponent.prototype.buildModelNode = function (partId, id, text, attributes, children) {\n        return new ModelDoc(this.id, id, attributes, children);\n    };\n    DocComponent.prototype.buildRenderNode = function (partId, modelId, text, attributes, children) {\n        var configService = this.serviceRegistry.getService('config');\n        switch (partId) {\n            case 'doc':\n                var pageConfig = configService.getConfig().page;\n                return new RenderDoc(this.id, modelId, attributes, children, pageConfig.width, pageConfig.height, pageConfig.paddingTop, pageConfig.paddingBottom, pageConfig.paddingLeft, pageConfig.paddingRight);\n            default:\n                throw new Error('Invalid part ID.');\n        }\n    };\n    DocComponent.prototype.buildViewNode = function (domContainer, partId, renderId, layoutId, text, style, children, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight) {\n        var domService = this.serviceRegistry.getService('dom');\n        switch (partId) {\n            case 'doc':\n                return new ViewDoc(domContainer, this.id, renderId, layoutId, style, children, domService);\n            default:\n                throw new Error('Invalid part ID.');\n        }\n    };\n    DocComponent.prototype.toDOM = function (partId, attributes, text, children) {\n        switch (partId) {\n            case 'doc': {\n                var $element_1 = document.createElement('div');\n                children.forEach(function (child) { return $element_1.appendChild(child); });\n                return $element_1;\n            }\n            default:\n                throw new Error('Invalid part ID.');\n        }\n    };\n    return DocComponent;\n}(Component));\nexport { DocComponent };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ModelNode } from './node';\nvar ModelBranch = /** @class */ (function (_super) {\n    __extends(ModelBranch, _super);\n    function ModelBranch(componentId, id, attributes, children) {\n        var _this = _super.call(this, componentId, id, '', attributes, children) || this;\n        if (children.length === 0) {\n            throw new Error('Branch node must have children.');\n        }\n        return _this;\n    }\n    Object.defineProperty(ModelBranch.prototype, \"root\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ModelBranch.prototype, \"leaf\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ModelBranch;\n}(ModelNode));\nexport { ModelBranch };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { RenderNode } from './node';\nvar RenderBlock = /** @class */ (function (_super) {\n    __extends(RenderBlock, _super);\n    function RenderBlock(componentId, modelId, attributes, children) {\n        return _super.call(this, componentId, modelId, '', attributes, children) || this;\n    }\n    Object.defineProperty(RenderBlock.prototype, \"type\", {\n        get: function () {\n            return 'block';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderBlock.prototype, \"root\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderBlock.prototype, \"leaf\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return RenderBlock;\n}(RenderNode));\nexport { RenderBlock };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { RenderNode } from './node';\nvar RenderText = /** @class */ (function (_super) {\n    __extends(RenderText, _super);\n    function RenderText(componentId, modelId, text, attributes) {\n        return _super.call(this, componentId, modelId, text, attributes, []) || this;\n    }\n    Object.defineProperty(RenderText.prototype, \"type\", {\n        get: function () {\n            return 'text';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderText.prototype, \"root\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderText.prototype, \"leaf\", {\n        get: function () {\n            return true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return RenderText;\n}(RenderNode));\nexport { RenderText };\n","export var DEFAULT_FONT = {\n    weight: 400,\n    size: 16,\n    family: 'sans-serif',\n    letterSpacing: 0,\n    underline: false,\n    italic: false,\n    strikethrough: false,\n    color: 'black',\n};\nexport var BREAKABLE_CHARS = [' ', '\\n', '\\t'];\nvar TextService = /** @class */ (function () {\n    function TextService(domService) {\n        this.$canvas = domService.createElement('canvas');\n    }\n    TextService.prototype.measure = function (text, font) {\n        var fontWithDefault = this.applyDefaultFont(font);\n        var ctx = this.$canvas.getContext('2d');\n        var weight = fontWithDefault.weight;\n        var size = fontWithDefault.size;\n        var family = this.fixFontFamily(fontWithDefault.family);\n        var letterSpacing = fontWithDefault.letterSpacing;\n        ctx.font = weight + \" \" + size + \"px \" + family;\n        var measurement = ctx.measureText(text);\n        var width = letterSpacing === 0 || text.length <= 1\n            ? measurement.width\n            : measurement.width + (text.length - 1) * letterSpacing;\n        return {\n            width: width,\n            height: size,\n        };\n    };\n    TextService.prototype.breakIntoWords = function (text) {\n        var words = [];\n        var word = '';\n        for (var n = 0, nn = text.length; n < nn; n++) {\n            var char = text[n];\n            word += char;\n            if (BREAKABLE_CHARS.includes(char)) {\n                words.push({\n                    text: word,\n                    whitespaceSize: 1,\n                });\n                word = '';\n            }\n        }\n        if (word.length > 0) {\n            words.push({\n                text: word,\n                whitespaceSize: 0,\n            });\n        }\n        return words;\n    };\n    TextService.prototype.applyDefaultFont = function (font) {\n        var fontConfigWithDefault = {};\n        for (var key in DEFAULT_FONT) {\n            if (key in font && font[key] !== undefined) {\n                fontConfigWithDefault[key] = font[key];\n            }\n            else {\n                fontConfigWithDefault[key] = DEFAULT_FONT[key];\n            }\n        }\n        return fontConfigWithDefault;\n    };\n    TextService.prototype.fixFontFamily = function (fontFamily) {\n        if (fontFamily.indexOf(' ') >= 0) {\n            return \"'\" + fontFamily + \"'\";\n        }\n        return fontFamily;\n    };\n    return TextService;\n}());\nexport { TextService };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ViewNode } from './node';\nvar ViewBlock = /** @class */ (function (_super) {\n    __extends(ViewBlock, _super);\n    function ViewBlock(domContainer, componentId, renderId, layoutId, style, children, domService) {\n        return _super.call(this, domContainer, componentId, renderId, layoutId, '', style, children, domService) || this;\n    }\n    Object.defineProperty(ViewBlock.prototype, \"type\", {\n        get: function () {\n            return 'block';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewBlock.prototype, \"root\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewBlock.prototype, \"leaf\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ViewBlock;\n}(ViewNode));\nexport { ViewBlock };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ViewNode } from './node';\nvar ViewText = /** @class */ (function (_super) {\n    __extends(ViewText, _super);\n    function ViewText(domContainer, componentId, renderId, layoutId, text, style, domService) {\n        return _super.call(this, domContainer, componentId, renderId, layoutId, text, style, [], domService) || this;\n    }\n    Object.defineProperty(ViewText.prototype, \"type\", {\n        get: function () {\n            return 'text';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewText.prototype, \"root\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewText.prototype, \"leaf\", {\n        get: function () {\n            return true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ViewText;\n}(ViewNode));\nexport { ViewText };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { ModelBranch } from '../../model/branch';\nimport { RenderBlock } from '../../render/block';\nimport { RenderText } from '../../render/text';\nimport { DEFAULT_FONT } from '../../text/service';\nimport { ViewBlock } from '../../view/block';\nimport { ViewText } from '../../view/text';\nimport { Component } from '../component';\nvar ModelParagraph = /** @class */ (function (_super) {\n    __extends(ModelParagraph, _super);\n    function ModelParagraph() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(ModelParagraph.prototype, \"partId\", {\n        get: function () {\n            return 'paragraph';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ModelParagraph;\n}(ModelBranch));\nexport { ModelParagraph };\nvar RenderParagraph = /** @class */ (function (_super) {\n    __extends(RenderParagraph, _super);\n    function RenderParagraph(componentId, modelId, attributes, children) {\n        return _super.call(this, componentId, modelId, attributes, __spreadArrays(children, [new RenderParagraphLineBreak(componentId)])) || this;\n    }\n    Object.defineProperty(RenderParagraph.prototype, \"partId\", {\n        get: function () {\n            return 'paragraph';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderParagraph.prototype, \"pseudo\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderParagraph.prototype, \"paddingTop\", {\n        get: function () {\n            return 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderParagraph.prototype, \"paddingBottom\", {\n        get: function () {\n            return 12;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderParagraph.prototype, \"paddingLeft\", {\n        get: function () {\n            return 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderParagraph.prototype, \"paddingRight\", {\n        get: function () {\n            return 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderParagraph.prototype, \"style\", {\n        get: function () {\n            return {};\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return RenderParagraph;\n}(RenderBlock));\nexport { RenderParagraph };\nvar RenderParagraphLineBreak = /** @class */ (function (_super) {\n    __extends(RenderParagraphLineBreak, _super);\n    function RenderParagraphLineBreak(componentId) {\n        var _this = _super.call(this, componentId, null, ' ', null) || this;\n        _this.componentId = componentId;\n        return _this;\n    }\n    Object.defineProperty(RenderParagraphLineBreak.prototype, \"partId\", {\n        get: function () {\n            return 'line-break';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderParagraphLineBreak.prototype, \"pseudo\", {\n        get: function () {\n            return true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderParagraphLineBreak.prototype, \"paddingTop\", {\n        get: function () {\n            return 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderParagraphLineBreak.prototype, \"paddingBottom\", {\n        get: function () {\n            return 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderParagraphLineBreak.prototype, \"paddingLeft\", {\n        get: function () {\n            return 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderParagraphLineBreak.prototype, \"paddingRight\", {\n        get: function () {\n            return 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderParagraphLineBreak.prototype, \"style\", {\n        get: function () {\n            return null;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderParagraphLineBreak.prototype, \"font\", {\n        get: function () {\n            var node = this.previousSibling;\n            while (node) {\n                if (node.type === 'text') {\n                    return node.font;\n                }\n                node = node.previousSibling;\n            }\n            return DEFAULT_FONT;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return RenderParagraphLineBreak;\n}(RenderText));\nexport { RenderParagraphLineBreak };\nvar ViewParagraph = /** @class */ (function (_super) {\n    __extends(ViewParagraph, _super);\n    function ViewParagraph(domContainer, componentId, renderId, layoutId, style, children, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight, domService) {\n        var _this = _super.call(this, domContainer, componentId, renderId, layoutId, style, children, domService) || this;\n        _this.domContainer.style.width = width + \"px\";\n        _this.domContainer.style.height = height + \"px\";\n        _this.domContainer.style.paddingTop = paddingTop + \"px\";\n        _this.domContainer.style.paddingBottom = paddingBottom + \"px\";\n        _this.domContainer.style.paddingLeft = paddingLeft + \"px\";\n        _this.domContainer.style.paddingRight = paddingRight + \"px\";\n        _this.domContainer.style.lineHeight = '1em';\n        _this.domContainer.innerHTML = '';\n        children.map(function (child) { return _this.domContainer.appendChild(child.domContainer); });\n        return _this;\n    }\n    Object.defineProperty(ViewParagraph.prototype, \"partId\", {\n        get: function () {\n            return 'paragraph';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewParagraph.prototype, \"domContentContainer\", {\n        get: function () {\n            return this.domContainer;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ViewParagraph;\n}(ViewBlock));\nexport { ViewParagraph };\nvar ViewParagraphLineBreak = /** @class */ (function (_super) {\n    __extends(ViewParagraphLineBreak, _super);\n    function ViewParagraphLineBreak(domContainer, componentId, renderId, layoutId, domService) {\n        return _super.call(this, domContainer, componentId, renderId, layoutId, ' ', null, domService) || this;\n    }\n    Object.defineProperty(ViewParagraphLineBreak.prototype, \"partId\", {\n        get: function () {\n            return 'line-break';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ViewParagraphLineBreak.prototype, \"domContentContainer\", {\n        get: function () {\n            return this.domContainer;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ViewParagraphLineBreak;\n}(ViewText));\nexport { ViewParagraphLineBreak };\nvar ParagraphComponent = /** @class */ (function (_super) {\n    __extends(ParagraphComponent, _super);\n    function ParagraphComponent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    ParagraphComponent.prototype.buildModelNode = function (partId, id, text, attributes, children) {\n        return new ModelParagraph(this.id, id, attributes, children);\n    };\n    ParagraphComponent.prototype.buildRenderNode = function (partId, modelId, text, attributes, children) {\n        switch (partId) {\n            case 'paragraph':\n                return new RenderParagraph(this.id, modelId, attributes, children);\n            default:\n                throw new Error('Invalid part ID.');\n        }\n    };\n    ParagraphComponent.prototype.buildViewNode = function (domContainer, partId, renderId, layoutId, text, style, children, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight) {\n        var domService = this.serviceRegistry.getService('dom');\n        switch (partId) {\n            case 'paragraph':\n                return new ViewParagraph(domContainer, this.id, renderId, layoutId, style, children, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight, domService);\n            case 'line-break':\n                return new ViewParagraphLineBreak(domContainer, this.id, renderId, layoutId, domService);\n            default:\n                throw new Error('Invalid part ID.');\n        }\n    };\n    ParagraphComponent.prototype.toDOM = function (partId, attributes, text, children) {\n        switch (partId) {\n            case 'paragraph': {\n                var $element_1 = document.createElement('p');\n                children.forEach(function (child) { return $element_1.appendChild(child); });\n                return $element_1;\n            }\n            default:\n                throw new Error('Invalid part ID.');\n        }\n    };\n    return ParagraphComponent;\n}(Component));\nexport { ParagraphComponent };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ModelNode } from './node';\nvar ModelLeaf = /** @class */ (function (_super) {\n    __extends(ModelLeaf, _super);\n    function ModelLeaf(componentId, id, text, attributes) {\n        return _super.call(this, componentId, id, text, attributes, []) || this;\n    }\n    Object.defineProperty(ModelLeaf.prototype, \"root\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(ModelLeaf.prototype, \"leaf\", {\n        get: function () {\n            return true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return ModelLeaf;\n}(ModelNode));\nexport { ModelLeaf };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { ModelLeaf } from '../../model/leaf';\nimport { RenderText as AbstractRenderText } from '../../render/text';\nimport { ViewText as AbstractViewText } from '../../view/text';\nimport { Component } from '../component';\nvar ModelText = /** @class */ (function (_super) {\n    __extends(ModelText, _super);\n    function ModelText() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    Object.defineProperty(ModelText.prototype, \"partId\", {\n        get: function () {\n            return 'text';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ModelText.prototype.canJoin = function (node) {\n        if (this.componentId !== node.componentId) {\n            return false;\n        }\n        if (this.partId !== node.partId) {\n            return false;\n        }\n        if (JSON.stringify(this.attributes) !== JSON.stringify(node.attributes)) {\n            return false;\n        }\n        return true;\n    };\n    return ModelText;\n}(ModelLeaf));\nexport { ModelText };\nvar RenderText = /** @class */ (function (_super) {\n    __extends(RenderText, _super);\n    function RenderText(componentId, modelId, textService, text, attributes) {\n        var _this = _super.call(this, componentId, modelId, text, attributes) || this;\n        _this.textService = textService;\n        return _this;\n    }\n    Object.defineProperty(RenderText.prototype, \"partId\", {\n        get: function () {\n            return 'text';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderText.prototype, \"pseudo\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderText.prototype, \"paddingTop\", {\n        get: function () {\n            return 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderText.prototype, \"paddingBottom\", {\n        get: function () {\n            return 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderText.prototype, \"paddingLeft\", {\n        get: function () {\n            return 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderText.prototype, \"paddingRight\", {\n        get: function () {\n            return 0;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderText.prototype, \"style\", {\n        get: function () {\n            return this.textService.applyDefaultFont(this.attributes);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(RenderText.prototype, \"font\", {\n        get: function () {\n            return this.style;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    return RenderText;\n}(AbstractRenderText));\nexport { RenderText };\nvar ViewText = /** @class */ (function (_super) {\n    __extends(ViewText, _super);\n    function ViewText(domContainer, componentId, renderId, layoutId, text, style, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight, domService) {\n        var _this = _super.call(this, domContainer, componentId, renderId, layoutId, text, style, domService) || this;\n        _this.domContainer.style.display = 'inline-block';\n        _this.domContainer.style.whiteSpace = 'pre';\n        _this.domContainer.style.lineHeight = '1em';\n        _this.domContainer.style.width = width + \"px\";\n        _this.domContainer.style.height = height + \"px\";\n        _this.domContainer.style.paddingTop = paddingTop + \"px\";\n        _this.domContainer.style.paddingBottom = paddingBottom + \"px\";\n        _this.domContainer.style.paddingLeft = paddingLeft + \"px\";\n        _this.domContainer.style.paddingRight = paddingRight + \"px\";\n        _this.domContainer.style.fontFamily = style.family;\n        _this.domContainer.style.fontSize = style.size + \"px\";\n        _this.domContainer.style.letterSpacing = style.letterSpacing + \"px\";\n        _this.domContainer.style.fontWeight = \"\" + style.weight;\n        _this.domContainer.style.color = style.color;\n        _this.domContainer.style.textDecoration = style.underline ? 'underline' : '';\n        _this.domContainer.style.fontStyle = style.italic ? 'italic' : '';\n        _this.domContainer.innerHTML = '';\n        var domContentContainer = _this.findOrCreateDOMContentContainer();\n        domContentContainer.setAttribute('data-tw-role', 'content-container');\n        domContentContainer.style.textDecoration = style.strikethrough ? 'line-through' : '';\n        domContentContainer.innerHTML = text;\n        _this.domContainer.appendChild(domContentContainer);\n        return _this;\n    }\n    Object.defineProperty(ViewText.prototype, \"partId\", {\n        get: function () {\n            return 'text';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ViewText.prototype.findOrCreateDOMContentContainer = function () {\n        for (var n = 0, nn = this.domContainer.children.length; n < nn; n++) {\n            var child = this.domContainer.children[n];\n            if (child.getAttribute('data-tw-role') === 'content-container') {\n                return child;\n            }\n        }\n        return this.domService.createElement('span');\n    };\n    return ViewText;\n}(AbstractViewText));\nexport { ViewText };\nvar TextComponent = /** @class */ (function (_super) {\n    __extends(TextComponent, _super);\n    function TextComponent() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    TextComponent.prototype.buildModelNode = function (partId, id, text, attributes, children) {\n        return new ModelText(this.id, id, text, attributes);\n    };\n    TextComponent.prototype.buildRenderNode = function (partId, modelId, text, attributes, children) {\n        var textService = this.serviceRegistry.getService('text');\n        switch (partId) {\n            case 'text':\n                return new RenderText(this.id, modelId, textService, text, attributes);\n            default:\n                throw new Error('Invalid part ID.');\n        }\n    };\n    TextComponent.prototype.buildViewNode = function (domContainer, partId, renderId, layoutId, text, style, children, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight) {\n        var domService = this.serviceRegistry.getService('dom');\n        switch (partId) {\n            case 'text':\n                return new ViewText(domContainer, this.id, renderId, layoutId, text, style, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight, domService);\n            default:\n                throw new Error('Invalid part ID.');\n        }\n    };\n    TextComponent.prototype.toDOM = function (partId, attributes, text, children) {\n        switch (partId) {\n            case 'text': {\n                var $element = document.createElement('span');\n                $element.innerText = text;\n                return $element;\n            }\n            default:\n                throw new Error('Invalid part ID.');\n        }\n    };\n    return TextComponent;\n}(Component));\nexport { TextComponent };\n","import * as clipboardCommandHandlers from '../command/handlers/clipboard';\nimport * as cursorCommandHandlers from '../command/handlers/cursor';\nimport * as historyCommandHandlers from '../command/handlers/history';\nimport * as stateCommandHandlers from '../command/handlers/state';\nimport * as viewCommandHandlers from '../command/handlers/view';\nimport { DocComponent } from '../component/components/doc';\nimport { ParagraphComponent } from '../component/components/paragraph';\nimport { TextComponent } from '../component/components/text';\nexport function buildBaseConfig() {\n    return {\n        commands: {\n            'tw.clipboard.copy': clipboardCommandHandlers.copy,\n            'tw.clipboard.paste': clipboardCommandHandlers.paste,\n            'tw.cursor.move': cursorCommandHandlers.move,\n            'tw.cursor.moveBackwardByLine': cursorCommandHandlers.moveBackwardByLine,\n            'tw.cursor.moveForwardByLine': cursorCommandHandlers.moveForwardByLine,\n            'tw.cursor.moveBackward': cursorCommandHandlers.moveBackward,\n            'tw.cursor.moveForward': cursorCommandHandlers.moveForward,\n            'tw.cursor.moveBackwardByWord': cursorCommandHandlers.moveBackwardByWord,\n            'tw.cursor.moveForwardByWord': cursorCommandHandlers.moveForwardByWord,\n            'tw.cursor.moveToLineStart': cursorCommandHandlers.moveToLineStart,\n            'tw.cursor.moveToLineEnd': cursorCommandHandlers.moveToLineEnd,\n            'tw.cursor.moveToDocStart': cursorCommandHandlers.moveToDocStart,\n            'tw.cursor.moveToDocEnd': cursorCommandHandlers.moveToDocEnd,\n            'tw.cursor.moveHead': cursorCommandHandlers.moveHead,\n            'tw.cursor.moveHeadBackwardByLine': cursorCommandHandlers.moveHeadBackwardByLine,\n            'tw.cursor.moveHeadForwardByLine': cursorCommandHandlers.moveHeadForwardByLine,\n            'tw.cursor.moveHeadBackward': cursorCommandHandlers.moveHeadBackward,\n            'tw.cursor.moveHeadForward': cursorCommandHandlers.moveHeadForward,\n            'tw.cursor.moveHeadBackwardByWord': cursorCommandHandlers.moveHeadBackwardByWord,\n            'tw.cursor.moveHeadForwardByWord': cursorCommandHandlers.moveHeadForwardByWord,\n            'tw.cursor.moveHeadToLineStart': cursorCommandHandlers.moveHeadToLineStart,\n            'tw.cursor.moveHeadToLineEnd': cursorCommandHandlers.moveHeadToLineEnd,\n            'tw.cursor.moveHeadToDocStart': cursorCommandHandlers.moveHeadToDocStart,\n            'tw.cursor.moveHeadToDocEnd': cursorCommandHandlers.moveHeadToDocEnd,\n            'tw.cursor.selectAll': cursorCommandHandlers.selectAll,\n            'tw.cursor.selectWord': cursorCommandHandlers.selectWord,\n            'tw.cursor.selectBlock': cursorCommandHandlers.selectBlock,\n            'tw.history.undo': historyCommandHandlers.undo,\n            'tw.history.redo': historyCommandHandlers.redo,\n            'tw.state.insert': stateCommandHandlers.insert,\n            'tw.state.deleteBackward': stateCommandHandlers.deleteBackward,\n            'tw.state.deleteForward': stateCommandHandlers.deleteForward,\n            'tw.state.breakLine': stateCommandHandlers.breakLine,\n            'tw.state.applyAttribute': stateCommandHandlers.applyAttribute,\n            'tw.state.applyAttributeAround': stateCommandHandlers.applyAttributeAround,\n            'tw.view.focus': viewCommandHandlers.focus,\n            'tw.view.blur': viewCommandHandlers.blur,\n        },\n        components: {\n            doc: DocComponent,\n            paragraph: ParagraphComponent,\n            text: TextComponent,\n        },\n        cursor: {\n            disable: false,\n            caretColor: \"hsla(213, 100%, 50%, 1)\",\n            caretInactiveColor: 'hsla(0, 0%, 0%, 0.5)',\n            selectionColor: \"hsla(213, 100%, 50%, 0.2)\",\n            selectionInactiveColor: 'hsla(0, 0%, 0%, 0.08)',\n        },\n        history: {\n            collapseThreshold: 500,\n            maxCollapseDuration: 2000,\n        },\n        keyBindings: {\n            common: {\n                left: { command: 'tw.cursor.moveBackward', preventDefault: true },\n                right: { command: 'tw.cursor.moveForward', preventDefault: true },\n                up: { command: 'tw.cursor.moveBackwardByLine', preventDefault: true },\n                down: { command: 'tw.cursor.moveForwardByLine', preventDefault: true },\n                'shift+left': { command: 'tw.cursor.moveHeadBackward', preventDefault: true },\n                'shift+right': { command: 'tw.cursor.moveHeadForward', preventDefault: true },\n                'shift+up': { command: 'tw.cursor.moveHeadBackwardByLine', preventDefault: true },\n                'shift+down': { command: 'tw.cursor.moveHeadForwardByLine', preventDefault: true },\n                backspace: { command: 'tw.state.deleteBackward', preventDefault: true },\n                delete: { command: 'tw.state.deleteForward', preventDefault: true },\n                enter: { command: 'tw.state.breakLine', preventDefault: true },\n            },\n            macos: {\n                'alt+left': { command: 'tw.cursor.moveBackwardByWord' },\n                'alt+right': { command: 'tw.cursor.moveForwardByWord' },\n                'shift+alt+left': { command: 'tw.cursor.moveHeadBackwardByWord' },\n                'shift+alt+right': { command: 'tw.cursor.moveHeadForwardByWord' },\n                'cmd+left': { command: 'tw.cursor.moveToLineStart' },\n                'cmd+right': { command: 'tw.cursor.moveToLineEnd' },\n                'cmd+up': { command: 'tw.cursor.moveToDocStart' },\n                'cmd+down': { command: 'tw.cursor.moveToDocEnd' },\n                'shift+cmd+left': { command: 'tw.cursor.moveHeadToLineStart' },\n                'shift+cmd+right': { command: 'tw.cursor.moveHeadToLineEnd' },\n                'shift+cmd+up': { command: 'tw.cursor.moveHeadToDocStart' },\n                'shift+cmd+down': { command: 'tw.cursor.moveHeadToDocEnd' },\n                'cmd+a': { command: 'tw.cursor.selectAll' },\n                'cmd+z': { command: 'tw.history.undo', preventDefault: true },\n                'shift+cmd+z': { command: 'tw.history.redo', preventDefault: true },\n            },\n            windows: {\n                'ctrl+left': { command: 'tw.cursor.moveBackwardByWord' },\n                'ctrl+right': { command: 'tw.cursor.moveForwardByWord' },\n                'ctrl+shift+left': { command: 'tw.cursor.moveHeadBackwardByWord' },\n                'ctrl+shift+right': { command: 'tw.cursor.moveHeadForwardByWord' },\n                home: { command: 'tw.cursor.moveToLineStart' },\n                end: { command: 'tw.cursor.moveToLineEnd' },\n                'ctrl+home': { command: 'tw.cursor.moveToDocStart' },\n                'ctrl+end': { command: 'tw.cursor.moveToDocEnd' },\n                'shift+home': { command: 'tw.cursor.moveHeadToLineStart' },\n                'shift+end': { command: 'tw.cursor.moveHeadToLineEnd' },\n                'ctrl+shift+home': { command: 'tw.cursor.moveHeadToDocStart' },\n                'ctrl+shift+end': { command: 'tw.cursor.moveHeadToDocEnd' },\n                'ctrl+a': { command: 'tw.cursor.selectAll' },\n                'ctrl+z': { command: 'tw.history.undo', preventDefault: true },\n                'ctrl+shift+z': { command: 'tw.history.redo', preventDefault: true },\n            },\n            linux: {\n                'ctrl+left': { command: 'tw.cursor.moveBackwardByWord' },\n                'ctrl+right': { command: 'tw.cursor.moveForwardByWord' },\n                'ctrl+shift+left': { command: 'tw.cursor.moveHeadBackwardByWord' },\n                'ctrl+shift+right': { command: 'tw.cursor.moveHeadForwardByWord' },\n                home: { command: 'tw.cursor.moveToLineStart' },\n                end: { command: 'tw.cursor.moveToLineEnd' },\n                'ctrl+home': { command: 'tw.cursor.moveToDocStart' },\n                'ctrl+end': { command: 'tw.cursor.moveToDocEnd' },\n                'shift+home': { command: 'tw.cursor.moveHeadToLineStart' },\n                'shift+end': { command: 'tw.cursor.moveHeadToLineEnd' },\n                'ctrl+shift+home': { command: 'tw.cursor.moveHeadToDocStart' },\n                'ctrl+shift+end': { command: 'tw.cursor.moveHeadToDocEnd' },\n                'ctrl+a': { command: 'tw.cursor.selectAll' },\n                'ctrl+z': { command: 'tw.history.undo', preventDefault: true },\n                'ctrl+shift+z': { command: 'tw.history.redo', preventDefault: true },\n            },\n        },\n        page: {\n            width: 816,\n            height: 1056,\n            paddingTop: 40,\n            paddingBottom: 40,\n            paddingLeft: 40,\n            paddingRight: 40,\n        },\n    };\n}\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { EventEmitter } from '../event/emitter';\nvar CursorState = /** @class */ (function () {\n    function CursorState(configService, renderService, modelService) {\n        this.renderService = renderService;\n        this.modelService = modelService;\n        this.internalCursor = null;\n        this.didUpdateEventEmitter = new EventEmitter();\n        if (!configService.getConfig().cursor.disable) {\n            this.internalCursor = {\n                anchor: 0,\n                head: 0,\n                leftLock: 0,\n            };\n        }\n    }\n    Object.defineProperty(CursorState.prototype, \"hasCursor\", {\n        get: function () {\n            return !!this.internalCursor;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(CursorState.prototype, \"cursor\", {\n        get: function () {\n            this.assertCursor();\n            return __assign({}, this.internalCursor);\n        },\n        enumerable: false,\n        configurable: true\n    });\n    CursorState.prototype.set = function (anchor, head) {\n        this.assertCursor();\n        this.internalCursor = {\n            anchor: anchor,\n            head: head,\n            leftLock: this.internalCursor.leftLock,\n        };\n        this.didUpdateEventEmitter.emit({});\n    };\n    CursorState.prototype.setLeftLock = function (leftLock) {\n        this.assertCursor();\n        this.internalCursor = {\n            anchor: this.internalCursor.anchor,\n            head: this.internalCursor.head,\n            leftLock: leftLock,\n        };\n    };\n    CursorState.prototype.onDidUpdate = function (listener) {\n        return this.didUpdateEventEmitter.on(listener);\n    };\n    CursorState.prototype.assertCursor = function () {\n        if (!this.internalCursor) {\n            throw new Error('Cursor is disabled.');\n        }\n    };\n    return CursorState;\n}());\nexport { CursorState };\n","import { CursorState } from './state';\nvar CursorService = /** @class */ (function () {\n    function CursorService(configService, renderService, modelService) {\n        this.state = new CursorState(configService, renderService, modelService);\n    }\n    CursorService.prototype.hasCursor = function () {\n        return this.state.hasCursor;\n    };\n    CursorService.prototype.getCursor = function () {\n        return this.state.cursor;\n    };\n    CursorService.prototype.setCursor = function (anchor, head) {\n        this.state.set(anchor, head);\n    };\n    CursorService.prototype.setLeftLock = function (leftLock) {\n        this.state.setLeftLock(leftLock);\n    };\n    CursorService.prototype.onDidUpdate = function (listener) {\n        return this.state.onDidUpdate(listener);\n    };\n    return CursorService;\n}());\nexport { CursorService };\n","var DOMService = /** @class */ (function () {\n    function DOMService() {\n    }\n    DOMService.prototype.getWindow = function () {\n        return window;\n    };\n    DOMService.prototype.getDocument = function () {\n        return document;\n    };\n    DOMService.prototype.getBody = function () {\n        return document.body;\n    };\n    DOMService.prototype.createElement = function (tagName) {\n        return document.createElement(tagName);\n    };\n    DOMService.prototype.createContainer = function () {\n        var container = this.createElement('div');\n        container.setAttribute('data-tw-role', 'container');\n        return container;\n    };\n    DOMService.prototype.createHiddenIframe = function () {\n        var iframe = this.createElement('iframe');\n        iframe.scrolling = 'no';\n        iframe.src = 'about:blank';\n        iframe.style.width = '0';\n        iframe.style.height = '0';\n        iframe.style.border = 'none';\n        iframe.style.position = 'fixed';\n        iframe.style.zIndex = '-1';\n        iframe.style.opacity = '0';\n        iframe.style.overflow = 'hidden';\n        iframe.style.left = '-1000000px';\n        iframe.style.top = '-1000000px';\n        return iframe;\n    };\n    DOMService.prototype.createMutationObserver = function (callback) {\n        return new MutationObserver(callback);\n    };\n    return DOMService;\n}());\nexport { DOMService };\n","var HistoryAction = /** @class */ (function () {\n    function HistoryAction() {\n        this.internalTransformationResults = [];\n        this.beganAt = Date.now();\n        this.internalEndedAt = this.beganAt;\n    }\n    Object.defineProperty(HistoryAction.prototype, \"endedAt\", {\n        get: function () {\n            return this.internalEndedAt;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(HistoryAction.prototype, \"transformationResults\", {\n        get: function () {\n            return this.internalTransformationResults;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    HistoryAction.prototype.recordTransformationResult = function (transformationResult) {\n        this.transformationResults.push(transformationResult);\n        this.internalEndedAt = Date.now();\n    };\n    return HistoryAction;\n}());\nexport { HistoryAction };\n","import { HistoryAction } from './action';\nvar HistoryState = /** @class */ (function () {\n    function HistoryState(configService, transformService) {\n        var _this = this;\n        this.configService = configService;\n        this.transformService = transformService;\n        this.actions = [];\n        this.offset = -1;\n        this.handleDidApplyTransformation = function (event) {\n            var result = event.result;\n            // Do not record undo\n            if (_this.offset + 1 < _this.actions.length &&\n                _this.actions[_this.offset + 1].transformationResults.some(function (tnResult) { return tnResult.reverseTransformation === result.transformation; })) {\n                return;\n            }\n            // Do not record redo\n            if (_this.offset >= 0 &&\n                _this.actions[_this.offset].transformationResults.some(function (tnResult) { return tnResult.transformation === result.transformation; })) {\n                return;\n            }\n            if (_this.offset < 0) {\n                _this.recordToNewAction(result);\n                return;\n            }\n            var currentItem = _this.actions[_this.offset];\n            var now = Date.now();\n            if (now - currentItem.beganAt < _this.maxCollapseDuration &&\n                now - currentItem.endedAt < _this.collapseThreshold) {\n                _this.recordToLastAction(result);\n            }\n            else {\n                _this.recordToNewAction(result);\n            }\n        };\n        var config = configService.getConfig();\n        this.maxCollapseDuration = config.history.maxCollapseDuration;\n        this.collapseThreshold = config.history.collapseThreshold;\n        transformService.onDidApplyTransformation(this.handleDidApplyTransformation);\n    }\n    HistoryState.prototype.undo = function () {\n        var action = this.consumeNextUndoableAction();\n        if (!action) {\n            return;\n        }\n        var results = action.transformationResults;\n        if (results.length === 0) {\n            return;\n        }\n        for (var n = results.length - 1; n >= 0; n--) {\n            var result = results[n];\n            this.transformService.applyTransformation(result.reverseTransformation);\n        }\n    };\n    HistoryState.prototype.redo = function () {\n        var _this = this;\n        var action = this.consumeNextRedoableAction();\n        if (!action) {\n            return;\n        }\n        action.transformationResults.forEach(function (result) {\n            return _this.transformService.applyTransformation(result.transformation);\n        });\n    };\n    HistoryState.prototype.consumeNextUndoableAction = function () {\n        if (this.offset < 0) {\n            return undefined;\n        }\n        var action = this.actions[this.offset];\n        this.offset--;\n        return action;\n    };\n    HistoryState.prototype.consumeNextRedoableAction = function () {\n        if (this.offset >= this.actions.length - 1) {\n            return undefined;\n        }\n        this.offset++;\n        return this.actions[this.offset];\n    };\n    HistoryState.prototype.recordToNewAction = function (result) {\n        if (result.changeResults.length === 0) {\n            return;\n        }\n        if (this.offset < this.actions.length - 1) {\n            this.actions.splice(this.offset + 1, this.actions.length - 1 - this.offset);\n        }\n        var action = new HistoryAction();\n        action.recordTransformationResult(result);\n        this.actions.push(action);\n        this.offset++;\n    };\n    HistoryState.prototype.recordToLastAction = function (result) {\n        var action = this.actions[this.offset];\n        if (!action) {\n            throw new Error('Error recording applied transformation, history is empty.');\n        }\n        if (this.offset < this.actions.length - 1) {\n            this.actions.splice(this.offset + 1, this.actions.length - 1 - this.offset);\n        }\n        action.recordTransformationResult(result);\n    };\n    return HistoryState;\n}());\nexport { HistoryState };\n","import { HistoryState } from './state';\nvar HistoryService = /** @class */ (function () {\n    function HistoryService(configService, transformService) {\n        this.state = new HistoryState(configService, transformService);\n    }\n    HistoryService.prototype.undo = function () {\n        this.state.undo();\n    };\n    HistoryService.prototype.redo = function () {\n        this.state.redo();\n    };\n    return HistoryService;\n}());\nexport { HistoryService };\n","export function detectPlatform() {\n    if (navigator.platform.startsWith('Linux')) {\n        return 'Linux';\n    }\n    if (['Windows', 'Win16', 'Win32'].includes(navigator.platform)) {\n        return 'Windows';\n    }\n    if (['Macintosh', 'MacIntel', 'MacPPC', 'Mac68K'].includes(navigator.platform)) {\n        return 'macOS';\n    }\n    return 'Unknown';\n}\n","var __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { detectPlatform } from '../util/platform';\nvar KeyBindingService = /** @class */ (function () {\n    function KeyBindingService(configService, commandService, viewService) {\n        var _this = this;\n        this.configService = configService;\n        this.commandService = commandService;\n        this.viewService = viewService;\n        this.keyBindings = new Map();\n        this.handleDidPressKey = function (event) {\n            var _a;\n            var keyBinding = _this.keyBindings.get(event.key);\n            if (!keyBinding) {\n                return;\n            }\n            if (keyBinding.preventDefault) {\n                event.originalKeyboardEvent.preventDefault();\n            }\n            (_a = _this.commandService).executeCommand.apply(_a, __spreadArrays([keyBinding.command], keyBinding.args));\n        };\n        var keyBindingsConfig = this.configService.getConfig().keyBindings;\n        this.bindKeys(keyBindingsConfig.common);\n        switch (detectPlatform()) {\n            case 'macOS':\n                if (keyBindingsConfig.macos) {\n                    this.bindKeys(keyBindingsConfig.macos);\n                }\n                break;\n            case 'Windows':\n                if (keyBindingsConfig.windows) {\n                    this.bindKeys(keyBindingsConfig.windows);\n                }\n                break;\n            case 'Linux':\n                if (keyBindingsConfig.linux) {\n                    this.bindKeys(keyBindingsConfig.linux);\n                }\n                break;\n        }\n        viewService.onDidPressKey(this.handleDidPressKey);\n    }\n    KeyBindingService.prototype.bindKeys = function (config) {\n        for (var key in config) {\n            var binding = config[key];\n            this.keyBindings.set(key, {\n                command: binding.command,\n                args: binding.args || [],\n                preventDefault: binding.preventDefault || false,\n            });\n        }\n    };\n    return KeyBindingService;\n}());\nexport { KeyBindingService };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nimport { Node } from '../tree/node';\nimport { NodeList } from '../tree/node-list';\nimport { generateId } from '../util/id';\nvar LayoutNode = /** @class */ (function (_super) {\n    __extends(LayoutNode, _super);\n    function LayoutNode(renderId, text, children, paddingTop, paddingBottom, paddingLeft, paddingRight) {\n        var _this = _super.call(this, generateId()) || this;\n        _this.renderId = renderId;\n        _this.text = text;\n        _this.paddingTop = paddingTop;\n        _this.paddingBottom = paddingBottom;\n        _this.paddingLeft = paddingLeft;\n        _this.paddingRight = paddingRight;\n        _this.internalNeedView = true;\n        _this.internalChildren = new NodeList(children);\n        children.forEach(function (child) {\n            child.parent = _this;\n        });\n        return _this;\n    }\n    Object.defineProperty(LayoutNode.prototype, \"contentLength\", {\n        get: function () {\n            if (this.leaf) {\n                return this.text.length;\n            }\n            return this.children.length;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutNode.prototype, \"size\", {\n        get: function () {\n            if (this.internalSize === undefined) {\n                if (this.leaf) {\n                    this.internalSize = this.text.length;\n                }\n                else {\n                    this.internalSize = this.children.reduce(function (size, child) { return size + child.size; }, 0);\n                }\n            }\n            return this.internalSize;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutNode.prototype, \"paddingVertical\", {\n        get: function () {\n            return this.paddingTop + this.paddingBottom;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutNode.prototype, \"paddingHorizontal\", {\n        get: function () {\n            return this.paddingLeft + this.paddingRight;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutNode.prototype, \"innerWidth\", {\n        get: function () {\n            return this.width - this.paddingHorizontal;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutNode.prototype, \"innerHeight\", {\n        get: function () {\n            return this.height - this.paddingVertical;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutNode.prototype, \"needView\", {\n        get: function () {\n            return this.internalNeedView;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    LayoutNode.prototype.clearNeedView = function () {\n        this.internalNeedView = false;\n    };\n    LayoutNode.prototype.resolvePosition = function (position) {\n        if (position < 0 || position >= this.size) {\n            throw new Error(\"Offset \" + position + \" is out of range.\");\n        }\n        if (this.leaf) {\n            return [{ node: this, offset: position, position: position }];\n        }\n        var cumulatedSize = 0;\n        for (var n = 0, nn = this.children.length; n < nn; n++) {\n            var child = this.children.at(n);\n            var childSize = child.size;\n            if (cumulatedSize + childSize > position) {\n                return __spreadArrays([{ node: this, offset: n, position: position }], child.resolvePosition(position - cumulatedSize));\n            }\n            cumulatedSize += childSize;\n        }\n        throw new Error('Offset cannot be resolved.');\n    };\n    return LayoutNode;\n}(Node));\nexport { LayoutNode };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { LayoutNode } from './node';\nvar LayoutAtom = /** @class */ (function (_super) {\n    __extends(LayoutAtom, _super);\n    function LayoutAtom(renderId, width, height) {\n        var _this = _super.call(this, renderId, ' ', [], 0, 0, 0, 0) || this;\n        _this.width = width;\n        _this.height = height;\n        return _this;\n    }\n    Object.defineProperty(LayoutAtom.prototype, \"type\", {\n        get: function () {\n            return 'atom';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutAtom.prototype, \"root\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutAtom.prototype, \"leaf\", {\n        get: function () {\n            return true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    LayoutAtom.prototype.convertCoordinatesToPosition = function (x, y) {\n        if (x < this.innerWidth / 2) {\n            return 0;\n        }\n        return 1;\n    };\n    LayoutAtom.prototype.resolveBoundingBoxes = function (from, to) {\n        if (from < 0 || to > this.size || from > to) {\n            throw new Error('Invalid range.');\n        }\n        return {\n            node: this,\n            boundingBoxes: [\n                {\n                    from: from,\n                    to: to,\n                    width: from === to ? 0 : this.innerWidth,\n                    height: this.innerHeight,\n                    left: from === 0 ? this.paddingLeft : this.paddingLeft + this.innerWidth,\n                    right: to === 1 ? this.paddingRight : this.paddingRight + this.innerWidth,\n                    top: this.paddingTop,\n                    bottom: this.paddingBottom,\n                },\n            ],\n            children: [],\n        };\n    };\n    return LayoutAtom;\n}(LayoutNode));\nexport { LayoutAtom };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { LayoutNode } from './node';\nvar LayoutBlock = /** @class */ (function (_super) {\n    __extends(LayoutBlock, _super);\n    function LayoutBlock(renderId, children, width, paddingTop, paddingBottom, paddingLeft, paddingRight) {\n        var _this = _super.call(this, renderId, '', children, paddingTop, paddingBottom, paddingLeft, paddingRight) || this;\n        _this.width = width;\n        return _this;\n    }\n    Object.defineProperty(LayoutBlock.prototype, \"type\", {\n        get: function () {\n            return 'block';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutBlock.prototype, \"root\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutBlock.prototype, \"leaf\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutBlock.prototype, \"height\", {\n        get: function () {\n            if (this.internalHeight === undefined) {\n                this.internalHeight = this.children.reduce(function (height, child) { return height + child.height; }, this.paddingVertical);\n            }\n            return this.internalHeight;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    LayoutBlock.prototype.convertCoordinatesToPosition = function (x, y) {\n        var offset = 0;\n        var cumulatedHeight = 0;\n        for (var n = 0, nn = this.children.length; n < nn; n++) {\n            var child = this.children.at(n);\n            var childHeight = child.height;\n            if (y >= cumulatedHeight && y <= cumulatedHeight + childHeight) {\n                offset += child.convertCoordinatesToPosition(x, 0);\n                break;\n            }\n            offset += child.size;\n            cumulatedHeight += childHeight;\n        }\n        if (offset === this.size) {\n            var lastChild = this.lastChild;\n            if (lastChild) {\n                offset -= lastChild.size;\n                offset += lastChild.convertCoordinatesToPosition(x, lastChild.height);\n            }\n        }\n        return offset;\n    };\n    LayoutBlock.prototype.resolveBoundingBoxes = function (from, to) {\n        var _this = this;\n        if (from < 0 || to > this.size || from > to) {\n            throw new Error('Invalid range.');\n        }\n        var resolvedChildren = [];\n        var boundingBoxes = [];\n        var cumulatedOffset = 0;\n        var cumulatedHeight = 0;\n        this.children.forEach(function (child) {\n            if (cumulatedOffset + child.size > from && cumulatedOffset <= to) {\n                var childFrom_1 = Math.max(0, from - cumulatedOffset);\n                var childTo_1 = Math.min(child.size, to - cumulatedOffset);\n                var childResult = child.resolveBoundingBoxes(childFrom_1, childTo_1);\n                resolvedChildren.push(childResult);\n                childResult.boundingBoxes.forEach(function (boundingBox) {\n                    boundingBoxes.push({\n                        from: cumulatedOffset + childFrom_1,\n                        to: cumulatedOffset + childTo_1,\n                        width: boundingBox.width,\n                        height: boundingBox.height,\n                        top: cumulatedHeight + _this.paddingTop + boundingBox.top,\n                        bottom: _this.height - _this.paddingTop - cumulatedHeight - child.height + boundingBox.bottom,\n                        left: boundingBox.left,\n                        right: boundingBox.right,\n                    });\n                });\n            }\n            cumulatedOffset += child.size;\n            cumulatedHeight += child.height;\n        });\n        return {\n            node: this,\n            boundingBoxes: boundingBoxes,\n            children: resolvedChildren,\n        };\n    };\n    return LayoutBlock;\n}(LayoutNode));\nexport { LayoutBlock };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { LayoutNode } from './node';\nvar LayoutDoc = /** @class */ (function (_super) {\n    __extends(LayoutDoc, _super);\n    function LayoutDoc(renderId, children, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight) {\n        var _this = _super.call(this, renderId, '', children, paddingTop, paddingBottom, paddingLeft, paddingRight) || this;\n        _this.width = width;\n        _this.height = height;\n        return _this;\n    }\n    Object.defineProperty(LayoutDoc.prototype, \"type\", {\n        get: function () {\n            return 'doc';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutDoc.prototype, \"root\", {\n        get: function () {\n            return true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutDoc.prototype, \"leaf\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    LayoutDoc.prototype.convertCoordinatesToPosition = function (x, y) {\n        throw new Error('Use page to convert coordinates to position.');\n    };\n    LayoutDoc.prototype.resolveBoundingBoxes = function (from, to) {\n        if (from < 0 || to > this.size || from > to) {\n            throw new Error('Invalid range.');\n        }\n        var resolvedChildren = [];\n        var cumulatedOffset = 0;\n        this.children.forEach(function (child) {\n            if (cumulatedOffset + child.size > from && cumulatedOffset <= to) {\n                var childFrom = Math.max(0, from - cumulatedOffset);\n                var childTo = Math.min(child.size, to - cumulatedOffset);\n                var resolvedChild = child.resolveBoundingBoxes(childFrom, childTo);\n                resolvedChildren.push(resolvedChild);\n            }\n            cumulatedOffset += child.size;\n        });\n        return {\n            node: this,\n            boundingBoxes: [],\n            children: resolvedChildren,\n        };\n    };\n    return LayoutDoc;\n}(LayoutNode));\nexport { LayoutDoc };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { LayoutNode } from './node';\nvar LayoutLine = /** @class */ (function (_super) {\n    __extends(LayoutLine, _super);\n    function LayoutLine(children, width) {\n        var _this = _super.call(this, null, '', children, 0, 8, 0, 0) || this;\n        _this.width = width;\n        return _this;\n    }\n    Object.defineProperty(LayoutLine.prototype, \"type\", {\n        get: function () {\n            return 'line';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutLine.prototype, \"root\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutLine.prototype, \"leaf\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutLine.prototype, \"height\", {\n        get: function () {\n            if (this.internalHeight === undefined) {\n                this.internalHeight =\n                    this.children.reduce(function (height, child) { return Math.max(height, child.height); }, 0) + this.paddingVertical;\n            }\n            return this.internalHeight;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutLine.prototype, \"contentWidth\", {\n        get: function () {\n            if (this.internalContentWidth === undefined) {\n                this.internalContentWidth = this.children.reduce(function (contentWidth, child) { return contentWidth + child.width; }, 0);\n            }\n            return this.internalContentWidth;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    LayoutLine.prototype.convertCoordinatesToPosition = function (x, y) {\n        var offset = 0;\n        var cumulatedWidth = 0;\n        for (var n = 0, nn = this.children.length; n < nn; n++) {\n            var child = this.children.at(n);\n            var childWidth = child.width;\n            if (x >= cumulatedWidth && x <= cumulatedWidth + childWidth) {\n                offset += child.convertCoordinatesToPosition(x - cumulatedWidth, 0);\n                break;\n            }\n            offset += child.size;\n            cumulatedWidth += childWidth;\n        }\n        if (offset === this.size) {\n            var lastChild = this.lastChild;\n            if (lastChild && lastChild.type === 'text') {\n                var lastWord = lastChild.lastChild;\n                if (lastWord && lastWord.whitespaceSize > 0) {\n                    offset--;\n                }\n            }\n        }\n        return offset;\n    };\n    LayoutLine.prototype.resolveBoundingBoxes = function (from, to) {\n        if (from < 0 || to > this.size || from > to) {\n            throw new Error('Invalid range.');\n        }\n        var resolvedChildren = [];\n        var cumulatedOffset = 0;\n        var left1 = null;\n        var left2 = 0;\n        for (var n = 0, nn = this.children.length; n < nn; n++) {\n            if (cumulatedOffset > to) {\n                break;\n            }\n            var child = this.children.at(n);\n            if (cumulatedOffset + child.size > from) {\n                var childFrom = Math.max(0, from - cumulatedOffset);\n                var childTo = Math.min(child.size, to - cumulatedOffset);\n                var resolvedChild = child.resolveBoundingBoxes(childFrom, childTo);\n                resolvedChildren.push(resolvedChild);\n                if (left1 === null) {\n                    left1 = left2 + resolvedChild.boundingBoxes[0].left;\n                }\n                left2 += resolvedChild.boundingBoxes\n                    .slice(0, resolvedChild.boundingBoxes.length - 1)\n                    .reduce(function (width, box) { return width + box.left + box.width + box.right; }, 0);\n                left2 += resolvedChild.boundingBoxes[0].left + resolvedChild.boundingBoxes[0].width;\n            }\n            else {\n                left2 += child.width;\n            }\n            cumulatedOffset += child.size;\n        }\n        return {\n            node: this,\n            boundingBoxes: [\n                {\n                    from: from,\n                    to: to,\n                    width: left2 - left1,\n                    height: from === to ? this.innerHeight : this.height,\n                    left: this.paddingLeft + left1,\n                    right: this.width - this.paddingLeft - left2,\n                    top: from === to ? this.paddingTop : 0,\n                    bottom: from === to ? this.paddingBottom : 0,\n                },\n            ],\n            children: resolvedChildren,\n        };\n    };\n    return LayoutLine;\n}(LayoutNode));\nexport { LayoutLine };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { LayoutNode } from './node';\nvar LayoutPage = /** @class */ (function (_super) {\n    __extends(LayoutPage, _super);\n    function LayoutPage(children, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight) {\n        var _this = _super.call(this, null, '', children, paddingTop, paddingBottom, paddingLeft, paddingRight) || this;\n        _this.width = width;\n        _this.height = height;\n        return _this;\n    }\n    Object.defineProperty(LayoutPage.prototype, \"type\", {\n        get: function () {\n            return 'page';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutPage.prototype, \"root\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutPage.prototype, \"leaf\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutPage.prototype, \"contentHeight\", {\n        get: function () {\n            if (this.internalContentHeight === undefined) {\n                this.internalContentHeight = this.children.reduce(function (contentHeight, child) { return contentHeight + child.height; }, 0);\n            }\n            return this.internalContentHeight;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    LayoutPage.prototype.convertCoordinatesToPosition = function (x, y) {\n        var offset = 0;\n        var cumulatedHeight = 0;\n        var contentX = Math.min(Math.max(x - this.paddingLeft, 0), this.innerWidth);\n        var contentY = Math.min(Math.max(y - this.paddingTop, 0), this.innerHeight);\n        for (var n = 0, nn = this.children.length; n < nn; n++) {\n            var child = this.children.at(n);\n            var childHeight = child.height;\n            if (contentY >= cumulatedHeight && contentY <= cumulatedHeight + childHeight) {\n                offset += child.convertCoordinatesToPosition(contentX, contentY - cumulatedHeight);\n                break;\n            }\n            offset += child.size;\n            cumulatedHeight += childHeight;\n        }\n        if (offset === this.size) {\n            var lastChild = this.lastChild;\n            if (lastChild) {\n                offset -= lastChild.size;\n                offset += lastChild.convertCoordinatesToPosition(contentX, lastChild.height);\n            }\n        }\n        return offset;\n    };\n    LayoutPage.prototype.resolveBoundingBoxes = function (from, to) {\n        var _this = this;\n        if (from < 0 || to > this.size || from > to) {\n            throw new Error('Invalid range.');\n        }\n        var resolvedChildren = [];\n        var boundingBoxes = [];\n        var cumulatedOffset = 0;\n        var cumulatedHeight = 0;\n        this.children.forEach(function (child) {\n            if (cumulatedOffset + child.size > from && cumulatedOffset <= to) {\n                var childFrom_1 = Math.max(0, from - cumulatedOffset);\n                var childTo_1 = Math.min(child.size, to - cumulatedOffset);\n                var resolvedChild = child.resolveBoundingBoxes(childFrom_1, childTo_1);\n                resolvedChildren.push(resolvedChild);\n                resolvedChild.boundingBoxes.forEach(function (boundingBox) {\n                    boundingBoxes.push({\n                        from: cumulatedOffset + childFrom_1,\n                        to: cumulatedOffset + childTo_1,\n                        width: boundingBox.width,\n                        height: boundingBox.height,\n                        top: cumulatedHeight + _this.paddingTop + boundingBox.top,\n                        bottom: _this.height - _this.paddingTop - cumulatedHeight - child.height + boundingBox.bottom,\n                        left: boundingBox.left + _this.paddingLeft,\n                        right: boundingBox.right + _this.paddingRight,\n                    });\n                });\n            }\n            cumulatedOffset += child.size;\n            cumulatedHeight += child.height;\n        });\n        return {\n            node: this,\n            boundingBoxes: boundingBoxes,\n            children: resolvedChildren,\n        };\n    };\n    return LayoutPage;\n}(LayoutNode));\nexport { LayoutPage };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { LayoutNode } from './node';\nvar LayoutText = /** @class */ (function (_super) {\n    __extends(LayoutText, _super);\n    function LayoutText(renderId, children, paddingTop, paddingBottom, paddingLeft, paddingRight, font) {\n        var _this = _super.call(this, renderId, '', children, paddingTop, paddingBottom, paddingLeft, paddingRight) || this;\n        _this.font = font;\n        return _this;\n    }\n    Object.defineProperty(LayoutText.prototype, \"type\", {\n        get: function () {\n            return 'text';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutText.prototype, \"root\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutText.prototype, \"leaf\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutText.prototype, \"width\", {\n        get: function () {\n            if (this.internalWidth === undefined) {\n                this.internalWidth = this.children.reduce(function (width, child) { return width + child.width; }, this.paddingHorizontal);\n            }\n            return this.internalWidth;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutText.prototype, \"height\", {\n        get: function () {\n            if (this.internalHeight === undefined) {\n                this.internalHeight =\n                    this.children.reduce(function (height, child) { return Math.max(height, child.height); }, 0) + this.paddingVertical;\n            }\n            return this.internalHeight;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutText.prototype, \"trimmedWidth\", {\n        get: function () {\n            if (this.internalTrimmedWidth === undefined) {\n                var lastChild = this.lastChild;\n                if (!lastChild) {\n                    this.internalTrimmedWidth = 0;\n                }\n                else {\n                    this.internalTrimmedWidth = this.width - lastChild.width + lastChild.trimmedWidth;\n                }\n            }\n            return this.internalTrimmedWidth;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    LayoutText.prototype.convertCoordinatesToPosition = function (x, y) {\n        var offset = 0;\n        var cumulatedWidth = 0;\n        for (var n = 0, nn = this.children.length; n < nn; n++) {\n            var child = this.children.at(n);\n            var childWidth = child.width;\n            if (cumulatedWidth + childWidth >= x) {\n                offset += child.convertCoordinatesToPosition(x - cumulatedWidth, 0);\n                break;\n            }\n            offset += child.size;\n            cumulatedWidth += childWidth;\n        }\n        return offset;\n    };\n    LayoutText.prototype.resolveBoundingBoxes = function (from, to) {\n        if (from < 0 || to > this.size || from > to) {\n            throw new Error('Invalid range.');\n        }\n        var resolvedChildren = [];\n        var cumulatedOffset = 0;\n        var left1 = null;\n        var left2 = 0;\n        for (var n = 0, nn = this.children.length; n < nn; n++) {\n            if (cumulatedOffset > to) {\n                break;\n            }\n            var child = this.children.at(n);\n            if (cumulatedOffset + child.size > from) {\n                var childFrom = Math.max(0, from - cumulatedOffset);\n                var childTo = Math.min(child.size, to - cumulatedOffset);\n                var resolvedChild = child.resolveBoundingBoxes(childFrom, childTo);\n                resolvedChildren.push(resolvedChild);\n                if (left1 === null) {\n                    left1 = left2 + resolvedChild.boundingBoxes[0].left;\n                }\n                left2 += resolvedChild.boundingBoxes\n                    .slice(0, resolvedChild.boundingBoxes.length - 1)\n                    .reduce(function (width, box) { return width + box.left + box.width + box.right; }, 0);\n                left2 += resolvedChild.boundingBoxes[0].left + resolvedChild.boundingBoxes[0].width;\n            }\n            else {\n                left2 += child.width;\n            }\n            cumulatedOffset += child.size;\n        }\n        return {\n            node: this,\n            boundingBoxes: [\n                {\n                    from: from,\n                    to: to,\n                    width: left2 - left1,\n                    height: this.innerHeight,\n                    left: this.paddingLeft + left1,\n                    right: this.width - this.paddingLeft - left2,\n                    top: this.paddingTop,\n                    bottom: this.paddingBottom,\n                },\n            ],\n            children: resolvedChildren,\n        };\n    };\n    return LayoutText;\n}(LayoutNode));\nexport { LayoutText };\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nimport { LayoutNode } from './node';\nvar LayoutWord = /** @class */ (function (_super) {\n    __extends(LayoutWord, _super);\n    function LayoutWord(renderId, text, whitespaceSize, font, textService) {\n        var _this = _super.call(this, renderId, text, [], 0, 0, 0, 0) || this;\n        _this.whitespaceSize = whitespaceSize;\n        _this.font = font;\n        _this.textService = textService;\n        return _this;\n    }\n    Object.defineProperty(LayoutWord.prototype, \"type\", {\n        get: function () {\n            return 'word';\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutWord.prototype, \"root\", {\n        get: function () {\n            return false;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutWord.prototype, \"leaf\", {\n        get: function () {\n            return true;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutWord.prototype, \"width\", {\n        get: function () {\n            var _a;\n            if (this.internalWidth === undefined) {\n                _a = this.measure(), this.internalWidth = _a[0], this.internalHeight = _a[1];\n            }\n            return this.internalWidth;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutWord.prototype, \"height\", {\n        get: function () {\n            var _a;\n            if (this.internalHeight === undefined) {\n                _a = this.measure(), this.internalWidth = _a[0], this.internalHeight = _a[1];\n            }\n            return this.internalHeight;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    Object.defineProperty(LayoutWord.prototype, \"trimmedWidth\", {\n        get: function () {\n            if (this.internalTrimmedWidth === undefined) {\n                var trimmedText = this.text.substring(0, this.text.length - this.whitespaceSize);\n                this.internalTrimmedWidth = this.textService.measure(trimmedText, this.font).width;\n            }\n            return this.internalTrimmedWidth;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    LayoutWord.prototype.convertCoordinatesToPosition = function (x, y) {\n        var lastWidth = 0;\n        var text = this.text;\n        for (var n = 0, nn = text.length; n < nn; n++) {\n            var measurement = this.textService.measure(text.substring(0, n), this.font);\n            var width_1 = measurement.width;\n            if (width_1 < x) {\n                lastWidth = width_1;\n                continue;\n            }\n            if (x - lastWidth < width_1 - x) {\n                return n - 1;\n            }\n            return n;\n        }\n        var width = this.width;\n        if (x - lastWidth < width - x) {\n            return text.length - 1;\n        }\n        return text.length;\n    };\n    LayoutWord.prototype.resolveBoundingBoxes = function (from, to) {\n        if (from < 0 || to > this.size || from > to) {\n            throw new Error('Invalid range.');\n        }\n        if (from === 0 && to === this.size) {\n            return {\n                node: this,\n                boundingBoxes: [\n                    {\n                        from: from,\n                        to: to,\n                        width: this.innerWidth,\n                        height: this.innerHeight,\n                        left: this.paddingLeft,\n                        right: this.paddingRight,\n                        top: this.paddingTop,\n                        bottom: this.paddingBottom,\n                    },\n                ],\n                children: [],\n            };\n        }\n        if (from === to) {\n            var left = this.textService.measure(this.text.slice(0, from), this.font).width;\n            return {\n                node: this,\n                boundingBoxes: [\n                    {\n                        from: from,\n                        to: to,\n                        width: 0,\n                        height: this.innerHeight,\n                        left: this.paddingLeft + left,\n                        right: this.width - this.paddingLeft - left,\n                        top: this.paddingTop,\n                        bottom: this.paddingBottom,\n                    },\n                ],\n                children: [],\n            };\n        }\n        var left1 = this.textService.measure(this.text.slice(0, from), this.font).width;\n        var left2 = this.textService.measure(this.text.slice(0, to), this.font).width;\n        return {\n            node: this,\n            boundingBoxes: [\n                {\n                    from: from,\n                    to: to,\n                    width: left2 - left1,\n                    height: this.innerHeight,\n                    left: this.paddingLeft + left1,\n                    right: this.innerWidth - this.paddingLeft - left2,\n                    top: this.paddingTop,\n                    bottom: this.paddingBottom,\n                },\n            ],\n            children: [],\n        };\n    };\n    LayoutWord.prototype.breakAt = function (offset) {\n        return [\n            new LayoutWord(this.renderId, this.text.substring(0, offset), 0, this.font, this.textService),\n            new LayoutWord(this.renderId, this.text.substring(offset), this.whitespaceSize, this.font, this.textService),\n        ];\n    };\n    LayoutWord.prototype.measure = function () {\n        var measurement = this.textService.measure(this.text, this.font);\n        return [measurement.width, measurement.height];\n    };\n    return LayoutWord;\n}(LayoutNode));\nexport { LayoutWord };\n","import { LayoutAtom } from './atom';\nimport { LayoutBlock } from './block';\nimport { LayoutDoc } from './doc';\nimport { LayoutLine } from './line';\nimport { LayoutPage } from './page';\nimport { LayoutText } from './text';\nimport { LayoutWord } from './word';\nvar LayoutEngine = /** @class */ (function () {\n    function LayoutEngine(textService) {\n        this.textService = textService;\n    }\n    LayoutEngine.prototype.updateDoc = function (doc, renderDoc) {\n        var _this = this;\n        if (!renderDoc.needLayout && doc) {\n            return doc;\n        }\n        var pages = [];\n        var childrenMap = {};\n        if (doc) {\n            doc.children.forEach(function (page) {\n                pages.push(page);\n                page.children.forEach(function (child) {\n                    if (!child.renderId) {\n                        throw new Error('Render ID missing on layout node.');\n                    }\n                    childrenMap[child.renderId] = childrenMap[child.renderId] || [];\n                    childrenMap[child.renderId].push(child);\n                });\n            });\n        }\n        var newChildren = [];\n        renderDoc.children.forEach(function (child) {\n            switch (child.type) {\n                case 'block':\n                    newChildren.push.apply(newChildren, _this.updateBlock(childrenMap[child.id] || [], child, renderDoc.width - renderDoc.paddingLeft - renderDoc.paddingRight));\n                    break;\n                default:\n                    throw new Error(\"Child type \" + child.type + \" is invalid.\");\n            }\n        });\n        renderDoc.clearNeedLayout();\n        return this.buildDoc(renderDoc, this.reflowPages(pages, newChildren, renderDoc.width, renderDoc.height, renderDoc.paddingTop, renderDoc.paddingBottom, renderDoc.paddingLeft, renderDoc.paddingRight));\n    };\n    LayoutEngine.prototype.updateBlock = function (blocks, renderBlock, width) {\n        var _this = this;\n        if (!renderBlock.needLayout && blocks.length > 0) {\n            return blocks;\n        }\n        var lines = [];\n        var childrenMap = {};\n        for (var _i = 0, blocks_1 = blocks; _i < blocks_1.length; _i++) {\n            var block = blocks_1[_i];\n            block.children.forEach(function (line) {\n                lines.push(line);\n                line.children.forEach(function (child) {\n                    if (!child.renderId) {\n                        throw new Error('Render ID missing on layout node.');\n                    }\n                    childrenMap[child.renderId] = childrenMap[child.renderId] || [];\n                    childrenMap[child.renderId].push(child);\n                });\n            });\n        }\n        var newChildren = [];\n        renderBlock.children.forEach(function (renderChild) {\n            switch (renderChild.type) {\n                case 'text':\n                    newChildren.push.apply(newChildren, _this.updateText(childrenMap[renderChild.id] || [], renderChild));\n                    break;\n                case 'atom':\n                    newChildren.push.apply(newChildren, _this.updateAtom(childrenMap[renderChild.id] || [], renderChild));\n                    break;\n                default:\n                    throw new Error(\"Child type \" + renderChild.type + \" is invalid.\");\n            }\n        });\n        renderBlock.clearNeedLayout();\n        return [\n            this.buildBlock(renderBlock, this.reflowLines(lines, newChildren, width - renderBlock.paddingLeft - renderBlock.paddingRight), width),\n        ];\n    };\n    LayoutEngine.prototype.updateText = function (texts, renderText) {\n        var _this = this;\n        if (!renderText.needLayout && texts.length > 0) {\n            return texts;\n        }\n        var newChildren = [];\n        this.textService.breakIntoWords(renderText.text).forEach(function (word) {\n            newChildren.push(_this.buildWord(renderText, word.text, word.whitespaceSize));\n        });\n        renderText.clearNeedLayout();\n        return [this.buildText(renderText, newChildren)];\n    };\n    LayoutEngine.prototype.updateAtom = function (atoms, renderAtom) {\n        if (!renderAtom.needLayout && atoms.length > 0) {\n            return atoms;\n        }\n        renderAtom.clearNeedLayout();\n        return [this.buildAtom(renderAtom)];\n    };\n    LayoutEngine.prototype.buildDoc = function (renderDoc, children) {\n        return new LayoutDoc(renderDoc.id, children, renderDoc.width, renderDoc.height, renderDoc.paddingTop, renderDoc.paddingBottom, renderDoc.paddingLeft, renderDoc.paddingRight);\n    };\n    LayoutEngine.prototype.buildBlock = function (renderBlock, children, width) {\n        if (renderBlock.type !== 'block') {\n            throw new Error('Expected block.');\n        }\n        return new LayoutBlock(renderBlock.id, children, width, renderBlock.paddingTop, renderBlock.paddingBottom, renderBlock.paddingLeft, renderBlock.paddingRight);\n    };\n    LayoutEngine.prototype.buildText = function (renderText, children) {\n        if (renderText.type !== 'text') {\n            throw new Error('Expected text.');\n        }\n        return new LayoutText(renderText.id, children, renderText.paddingTop, renderText.paddingBottom, renderText.paddingLeft, renderText.paddingRight, renderText.font);\n    };\n    LayoutEngine.prototype.buildWord = function (renderText, text, whitespaceSize) {\n        if (renderText.type !== 'text') {\n            throw new Error('Expected text.');\n        }\n        return new LayoutWord(renderText.id, text, whitespaceSize, renderText.font, this.textService);\n    };\n    LayoutEngine.prototype.buildAtom = function (renderAtom) {\n        if (renderAtom.type !== 'atom') {\n            throw new Error('Expected atom.');\n        }\n        return new LayoutAtom(renderAtom.id, renderAtom.width, renderAtom.height);\n    };\n    LayoutEngine.prototype.reflowPages = function (pages, nodes, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight) {\n        var innerHeight = height - paddingTop - paddingBottom;\n        nodes = nodes.slice();\n        var newPages = [];\n        while (nodes.length > 0) {\n            if (newPages.length < pages.length) {\n                var page = pages[newPages.length];\n                var reflowNeeded = false;\n                for (var n = 0, nn = page.children.length; n < nn; n++) {\n                    var child = page.children.at(n);\n                    if (child.id !== nodes[n].id) {\n                        reflowNeeded = true;\n                        break;\n                    }\n                }\n                if (!reflowNeeded) {\n                    newPages.push(page);\n                    nodes.splice(0, page.children.length);\n                    continue;\n                }\n            }\n            var newChildren = [];\n            var currentHeight = 0;\n            // Push whole nodes to page until either no more node or no longer fit\n            var node = nodes.shift();\n            while (node && currentHeight + node.height <= innerHeight) {\n                newChildren.push(node);\n                currentHeight += node.height;\n                node = nodes.shift();\n            }\n            // If there is remainder node, try to push part of it to page\n            if (node) {\n                var nodeChildren = [];\n                for (var m = 0, mm = node.children.length; m < mm; m++) {\n                    var nodeChild = node.children.at(m);\n                    if (currentHeight + nodeChild.height + node.paddingVertical > innerHeight) {\n                        break;\n                    }\n                    nodeChildren.push(nodeChild);\n                    currentHeight += nodeChild.height;\n                }\n                if (nodeChildren.length > 0) {\n                    switch (node.type) {\n                        case 'block':\n                            // Split block to two, one to push to this page, other goes back\n                            // to list of nodes to process\n                            var node1 = new LayoutBlock(node.renderId, nodeChildren, width, node.paddingTop, node.paddingBottom, node.paddingLeft, node.paddingRight);\n                            newChildren.push(node1);\n                            currentHeight += node1.height;\n                            var node2 = new LayoutBlock(node.renderId, node.children.slice(nodeChildren.length), width, node.paddingTop, node.paddingBottom, node.paddingLeft, node.paddingRight);\n                            nodes.unshift(node2);\n                            break;\n                        default:\n                            throw new Error('Invalid node type encountered while reflowing page.');\n                    }\n                }\n                else {\n                    nodes.unshift(node);\n                }\n            }\n            var newPage = new LayoutPage(newChildren, width, height, paddingTop, paddingBottom, paddingLeft, paddingRight);\n            newPages.push(newPage);\n        }\n        return newPages;\n    };\n    LayoutEngine.prototype.reflowLines = function (lines, nodes, width) {\n        nodes = nodes.slice();\n        var newLines = [];\n        while (nodes.length > 0) {\n            if (newLines.length < newLines.length) {\n                var line = lines[newLines.length];\n                var reflowNeeded = false;\n                for (var n = 0, nn = line.children.length; n < nn; n++) {\n                    var child = line.children.at(n);\n                    if (child.id !== nodes[n].id) {\n                        reflowNeeded = true;\n                        break;\n                    }\n                }\n                if (!reflowNeeded) {\n                    newLines.push(line);\n                    nodes.splice(0, line.children.length);\n                    continue;\n                }\n            }\n            var newChildren = [];\n            var currentWidth = 0;\n            // Push whole nodes to line until either no more node or no longer fit\n            var node = nodes.shift();\n            while (node && currentWidth + node.width <= width) {\n                newChildren.push(node);\n                currentWidth += node.width;\n                node = nodes.shift();\n            }\n            // If there is remainder node, try to push part of it to line\n            if (node) {\n                var nodeChildren = node.children.slice();\n                var newNodeChildren = [];\n                for (var m = 0; m < nodeChildren.length; m++) {\n                    var nodeChild = nodeChildren[m];\n                    if (nodeChild.type === 'word' && nodeChild.width > width) {\n                        var breakAt = nodeChild.convertCoordinatesToPosition(width, 0);\n                        if (nodeChild.resolveBoundingBoxes(breakAt, breakAt).boundingBoxes[0].left > width) {\n                            breakAt--;\n                        }\n                        var _a = nodeChild.breakAt(breakAt), brokenNodeChild1 = _a[0], brokenNodeChild2 = _a[1];\n                        nodeChild = brokenNodeChild1;\n                        nodeChildren.splice(m, 1, brokenNodeChild1, brokenNodeChild2);\n                    }\n                    if (currentWidth + nodeChild.width > width) {\n                        break;\n                    }\n                    newNodeChildren.push(nodeChild);\n                    currentWidth += nodeChild.width;\n                }\n                if (newNodeChildren.length > 0) {\n                    switch (node.type) {\n                        case 'text':\n                            // Split text to two, one to push to this line, other goes back\n                            // to list of nodes to process\n                            var text = node;\n                            var node1 = new LayoutText(text.renderId, newNodeChildren, text.paddingTop, text.paddingBottom, text.paddingLeft, text.paddingRight, text.font);\n                            newChildren.push(node1);\n                            currentWidth += node1.width;\n                            var node2 = new LayoutText(text.renderId, nodeChildren.slice(newNodeChildren.length), text.paddingTop, text.paddingBottom, text.paddingLeft, text.paddingRight, text.font);\n                            nodes.unshift(node2);\n                            break;\n                        case 'atom':\n                            // If atom is wider than line and line is empty, push atom to line\n                            // and let it clip\n                            if (node.width > width && newChildren.length === 0) {\n                                newChildren.push(node);\n                            }\n                            else {\n                                // Atom cannot be split, goes back to list of nodes to process\n                                nodes.unshift(node);\n                            }\n                            break;\n                        default:\n                            throw new Error('Invalid node type encountered while reflowing page.');\n                    }\n                }\n                else {\n                    nodes.unshift(node);\n                }\n            }\n            var newLine = new LayoutLine(newChildren, width);\n            newLines.push(newLine);\n        }\n        return newLines;\n    };\n    return LayoutEngine;\n}());\nexport { LayoutEngine };\n","import { EventEmitter } from '../event/emitter';\nimport { LayoutEngine } from './engine';\nvar LayoutState = /** @class */ (function () {\n    function LayoutState(renderService, textService) {\n        var _this = this;\n        this.renderService = renderService;\n        this.textService = textService;\n        this.didUpdateLayoutStateEventEmitter = new EventEmitter();\n        this.engine = new LayoutEngine(textService);\n        this.internalDoc = this.engine.updateDoc(null, renderService.getDoc());\n        renderService.onDidUpdateRenderState(function (event) { return _this.handleDidUpdateRenderStateEvent(event); });\n    }\n    Object.defineProperty(LayoutState.prototype, \"doc\", {\n        get: function () {\n            return this.internalDoc;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    LayoutState.prototype.onDidUpdateLayoutState = function (listener) {\n        return this.didUpdateLayoutStateEventEmitter.on(listener);\n    };\n    LayoutState.prototype.handleDidUpdateRenderStateEvent = function (event) {\n        this.update();\n    };\n    LayoutState.prototype.update = function () {\n        var renderDoc = this.renderService.getDoc();\n        this.internalDoc = this.engine.updateDoc(this.doc, renderDoc);\n        this.didUpdateLayoutStateEventEmitter.emit({});\n    };\n    return LayoutState;\n}());\nexport { LayoutState };\n","import { LayoutState } from './state';\nvar LayoutService = /** @class */ (function () {\n    function LayoutService(renderService, textService) {\n        this.state = new LayoutState(renderService, textService);\n    }\n    LayoutService.prototype.onDidUpdateLayoutState = function (listener) {\n        this.state.onDidUpdateLayoutState(listener);\n    };\n    LayoutService.prototype.getDoc = function () {\n        return this.state.doc;\n    };\n    LayoutService.prototype.resolvePosition = function (position) {\n        return this.state.doc.resolvePosition(position);\n    };\n    LayoutService.prototype.resolveBoundingBoxes = function (from, to) {\n        return this.state.doc.resolveBoundingBoxes(from, to);\n    };\n    return LayoutService;\n}());\nexport { LayoutService };\n","import { EventEmitter } from '../event/emitter';\nvar ModelState = /** @class */ (function () {\n    function ModelState(root, componentService) {\n        this.root = root;\n        this.componentService = componentService;\n        this.didUpdateEventEmitter = new EventEmitter();\n    }\n    ModelState.prototype.applyChange = function (change) {\n        var changeResult = change.apply(this.root, this.componentService);\n        this.didUpdateEventEmitter.emit({ changeResult: changeResult });\n        return changeResult;\n    };\n    ModelState.prototype.onDidUpdate = function (listener) {\n        return this.didUpdateEventEmitter.on(listener);\n    };\n    return ModelState;\n}());\nexport { ModelState };\n","import { ModelState } from './state';\nvar ModelService = /** @class */ (function () {\n    function ModelService(root, componentService) {\n        this.state = new ModelState(root, componentService);\n    }\n    ModelService.prototype.getRoot = function () {\n        return this.state.root;\n    };\n    ModelService.prototype.getRootSize = function () {\n        return this.state.root.size;\n    };\n    ModelService.prototype.applyChange = function (change) {\n        return this.state.applyChange(change);\n    };\n    ModelService.prototype.resolvePosition = function (position) {\n        return this.state.root.resolvePosition(position);\n    };\n    ModelService.prototype.onDidUpdateModelState = function (listener) {\n        this.state.onDidUpdate(listener);\n    };\n    return ModelService;\n}());\nexport { ModelService };\n","import { EventEmitter } from '../event/emitter';\nvar RenderState = /** @class */ (function () {\n    function RenderState(componentService, modelService) {\n        var _this = this;\n        this.componentService = componentService;\n        this.modelService = modelService;\n        this.didUpdateRenderStateEventEmitter = new EventEmitter();\n        var modelRoot = modelService.getRoot();\n        this.internalDoc = this.updateNode(null, modelRoot);\n        modelService.onDidUpdateModelState(function (event) { return _this.handleDidUpdateModelState(event); });\n    }\n    RenderState.prototype.onDidUpdateRenderState = function (listener) {\n        return this.didUpdateRenderStateEventEmitter.on(listener);\n    };\n    Object.defineProperty(RenderState.prototype, \"doc\", {\n        get: function () {\n            return this.internalDoc;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    RenderState.prototype.handleDidUpdateModelState = function (event) {\n        this.update();\n    };\n    RenderState.prototype.update = function () {\n        var modelRoot = this.modelService.getRoot();\n        this.internalDoc = this.updateNode(this.doc, modelRoot);\n        this.didUpdateRenderStateEventEmitter.emit({});\n    };\n    RenderState.prototype.updateNode = function (node, modelNode) {\n        var _this = this;\n        if (!modelNode.needRender && node) {\n            return node;\n        }\n        var childrenMap = {};\n        if (node) {\n            node.children.forEach(function (child) {\n                if (!child.modelId) {\n                    return;\n                }\n                childrenMap[child.modelId] = child;\n            });\n        }\n        var newChildren = [];\n        modelNode.children.forEach(function (modelChild) {\n            newChildren.push(_this.updateNode(childrenMap[modelChild.id] || null, modelChild));\n        });\n        modelNode.clearNeedRender();\n        return this.buildNode(modelNode, newChildren);\n    };\n    RenderState.prototype.buildNode = function (modelNode, children) {\n        var component = this.componentService.getComponent(modelNode.componentId);\n        var node = component.buildRenderNode(modelNode.partId, modelNode.id, modelNode.text, modelNode.attributes, children);\n        if (!node) {\n            throw new Error(\"Error building render node from model node \" + modelNode.id + \".\");\n        }\n        return node;\n    };\n    return RenderState;\n}());\nexport { RenderState };\n","import { RenderState } from './state';\nvar RenderService = /** @class */ (function () {\n    function RenderService(componentService, modelService) {\n        this.state = new RenderState(componentService, modelService);\n    }\n    RenderService.prototype.onDidUpdateRenderState = function (listener) {\n        this.state.onDidUpdateRenderState(listener);\n    };\n    RenderService.prototype.getDoc = function () {\n        return this.state.doc;\n    };\n    RenderService.prototype.getDocSize = function () {\n        return this.state.doc.size;\n    };\n    RenderService.prototype.resolvePosition = function (position) {\n        return this.state.doc.resolvePosition(position);\n    };\n    RenderService.prototype.resolveFont = function (from, to) {\n        var _a, _b, _c, _d, _e, _f, _g, _h;\n        var resolvedFont = {};\n        var nodeQueue = [[this.state.doc, 0]];\n        var _loop_1 = function () {\n            var _a = nodeQueue.shift(), node = _a[0], nodeFrom = _a[1];\n            if (node.text) {\n                var nodeFont = node.font;\n                var fontProp = void 0;\n                for (fontProp in nodeFont) {\n                    if (!(fontProp in resolvedFont)) {\n                        resolvedFont[fontProp] = nodeFont[fontProp];\n                    }\n                    else if (resolvedFont[fontProp] !== nodeFont[fontProp]) {\n                        resolvedFont[fontProp] = null;\n                    }\n                }\n            }\n            else {\n                var childOffset_1 = 0;\n                node.children.forEach(function (child, childIndex) {\n                    var childSize = child.size;\n                    var childFrom = nodeFrom + childOffset_1;\n                    var childTo = childFrom + childSize;\n                    var intersect;\n                    if (from === to) {\n                        intersect = childFrom <= to && childTo > from;\n                    }\n                    else {\n                        intersect = childFrom < to && childTo > from;\n                    }\n                    if (intersect) {\n                        nodeQueue.push([child, childFrom]);\n                    }\n                    childOffset_1 += childSize;\n                });\n            }\n        };\n        while (nodeQueue.length > 0) {\n            _loop_1();\n        }\n        return {\n            weight: (_a = resolvedFont.weight) !== null && _a !== void 0 ? _a : null,\n            size: (_b = resolvedFont.size) !== null && _b !== void 0 ? _b : null,\n            family: (_c = resolvedFont.family) !== null && _c !== void 0 ? _c : null,\n            letterSpacing: (_d = resolvedFont.letterSpacing) !== null && _d !== void 0 ? _d : null,\n            underline: (_e = resolvedFont.underline) !== null && _e !== void 0 ? _e : null,\n            italic: (_f = resolvedFont.italic) !== null && _f !== void 0 ? _f : null,\n            strikethrough: (_g = resolvedFont.strikethrough) !== null && _g !== void 0 ? _g : null,\n            color: (_h = resolvedFont.color) !== null && _h !== void 0 ? _h : null,\n        };\n    };\n    RenderService.prototype.convertModelToRenderPosition = function (modelPosition) {\n        return this.state.doc.convertModelToRenderPosition(modelPosition);\n    };\n    RenderService.prototype.convertRenderToModelPosition = function (renderPosition) {\n        return this.state.doc.convertRenderToModelPosition(renderPosition);\n    };\n    return RenderService;\n}());\nexport { RenderService };\n","var ServiceRegistry = /** @class */ (function () {\n    function ServiceRegistry() {\n        this.services = {};\n    }\n    ServiceRegistry.prototype.registerService = function (key, service) {\n        this.services[key] = service;\n    };\n    ServiceRegistry.prototype.getService = function (key) {\n        var service = this.services[key];\n        if (!service) {\n            throw new Error(\"Service \" + key + \" is not registered.\");\n        }\n        return service;\n    };\n    return ServiceRegistry;\n}());\nexport { ServiceRegistry };\n","import { EventEmitter } from '../event/emitter';\nvar TransformService = /** @class */ (function () {\n    function TransformService(modelService, componentService, cursorService, renderService, layoutService) {\n        this.modelService = modelService;\n        this.componentService = componentService;\n        this.cursorService = cursorService;\n        this.renderService = renderService;\n        this.layoutService = layoutService;\n        this.didApplyTransformationEventEmitter = new EventEmitter();\n    }\n    TransformService.prototype.applyTransformation = function (tn) {\n        var result = tn.apply(this.modelService, this.cursorService, this.renderService, this.layoutService);\n        this.didApplyTransformationEventEmitter.emit({ result: result });\n        return result;\n    };\n    TransformService.prototype.onDidApplyTransformation = function (listener) {\n        return this.didApplyTransformationEventEmitter.on(listener);\n    };\n    return TransformService;\n}());\nexport { TransformService };\n","var CursorView = /** @class */ (function () {\n    function CursorView(instanceId, configService, domService, cursorService, layoutService, viewService, transformService) {\n        var _this = this;\n        this.instanceId = instanceId;\n        this.configService = configService;\n        this.domService = domService;\n        this.cursorService = cursorService;\n        this.layoutService = layoutService;\n        this.viewService = viewService;\n        this.transformService = transformService;\n        this.blinkInterval = null;\n        this.blinkState = true;\n        this.domSelections = [];\n        this.attached = false;\n        var cursorConfig = configService.getConfig().cursor;\n        this.caretColor = cursorConfig.caretColor;\n        this.caretInactiveColor = cursorConfig.caretInactiveColor;\n        this.selectionColor = cursorConfig.selectionColor;\n        this.selectionInactiveColor = cursorConfig.selectionInactiveColor;\n        this.domCaret = domService.createElement('div');\n        this.domCaret.className = 'tw--cursor--caret';\n        this.domCaret.setAttribute('data-tw-instance', this.instanceId);\n        this.domCaret.style.position = 'absolute';\n        this.domCaret.style.userSelect = 'none';\n        this.domCaret.style.pointerEvents = 'none';\n        this.domCaret.style.width = '2px';\n        this.domCaret.style.marginLeft = '-1px';\n        transformService.onDidApplyTransformation(function (event) { return _this.handleDidApplyTransformation(event); });\n        viewService.onDidFocus(function (event) { return _this.handleDidFocus(event); });\n        viewService.onDidBlur(function (event) { return _this.handleDidBlur(event); });\n    }\n    CursorView.prototype.attach = function () {\n        if (this.attached) {\n            throw new Error('Already attached to the DOM.');\n        }\n        this.attached = true;\n        this.updateView();\n    };\n    CursorView.prototype.updateView = function () {\n        var _this = this;\n        if (!this.attached) {\n            return;\n        }\n        this.clearDOMSelections();\n        var _a = this.cursorService.getCursor(), anchor = _a.anchor, head = _a.head;\n        var from = Math.min(anchor, head);\n        var to = Math.max(anchor, head);\n        var docBoxResult = this.layoutService.resolveBoundingBoxes(from, to);\n        var viewDoc = this.viewService.getDoc();\n        var layoutDoc = this.layoutService.getDoc();\n        var focused = this.viewService.isFocused();\n        var firstPageId = '';\n        var firstBoxOffset = -1;\n        var lastPageId = '';\n        var lastBoxOffset = -1;\n        docBoxResult.children.forEach(function (pageBoxResult) {\n            var pageOffset = layoutDoc.children.indexOf(pageBoxResult.node);\n            var viewPage = viewDoc.children.at(pageOffset);\n            var domContentContainer = viewPage.domContentContainer;\n            pageBoxResult.boundingBoxes.forEach(function (box, boxOffset) {\n                if (!firstPageId) {\n                    firstPageId = pageBoxResult.node.id;\n                    firstBoxOffset = boxOffset;\n                }\n                lastPageId = pageBoxResult.node.id;\n                lastBoxOffset = boxOffset;\n                if (box.width === 0) {\n                    return;\n                }\n                var domSelection = _this.buildDOMSelection(box);\n                if (focused) {\n                    domSelection.style.background = _this.selectionColor;\n                }\n                else {\n                    domSelection.style.background = _this.selectionInactiveColor;\n                }\n                domContentContainer.appendChild(domSelection);\n                _this.domSelections.push(domSelection);\n            });\n        });\n        var headPageId;\n        var headLeft;\n        var headTop;\n        var headHeight;\n        if (head < anchor) {\n            headPageId = firstPageId;\n            var rect = docBoxResult.children.find(function (child) { return child.node.id === firstPageId; }).boundingBoxes[firstBoxOffset];\n            headLeft = rect.left;\n            headTop = rect.top;\n            headHeight = rect.height;\n        }\n        else {\n            headPageId = lastPageId;\n            var rect = docBoxResult.children.find(function (child) { return child.node.id === lastPageId; }).boundingBoxes[lastBoxOffset];\n            headLeft = rect.left + rect.width;\n            headTop = rect.top;\n            headHeight = rect.height;\n        }\n        if (head === anchor) {\n            this.domCaret.style.display = 'block';\n            this.domCaret.style.top = headTop + \"px\";\n            this.domCaret.style.left = headLeft + \"px\";\n            this.domCaret.style.height = headHeight + \"px\";\n            if (focused) {\n                this.domCaret.style.background = this.caretColor;\n            }\n            else {\n                this.domCaret.style.background = this.caretInactiveColor;\n            }\n            var pageDOMContentContainer = viewDoc.children.find(function (child) { return child.id === headPageId; })\n                .domContentContainer;\n            if (this.domCaret.parentElement && this.domCaret.parentElement !== pageDOMContentContainer) {\n                this.domCaret.parentElement.removeChild(this.domCaret);\n            }\n            if (!this.domCaret.parentElement) {\n                pageDOMContentContainer.appendChild(this.domCaret);\n            }\n            this.blinkStop();\n            if (focused) {\n                this.blinkStart();\n            }\n        }\n        else {\n            this.domCaret.style.display = 'none';\n            this.blinkStop();\n        }\n    };\n    CursorView.prototype.blinkStart = function () {\n        var _this = this;\n        if (this.blinkInterval !== null) {\n            return;\n        }\n        this.blinkState = true;\n        this.blinkInterval = window.setInterval(function () {\n            _this.blinkState = !_this.blinkState;\n            _this.updateDOMBlink();\n        }, 500);\n    };\n    CursorView.prototype.blinkStop = function () {\n        if (this.blinkInterval === null) {\n            return;\n        }\n        this.domCaret.style.visibility = 'visible';\n        clearInterval(this.blinkInterval);\n        this.blinkInterval = null;\n    };\n    CursorView.prototype.updateDOMBlink = function () {\n        if (this.blinkState) {\n            this.domCaret.style.visibility = 'visible';\n        }\n        else {\n            this.domCaret.style.visibility = 'hidden';\n        }\n    };\n    CursorView.prototype.clearDOMSelections = function () {\n        this.domSelections.forEach(function (domSelection) {\n            if (domSelection.parentElement) {\n                domSelection.parentElement.removeChild(domSelection);\n            }\n        });\n        this.domSelections = [];\n    };\n    CursorView.prototype.buildDOMSelection = function (box) {\n        var domSelection = document.createElement('div');\n        domSelection.className = 'tw--cursor--selection';\n        domSelection.setAttribute('data-tw-instance', this.instanceId);\n        domSelection.style.position = 'absolute';\n        domSelection.style.top = box.top + \"px\";\n        domSelection.style.left = box.left + \"px\";\n        domSelection.style.width = box.width + \"px\";\n        domSelection.style.height = box.height + \"px\";\n        domSelection.style.userSelect = 'none';\n        domSelection.style.pointerEvents = 'none';\n        return domSelection;\n    };\n    CursorView.prototype.handleDidApplyTransformation = function (event) {\n        this.updateView();\n    };\n    CursorView.prototype.handleDidFocus = function (event) {\n        this.updateView();\n    };\n    CursorView.prototype.handleDidBlur = function (event) {\n        this.updateView();\n    };\n    return CursorView;\n}());\nexport { CursorView };\n","import { EventEmitter } from '../event/emitter';\nvar ClipboardObserver = /** @class */ (function () {\n    function ClipboardObserver($contentEditable) {\n        var _this = this;\n        this.$contentEditable = $contentEditable;\n        this.didCopyEventEmitter = new EventEmitter();\n        this.didPasteEventEmitter = new EventEmitter();\n        this.handleCopy = function (event) {\n            event.preventDefault();\n            _this.didCopyEventEmitter.emit({});\n        };\n        this.handlePaste = function (event) {\n            event.preventDefault();\n            var data = event.clipboardData;\n            if (!data) {\n                return;\n            }\n            _this.didPasteEventEmitter.emit({ data: data });\n        };\n        $contentEditable.addEventListener('copy', this.handleCopy);\n        $contentEditable.addEventListener('paste', this.handlePaste);\n    }\n    ClipboardObserver.prototype.onDidCopy = function (listener) {\n        return this.didCopyEventEmitter.on(listener);\n    };\n    ClipboardObserver.prototype.onDidPaste = function (listener) {\n        return this.didPasteEventEmitter.on(listener);\n    };\n    return ClipboardObserver;\n}());\nexport { ClipboardObserver };\n","import { EventEmitter } from '../event/emitter';\nvar FocusObserver = /** @class */ (function () {\n    function FocusObserver($contentEditable) {\n        var _this = this;\n        this.$contentEditable = $contentEditable;\n        this.didFocusEventEmitter = new EventEmitter();\n        this.didBlurEventEmitter = new EventEmitter();\n        this.handleFocus = function () {\n            _this.didFocusEventEmitter.emit({});\n        };\n        this.handleBlur = function () {\n            _this.didBlurEventEmitter.emit({});\n        };\n        $contentEditable.addEventListener('focus', this.handleFocus);\n        $contentEditable.addEventListener('blur', this.handleBlur);\n    }\n    FocusObserver.prototype.onDidFocus = function (listener) {\n        return this.didFocusEventEmitter.on(listener);\n    };\n    FocusObserver.prototype.onDidBlur = function (listener) {\n        return this.didBlurEventEmitter.on(listener);\n    };\n    return FocusObserver;\n}());\nexport { FocusObserver };\n","import { EventEmitter } from '../event/emitter';\nimport { detectPlatform } from '../util/platform';\nvar KeyboardObserver = /** @class */ (function () {\n    function KeyboardObserver($contentEditable, domService) {\n        var _this = this;\n        this.$contentEditable = $contentEditable;\n        this.domService = domService;\n        this.composing = false;\n        this.didInsertEventEmitter = new EventEmitter();\n        this.didPressKeyEventEmitter = new EventEmitter();\n        this.compositionDidStartEventEmitter = new EventEmitter();\n        this.compositionDidEndEventEmitter = new EventEmitter();\n        this.keyInterpreter = new KeyInterpreter();\n        this.handleDidMutate = function () {\n            setTimeout(function () {\n                if (_this.composing) {\n                    return;\n                }\n                var content = _this.$contentEditable.innerText;\n                _this.$contentEditable.innerHTML = '';\n                if (content.length === 0) {\n                    return;\n                }\n                _this.didInsertEventEmitter.emit({ content: content });\n            });\n        };\n        this.handleKeyDown = function (event) {\n            var key = _this.keyInterpreter.interpretFromKeyboardEvent(event);\n            if (!key) {\n                return;\n            }\n            _this.didPressKeyEventEmitter.emit({ key: key, originalKeyboardEvent: event });\n        };\n        this.handleCompositionStart = function () {\n            _this.composing = true;\n        };\n        this.handleCompositionEnd = function () {\n            _this.composing = true;\n        };\n        this.mutationObserver = domService.createMutationObserver(this.handleDidMutate);\n        $contentEditable.addEventListener('keydown', this.handleKeyDown);\n        $contentEditable.addEventListener('compositionstart', this.handleCompositionStart);\n        $contentEditable.addEventListener('compositionend', this.handleCompositionEnd);\n        this.mutationObserver.observe($contentEditable, {\n            subtree: true,\n            characterData: true,\n            childList: true,\n        });\n    }\n    KeyboardObserver.prototype.onDidInsert = function (listener) {\n        return this.didInsertEventEmitter.on(listener);\n    };\n    KeyboardObserver.prototype.onDidPressKey = function (listener) {\n        return this.didPressKeyEventEmitter.on(listener);\n    };\n    KeyboardObserver.prototype.onCompositionDidStart = function (listener) {\n        return this.compositionDidStartEventEmitter.on(listener);\n    };\n    KeyboardObserver.prototype.onCompositionDidEnd = function (listener) {\n        return this.compositionDidEndEventEmitter.on(listener);\n    };\n    return KeyboardObserver;\n}());\nexport { KeyboardObserver };\nvar KeyInterpreter = /** @class */ (function () {\n    function KeyInterpreter() {\n    }\n    KeyInterpreter.prototype.interpretFromKeyboardEvent = function (event) {\n        var key;\n        switch (event.key) {\n            case 'Control':\n            case 'Shift':\n            case 'Alt':\n            case 'Meta':\n                return undefined;\n            case 'ArrowLeft':\n                key = 'left';\n                break;\n            case 'ArrowRight':\n                key = 'right';\n                break;\n            case 'ArrowUp':\n                key = 'up';\n                break;\n            case 'ArrowDown':\n                key = 'down';\n                break;\n            default:\n                key = event.key.toLowerCase();\n        }\n        if (event.metaKey) {\n            switch (detectPlatform()) {\n                case 'macOS':\n                    key = \"cmd+\" + key;\n                    break;\n                case 'Windows':\n                    key = \"win+\" + key;\n                    break;\n                case 'Linux':\n                default:\n                    key = \"meta+\" + key;\n            }\n        }\n        if (event.altKey) {\n            key = \"alt+\" + key;\n        }\n        if (event.shiftKey) {\n            key = \"shift+\" + key;\n        }\n        if (event.ctrlKey) {\n            key = \"ctrl+\" + key;\n        }\n        return key;\n    };\n    return KeyInterpreter;\n}());\n","import { EventEmitter } from '../event/emitter';\nvar PointerObserver = /** @class */ (function () {\n    function PointerObserver(instanceId, viewService, domService, layoutService) {\n        var _this = this;\n        this.instanceId = instanceId;\n        this.viewService = viewService;\n        this.domService = domService;\n        this.layoutService = layoutService;\n        this.clickThreshold = 250;\n        this.consecutiveClickThreshold = 250;\n        this.lastPointerDown = null;\n        this.lastClick = null;\n        this.consecutiveClickCount = 0;\n        this.pointerDidDownEventEmitter = new EventEmitter();\n        this.pointerDidMoveEventEmitter = new EventEmitter();\n        this.pointerDidUpEventEmitter = new EventEmitter();\n        this.pointerDidClickEventEmitter = new EventEmitter();\n        this.handleMouseDown = function (event) {\n            var offset = _this.resolveOffset(event.clientX, event.clientY);\n            if (offset === null) {\n                return;\n            }\n            // Bypass browser selection\n            event.preventDefault();\n            _this.lastPointerDown = {\n                timestamp: Date.now(),\n                offset: offset,\n            };\n            var consecutive = _this.lastClick !== null && Date.now() - _this.lastClick.timestamp < _this.consecutiveClickThreshold;\n            _this.pointerDidDownEventEmitter.emit({ offset: offset, consecutive: consecutive });\n        };\n        this.handleMouseMove = function (event) {\n            var offset = _this.resolveOffset(event.clientX, event.clientY);\n            if (offset === null) {\n                return;\n            }\n            _this.pointerDidMoveEventEmitter.emit({\n                pointerDown: _this.lastPointerDown !== null,\n                offset: offset,\n            });\n        };\n        this.handleMouseUp = function (event) {\n            if (_this.lastPointerDown === null) {\n                return;\n            }\n            var lastPointerDown = _this.lastPointerDown;\n            _this.lastPointerDown = null;\n            var offset = _this.resolveOffset(event.clientX, event.clientY);\n            if (offset === null) {\n                return;\n            }\n            var now = Date.now();\n            var clicked = lastPointerDown.offset === offset && now - lastPointerDown.timestamp < _this.clickThreshold;\n            _this.pointerDidUpEventEmitter.emit({});\n            if (clicked) {\n                if (_this.lastClick !== null) {\n                    var delta = now - _this.lastClick.timestamp;\n                    if (delta > _this.consecutiveClickThreshold) {\n                        _this.consecutiveClickCount = 0;\n                    }\n                }\n                _this.consecutiveClickCount++;\n                _this.lastClick = {\n                    timestamp: Date.now(),\n                    offset: offset,\n                };\n                _this.pointerDidClickEventEmitter.emit({\n                    offset: offset,\n                    consecutiveCount: _this.consecutiveClickCount,\n                });\n            }\n        };\n        var window = domService.getWindow();\n        window.addEventListener('mousedown', this.handleMouseDown);\n        window.addEventListener('mousemove', this.handleMouseMove);\n        window.addEventListener('mouseup', this.handleMouseUp);\n    }\n    PointerObserver.prototype.onPointerDidDown = function (listener) {\n        return this.pointerDidDownEventEmitter.on(listener);\n    };\n    PointerObserver.prototype.onPointerDidMove = function (listener) {\n        return this.pointerDidMoveEventEmitter.on(listener);\n    };\n    PointerObserver.prototype.onPointerDidUp = function (listener) {\n        return this.pointerDidUpEventEmitter.on(listener);\n    };\n    PointerObserver.prototype.onPointerDidClick = function (listener) {\n        return this.pointerDidClickEventEmitter.on(listener);\n    };\n    PointerObserver.prototype.resolveOffset = function (x, y) {\n        var viewDoc = this.viewService.getDoc();\n        var layoutDoc = this.layoutService.getDoc();\n        var cumulatedOffset = 0;\n        for (var n = 0, nn = viewDoc.children.length; n < nn; n++) {\n            var viewPage = viewDoc.children.at(n);\n            var layoutPage = layoutDoc.children.at(n);\n            var pageBoundingClientRect = viewPage.domContainer.getBoundingClientRect();\n            if (pageBoundingClientRect.left <= x &&\n                pageBoundingClientRect.right >= x &&\n                pageBoundingClientRect.top <= y &&\n                pageBoundingClientRect.bottom >= y) {\n                var pageX = x - pageBoundingClientRect.left;\n                var pageY = y - pageBoundingClientRect.top;\n                return cumulatedOffset + layoutPage.convertCoordinatesToPosition(pageX, pageY);\n            }\n            cumulatedOffset += layoutPage.size;\n        }\n        return null;\n    };\n    return PointerObserver;\n}());\nexport { PointerObserver };\n","import { ClipboardObserver } from './clipboard-observer';\nimport { FocusObserver } from './focus-observer';\nimport { KeyboardObserver, } from './keyboard-observer';\nimport { PointerObserver, } from './pointer-observer';\nvar DOMController = /** @class */ (function () {\n    function DOMController(instanceId, domService, commandService, modelService, viewService, layoutService) {\n        var _this = this;\n        this.instanceId = instanceId;\n        this.domService = domService;\n        this.commandService = commandService;\n        this.modelService = modelService;\n        this.viewService = viewService;\n        this.layoutService = layoutService;\n        this.focused = false;\n        this.composing = false;\n        this.mouseDown = false;\n        this.handleDidInsert = function (event) {\n            _this.commandService.executeCommand('tw.state.insert', event.content);\n        };\n        this.handleCompositionDidStart = function (event) {\n            _this.composing = true;\n        };\n        this.handleCompositionDidEnd = function (event) {\n            _this.composing = false;\n        };\n        this.handlePointerDidDown = function (event) {\n            if (!_this.focused) {\n                _this.commandService.executeCommand('tw.view.focus');\n            }\n            if (!event.consecutive) {\n                _this.commandService.executeCommand('tw.cursor.move', event.offset);\n            }\n        };\n        this.handlePointerDidMove = function (event) {\n            if (event.pointerDown) {\n                _this.commandService.executeCommand('tw.cursor.moveHead', event.offset);\n            }\n        };\n        this.handlePointerDidClick = function (event) {\n            switch (event.consecutiveCount) {\n                case 1:\n                    break;\n                case 2:\n                    _this.commandService.executeCommand('tw.cursor.selectWord', event.offset);\n                    break;\n                case 3:\n                    _this.commandService.executeCommand('tw.cursor.selectBlock', event.offset);\n                    break;\n                case 4:\n                default:\n                    _this.commandService.executeCommand('tw.cursor.selectAll');\n            }\n        };\n        this.handleDidFocus = function (event) {\n            _this.focused = true;\n        };\n        this.handleDidBlur = function (event) {\n            _this.focused = false;\n        };\n        this.handleCopy = function (event) {\n            _this.commandService.executeCommand('tw.clipboard.copy');\n        };\n        this.handlePaste = function (event) {\n            var html = event.data.getData('text/html');\n            var $container = _this.domService.createElement('html');\n            $container.innerHTML = html;\n            var $body = $container.querySelector('body');\n            if (!$body) {\n                return;\n            }\n            var domNodes = Array.prototype.slice.call($body.children);\n            console.log(domNodes);\n            // TODO\n        };\n        this.iframe = domService.createHiddenIframe();\n        this.$contentEditable = this.createContentEditable();\n        this.keyboardObserver = new KeyboardObserver(this.$contentEditable, domService);\n        this.keyboardObserver.onDidInsert(this.handleDidInsert);\n        this.keyboardObserver.onCompositionDidStart(this.handleCompositionDidStart);\n        this.keyboardObserver.onCompositionDidEnd(this.handleCompositionDidEnd);\n        this.pointerObserver = new PointerObserver(instanceId, viewService, domService, layoutService);\n        this.pointerObserver.onPointerDidDown(this.handlePointerDidDown);\n        this.pointerObserver.onPointerDidMove(this.handlePointerDidMove);\n        this.pointerObserver.onPointerDidClick(this.handlePointerDidClick);\n        this.focusObserver = new FocusObserver(this.$contentEditable);\n        this.focusObserver.onDidFocus(this.handleDidFocus);\n        this.focusObserver.onDidBlur(this.handleDidBlur);\n        this.clipboardObserver = new ClipboardObserver(this.$contentEditable);\n        this.clipboardObserver.onDidCopy(this.handleCopy);\n        this.clipboardObserver.onDidPaste(this.handlePaste);\n    }\n    DOMController.prototype.onDidPressKey = function (listener) {\n        this.keyboardObserver.onDidPressKey(listener);\n    };\n    DOMController.prototype.onDidFocus = function (listener) {\n        this.focusObserver.onDidFocus(listener);\n    };\n    DOMController.prototype.onDidBlur = function (listener) {\n        this.focusObserver.onDidBlur(listener);\n    };\n    DOMController.prototype.attach = function () {\n        var _this = this;\n        this.domService.getBody().appendChild(this.iframe);\n        setTimeout(function () {\n            _this.iframe.contentDocument.body.appendChild(_this.$contentEditable);\n        });\n    };\n    DOMController.prototype.requestFocus = function () {\n        this.$contentEditable.focus();\n    };\n    DOMController.prototype.requestBlur = function () {\n        this.$contentEditable.blur();\n    };\n    DOMController.prototype.isFocused = function () {\n        return this.focused;\n    };\n    DOMController.prototype.isComposing = function () {\n        return this.composing;\n    };\n    DOMController.prototype.createContentEditable = function () {\n        var $contentEditable = this.domService.createElement('div');\n        $contentEditable.contentEditable = 'true';\n        $contentEditable.style.whiteSpace = 'pre';\n        return $contentEditable;\n    };\n    return DOMController;\n}());\nexport { DOMController };\n","import { EventEmitter } from '../event/emitter';\nvar ViewState = /** @class */ (function () {\n    function ViewState(instanceId, componentService, layoutService, renderService, domService) {\n        var _this = this;\n        this.instanceId = instanceId;\n        this.componentService = componentService;\n        this.layoutService = layoutService;\n        this.renderService = renderService;\n        this.domService = domService;\n        this.didUpdateViewStateEventEmitter = new EventEmitter();\n        this.domContainer = null;\n        var layoutDoc = layoutService.getDoc();\n        var renderDoc = renderService.getDoc();\n        this.internalDoc = this.updateNode(null, layoutDoc, renderDoc);\n        layoutService.onDidUpdateLayoutState(function (event) { return _this.handleDidUpdateLayoutStateEvent(event); });\n    }\n    ViewState.prototype.onDidUpdateViewState = function (listener) {\n        return this.didUpdateViewStateEventEmitter.on(listener);\n    };\n    Object.defineProperty(ViewState.prototype, \"doc\", {\n        get: function () {\n            return this.internalDoc;\n        },\n        enumerable: false,\n        configurable: true\n    });\n    ViewState.prototype.attach = function (domContainer) {\n        this.domContainer = domContainer;\n        this.reattachDoc();\n    };\n    ViewState.prototype.handleDidUpdateLayoutStateEvent = function (event) {\n        this.update();\n    };\n    ViewState.prototype.update = function () {\n        var layoutDoc = this.layoutService.getDoc();\n        var renderDoc = this.renderService.getDoc();\n        this.internalDoc = this.updateNode(this.doc, layoutDoc, renderDoc);\n        this.reattachDoc();\n        this.didUpdateViewStateEventEmitter.emit({});\n    };\n    ViewState.prototype.reattachDoc = function () {\n        if (!this.domContainer) {\n            return;\n        }\n        this.domContainer.innerHTML = '';\n        this.domContainer.appendChild(this.doc.domContainer);\n    };\n    ViewState.prototype.updateNode = function (node, layoutNode, renderNode) {\n        var _this = this;\n        if (!layoutNode.needView && node) {\n            return node;\n        }\n        var childrenMap = {};\n        if (node) {\n            node.children.forEach(function (child) {\n                if (!child.layoutId) {\n                    return;\n                }\n                childrenMap[child.layoutId] = child;\n            });\n        }\n        var renderChildrenMap = {};\n        if (renderNode) {\n            renderNode.children.forEach(function (renderChild) {\n                renderChildrenMap[renderChild.id] = renderChild;\n            });\n        }\n        var newChildren = [];\n        if (layoutNode.type !== 'text') {\n            layoutNode.children.forEach(function (layoutChild) {\n                var child = childrenMap[layoutChild.id] || null;\n                var renderChild = null;\n                if (layoutChild.renderId) {\n                    renderChild = renderChildrenMap[layoutChild.renderId] || null;\n                    if (!renderChild) {\n                        throw new Error('Render node not found.');\n                    }\n                }\n                newChildren.push(_this.updateNode(child, layoutChild, renderChild || renderNode));\n            });\n        }\n        layoutNode.clearNeedView();\n        var domContainer = node ? node.domContainer : this.domService.createContainer();\n        var newNode = this.buildNode(domContainer, layoutNode, renderNode, newChildren);\n        return newNode;\n    };\n    ViewState.prototype.buildNode = function (domContainer, layoutNode, renderNode, children) {\n        switch (layoutNode.type) {\n            case 'page':\n                return this.buildPageNode(domContainer, layoutNode, children);\n            case 'line':\n                return this.buildLineNode(domContainer, layoutNode, children);\n        }\n        var component = this.componentService.getComponent(renderNode.componentId);\n        var text = layoutNode.type === 'text' ? layoutNode.children.map(function (child) { return child.text; }).join('') : layoutNode.text;\n        var node = component.buildViewNode(domContainer, renderNode.partId, renderNode.id, layoutNode.id, text, renderNode.style, children, layoutNode.width, layoutNode.height, layoutNode.paddingTop, layoutNode.paddingBottom, layoutNode.paddingLeft, layoutNode.paddingRight);\n        if (!node) {\n            throw new Error(\"Error building view node from render node \" + renderNode.id + \".\");\n        }\n        this.applyMetadataToDOMContainer(node);\n        return node;\n    };\n    ViewState.prototype.buildPageNode = function (domContainer, layoutNode, children) {\n        var node = this.componentService\n            .getPageComponent()\n            .buildViewNode(domContainer, layoutNode.id, children, layoutNode.width, layoutNode.height, layoutNode.paddingTop, layoutNode.paddingBottom, layoutNode.paddingLeft, layoutNode.paddingRight);\n        this.applyMetadataToDOMContainer(node);\n        return node;\n    };\n    ViewState.prototype.buildLineNode = function (domContainer, layoutNode, children) {\n        var node = this.componentService\n            .getLineComponent()\n            .buildViewNode(domContainer, layoutNode.id, children, layoutNode.width, layoutNode.height, layoutNode.paddingTop, layoutNode.paddingBottom, layoutNode.paddingLeft, layoutNode.paddingRight);\n        this.applyMetadataToDOMContainer(node);\n        return node;\n    };\n    ViewState.prototype.applyMetadataToDOMContainer = function (viewNode) {\n        var domContainer = viewNode.domContainer;\n        var componentId = viewNode.componentId;\n        var partId = viewNode.partId;\n        var id = viewNode.id;\n        domContainer.className = \"tw--\" + componentId + \"--\" + partId;\n        domContainer.setAttribute('data-tw-instance', this.instanceId);\n        if (componentId) {\n            domContainer.setAttribute('data-tw-component', componentId);\n        }\n        if (partId) {\n            domContainer.setAttribute('data-tw-part', partId);\n        }\n        domContainer.setAttribute('data-tw-id', id);\n    };\n    return ViewState;\n}());\nexport { ViewState };\n","import { CursorView } from './cursor';\nimport { DOMController } from './dom-controller';\nimport { ViewState } from './state';\nvar ViewService = /** @class */ (function () {\n    function ViewService(instanceId, configService, domService, componentService, modelService, layoutService, cursorService, renderService, commandService, transformService) {\n        this.state = new ViewState(instanceId, componentService, layoutService, renderService, domService);\n        this.domController = new DOMController(instanceId, domService, commandService, modelService, this, layoutService);\n        this.cursor = new CursorView(instanceId, configService, domService, cursorService, layoutService, this, transformService);\n    }\n    ViewService.prototype.onDidUpdateViewState = function (listener) {\n        this.state.onDidUpdateViewState(listener);\n    };\n    ViewService.prototype.onDidFocus = function (listener) {\n        this.domController.onDidFocus(listener);\n    };\n    ViewService.prototype.onDidBlur = function (listener) {\n        this.domController.onDidBlur(listener);\n    };\n    ViewService.prototype.onDidPressKey = function (listener) {\n        this.domController.onDidPressKey(listener);\n    };\n    ViewService.prototype.getDoc = function () {\n        return this.state.doc;\n    };\n    ViewService.prototype.isFocused = function () {\n        return this.domController.isFocused();\n    };\n    ViewService.prototype.attach = function (domContainer) {\n        this.state.attach(domContainer);\n        this.cursor.attach();\n        this.domController.attach();\n    };\n    ViewService.prototype.requestFocus = function () {\n        this.domController.requestFocus();\n    };\n    ViewService.prototype.requestBlur = function () {\n        this.domController.requestBlur();\n    };\n    return ViewService;\n}());\nexport { ViewService };\n","import { CommandService } from './command/service';\nimport { ComponentService } from './component/service';\nimport { ConfigService } from './config/service';\nimport { buildBaseConfig } from './config/util';\nimport { CursorService } from './cursor/service';\nimport { DOMService } from './dom/service';\nimport { HistoryService } from './history/service';\nimport { KeyBindingService } from './key-binding/service';\nimport { LayoutService } from './layout/service';\nimport { ModelService } from './model/service';\nimport { RenderService } from './render/service';\nimport { ServiceRegistry } from './service/registry';\nimport { TextService } from './text/service';\nimport { TransformService } from './transform/service';\nimport { generateId } from './util/id';\nimport { ViewService } from './view/service';\nvar Taleweaver = /** @class */ (function () {\n    function Taleweaver(root, config) {\n        this.instanceId = generateId();\n        this.serviceRegistry = new ServiceRegistry();\n        this.configService = new ConfigService(buildBaseConfig(), config);\n        this.serviceRegistry.registerService('config', this.configService);\n        this.domService = new DOMService();\n        this.serviceRegistry.registerService('dom', this.domService);\n        this.textService = new TextService(this.domService);\n        this.serviceRegistry.registerService('text', this.textService);\n        this.commandService = new CommandService(this.configService, this.serviceRegistry);\n        this.serviceRegistry.registerService('command', this.commandService);\n        this.componentService = new ComponentService(this.configService, this.serviceRegistry);\n        this.serviceRegistry.registerService('component', this.componentService);\n        this.modelService = new ModelService(root, this.componentService);\n        this.serviceRegistry.registerService('model', this.modelService);\n        this.renderService = new RenderService(this.componentService, this.modelService);\n        this.serviceRegistry.registerService('render', this.renderService);\n        this.cursorService = new CursorService(this.configService, this.renderService, this.modelService);\n        this.serviceRegistry.registerService('cursor', this.cursorService);\n        this.layoutService = new LayoutService(this.renderService, this.textService);\n        this.serviceRegistry.registerService('layout', this.layoutService);\n        this.transformService = new TransformService(this.modelService, this.componentService, this.cursorService, this.renderService, this.layoutService);\n        this.serviceRegistry.registerService('transform', this.transformService);\n        this.viewService = new ViewService(this.instanceId, this.configService, this.domService, this.componentService, this.modelService, this.layoutService, this.cursorService, this.renderService, this.commandService, this.transformService);\n        this.serviceRegistry.registerService('view', this.viewService);\n        this.historyService = new HistoryService(this.configService, this.transformService);\n        this.serviceRegistry.registerService('history', this.historyService);\n        this.keyBindingService = new KeyBindingService(this.configService, this.commandService, this.viewService);\n        this.serviceRegistry.registerService('keyBinding', this.keyBindingService);\n    }\n    Taleweaver.prototype.attach = function (domContainer) {\n        this.viewService.attach(domContainer);\n    };\n    Taleweaver.prototype.getServiceRegistry = function () {\n        return this.serviceRegistry;\n    };\n    return Taleweaver;\n}());\nexport { Taleweaver };\n","import { Taleweaver } from '@taleweaver/core';\nimport { IResolvedFont } from '@taleweaver/core/dist/tw/render/service';\nimport React, { useCallback, useEffect, useState } from 'react';\nimport styled from 'styled-components';\n\nconst Wrapper = styled.div`\n    position: sticky;\n    top: 0;\n    padding: 3px 24px;\n    background: white;\n    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.09);\n    z-index: 10;\n`;\n\nconst Container = styled.div`\n    display: flex;\n    margin: 0 auto;\n    width: 816px;\n`;\n\nconst Group = styled.div`\n    flex: 0 0 auto;\n    display: flex;\n    border-radius: 4px;\n    padding: 0 6px;\n    position: relative;\n    &::before {\n        content: '';\n        position: absolute;\n        top: 9px;\n        bottom: 9px;\n        left: 0;\n        width: 1px;\n        background: rgba(0, 0, 0, 0.15);\n    }\n    &:last-child {\n        &::after {\n            content: '';\n            position: absolute;\n            top: 9px;\n            bottom: 9px;\n            right: 0;\n            width: 1px;\n            background: rgba(0, 0, 0, 0.15);\n        }\n    }\n`;\n\ninterface ItemProps {\n    disabled: boolean;\n    active: boolean;\n}\n\nconst Item = styled.button<ItemProps>`\n    flex: 0 0 auto;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    width: 36px;\n    height: 36px;\n    font-size: 18px;\n    position: relative;\n    color: rgba(0, 0, 0, 0.85);\n    background: transparent;\n    padding: 0;\n    border: none;\n    border-radius: 3px;\n    outline: none;\n    &:after {\n        content: '';\n        position: absolute;\n        bottom: 0;\n        left: 3px;\n        right: 3px;\n        height: 3px;\n    }\n    &:hover,\n    &:focus {\n        background: rgba(0, 0, 0, 0.04);\n    }\n    ${({ disabled }) =>\n        disabled &&\n        `\n        opacity: 0.45;\n        &:hover,\n        &:focus {\n            background: transparent;\n        }\n    `}\n    ${({ active }) =>\n        active &&\n        `\n        color: rgba(255, 0, 0, 1);\n        &:after {\n            background: rgba(255, 0, 0, 1);\n        }\n    `}\n`;\n\ninterface SelectItemProps {\n    disabled: boolean;\n    width: number;\n}\n\nconst SelectItem = styled.select<SelectItemProps>`\n    -webkit-appearance: none;\n    border: none;\n    font-size: 12px;\n    font-weight: 500;\n    width: ${({ width }) => width}px;\n    background: white;\n    border-radius: 3px;\n    padding: 0 9px;\n    outline: none;\n    position: relative;\n    &:hover,\n    &:focus {\n        background: rgba(0, 0, 0, 0.04);\n    }\n    option {\n        color: rgba(0, 0, 0, 0.85);\n    }\n    ${({ disabled }) =>\n        disabled &&\n        `\n        opacity: 0.45;\n        &:hover,\n        &:focus {\n            background: transparent;\n        }\n    `}\n`;\n\ninterface ItemColorLineProps {\n    color: string;\n}\n\nconst ItemColorLine = styled.div<ItemColorLineProps>`\n    position: absolute;\n    bottom: 8px;\n    left: 9px;\n    right: 9px;\n    height: 3px;\n    background: ${({ color }) => color};\n`;\n\ninterface Props {\n    taleweaver: Taleweaver | null;\n}\n\nfunction resolveFont(taleweaver: Taleweaver) {\n    const cursorService = taleweaver.getServiceRegistry().getService('cursor');\n    const renderService = taleweaver.getServiceRegistry().getService('render');\n    const { anchor, head } = cursorService.getCursor();\n    return renderService.resolveFont(Math.min(anchor, head), Math.max(anchor, head));\n}\n\nexport default function ToolBar({ taleweaver }: Props) {\n    const [font, setFont] = useState<IResolvedFont | null>(null);\n    const refreshFront = useCallback((taleweaver: Taleweaver) => {\n        setFont(resolveFont(taleweaver));\n    }, []);\n    useEffect(() => {\n        if (!taleweaver) {\n            return;\n        }\n        const cursorService = taleweaver.getServiceRegistry().getService('cursor');\n        const renderService = taleweaver.getServiceRegistry().getService('render');\n        cursorService.onDidUpdate((event) => refreshFront(taleweaver));\n        renderService.onDidUpdateRenderState((event) => refreshFront(taleweaver));\n        refreshFront(taleweaver);\n    }, [taleweaver, refreshFront]);\n    const commandService = taleweaver?.getServiceRegistry().getService('command');\n    if (!font) {\n        return null;\n    }\n    return (\n        <Wrapper>\n            <Container>\n                <Group>\n                    <SelectItem width={120} value={'Normal'} disabled={false} onChange={(event) => null}>\n                        <option value=\"\" style={{ display: 'none' }}></option>\n                        <option value=\"Normal\">Normal text</option>\n                        <option value=\"Title\">Title</option>\n                        <option value=\"Subtitle\">Subtitle</option>\n                        <option value=\"Heading 1\">Heading 1</option>\n                        <option value=\"Heading 2\">Heading 2</option>\n                        <option value=\"Heading 3\">Heading 3</option>\n                    </SelectItem>\n                </Group>\n                <Group>\n                    <SelectItem\n                        width={120}\n                        value={font.family || ''}\n                        disabled={font.family === null}\n                        onChange={(event) => null}\n                    >\n                        <option value=\"\" style={{ display: 'none' }}></option>\n                        <option value=\"sans-serif\">sans-serif</option>\n                    </SelectItem>\n                </Group>\n                <Group>\n                    <SelectItem\n                        width={60}\n                        value={font.size ? font.size.toString() : ''}\n                        disabled={font.size === null}\n                        onChange={(event) => null}\n                    >\n                        <option value=\"\" style={{ display: 'hidden' }} />\n                        <option value=\"10\">10</option>\n                        <option value=\"12\">12</option>\n                        <option value=\"14\">14</option>\n                        <option value=\"16\">16</option>\n                        <option value=\"18\">18</option>\n                        <option value=\"24\">24</option>\n                        <option value=\"30\">30</option>\n                        <option value=\"36\">36</option>\n                        <option value=\"42\">42</option>\n                    </SelectItem>\n                </Group>\n                <Group>\n                    <Item\n                        active={!!font.weight && font.weight > 400}\n                        disabled={false}\n                        onClick={() =>\n                            commandService!.executeCommand(\n                                'tw.state.applyAttribute',\n                                'text',\n                                'text',\n                                'weight',\n                                font.weight && font.weight > 400 ? 400 : 700,\n                            )\n                        }\n                    >\n                        <i className=\"mdi mdi-format-bold\" />\n                    </Item>\n                    <Item\n                        active={!!font.italic}\n                        disabled={false}\n                        onClick={() =>\n                            commandService!.executeCommand(\n                                'tw.state.applyAttribute',\n                                'text',\n                                'text',\n                                'italic',\n                                !font.italic,\n                            )\n                        }\n                    >\n                        <i className=\"mdi mdi-format-italic\" />\n                    </Item>\n                    <Item\n                        active={!!font.underline}\n                        disabled={false}\n                        onClick={() =>\n                            commandService!.executeCommand(\n                                'tw.state.applyAttribute',\n                                'text',\n                                'text',\n                                'underline',\n                                !font.underline,\n                            )\n                        }\n                    >\n                        <i className=\"mdi mdi-format-underline\" />\n                    </Item>\n                    <Item\n                        active={!!font.strikethrough}\n                        disabled={false}\n                        onClick={() =>\n                            commandService!.executeCommand(\n                                'tw.state.applyAttribute',\n                                'text',\n                                'text',\n                                'strikethrough',\n                                !font.strikethrough,\n                            )\n                        }\n                    >\n                        <i className=\"mdi mdi-format-strikethrough-variant\" />\n                    </Item>\n                    <Item active={false} disabled={font.color === null} onClick={() => null}>\n                        <i className=\"mdi mdi-format-color-text\" style={{ position: 'relative', top: '-2px' }} />\n                        <ItemColorLine color={font.color || 'transparent'} />\n                    </Item>\n                </Group>\n            </Container>\n        </Wrapper>\n    );\n}\n","import { IConfig, Taleweaver } from '@taleweaver/core';\nimport { INode, parse } from '@taleweaver/core/dist/tw/util/serialize';\nimport React, { useEffect, useRef, useState } from 'react';\nimport styled from 'styled-components';\nimport ToolBar from './ToolBar';\n\nconst Wrapper = styled.div``;\n\nconst EditorWrapper = styled.div`\n    text-align: center;\n    .tw--doc--doc {\n        font-family: 'Source Sans Pro', sans-serif;\n        display: inline-block;\n        padding-bottom: 9px;\n        counter-reset: page-counter;\n    }\n    .tw--page--page {\n        background: rgba(255, 255, 255, 1);\n        margin: 9px auto 0;\n        box-shadow: 0 1px 3px rgba(0, 0, 0, 0.15);\n        position: relative;\n        &::after {\n            counter-increment: page-counter;\n            content: 'Page ' counter(page-counter) '';\n            position: absolute;\n            top: 12px;\n            left: 50%;\n            transform: translateX(-50%);\n            font-size: 10px;\n            font-family: 'Quicksand', sans-serif;\n            font-weight: 500;\n            color: rgba(0, 0, 0, 0.45);\n            pointer-events: none;\n        }\n        *::selection {\n            background: rgba(255, 255, 255, 1);\n        }\n    }\n`;\n\ninterface IProps {\n    initialDoc: INode;\n    config?: IConfig['tw.core'];\n}\n\nexport default function Editor({ initialDoc, config }: IProps) {\n    const containerRef = useRef<HTMLDivElement>(null);\n    const container = containerRef.current;\n    const [taleweaver, setTaleweaver] = useState<Taleweaver | null>(null);\n    useEffect(() => {\n        const mergedConfig: IConfig = {};\n        if (config) {\n            mergedConfig['tw.core'] = config;\n        }\n        const doc = parse(initialDoc, mergedConfig);\n        setTaleweaver(new Taleweaver(doc, mergedConfig));\n    }, [config, initialDoc]);\n    useEffect(() => {\n        if (taleweaver && container) {\n            taleweaver.attach(container);\n        }\n    }, [taleweaver, container, initialDoc]);\n    return (\n        <Wrapper>\n            <ToolBar taleweaver={taleweaver} />\n            <EditorWrapper ref={containerRef} />\n        </Wrapper>\n    );\n}\n","import Taleweaver from \"./Editor\";\n\nexport default Taleweaver;\n","import { ComponentService } from '../component/service';\nimport { ConfigService } from '../config/service';\nimport { buildBaseConfig } from '../config/util';\nimport { ServiceRegistry } from '../service/registry';\nexport function parse(node, config) {\n    var serviceRegistry = new ServiceRegistry();\n    var configService = new ConfigService(buildBaseConfig(), config);\n    var componentService = new ComponentService(configService, serviceRegistry);\n    function internalParse(node) {\n        return componentService.getComponent(node.componentId).buildModelNode(node.partId, node.id, node.text, node.attributes, node.children.map(function (child) { return internalParse(child); }));\n    }\n    return internalParse(node);\n}\n","import { generateId } from '@taleweaver/core/dist/tw/util/id';\nimport { INode } from '@taleweaver/core/dist/tw/util/serialize';\n\nconst doc: INode = {\n    componentId: 'doc',\n    partId: 'doc',\n    id: generateId(),\n    text: '',\n    attributes: {},\n    children: [\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        'Once upon a time there lived in a certain village a little country girl, the prettiest creature was ever seen. Her mother was excessively fond of her; and her grandmother doted on her still more. This good woman had made for her a little red riding-hood; which became the girl so extremely well that everybody called her Little Red Riding-Hood.',\n                    attributes: { weight: 700 },\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: 'One day her mother, having made some custards, said to her:',\n                    attributes: { italic: true },\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        '\"Go, my dear, and see how thy grandmamma does, for I hear she has been very ill; carry her a custard, and this little pot of butter.\"',\n                    attributes: { color: 'rgba(255, 0, 0, 1)' },\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        'Little Red Riding-Hood set out immediately to go to her grandmother, who lived in another village.',\n                    attributes: { size: 24 },\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        'As she was going through the wood, she met with Gaffer Wolf, who had a very great mind to eat her up, but he dared not, because of some faggot-makers hard by in the forest. He asked her whither she was going. The poor child, who did not know that it was dangerous to stay and hear a wolf talk, said to him:',\n                    attributes: { strikethrough: true, underline: true },\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        '\"I am going to see my grandmamma and carry her a custard and a little pot of butter from my mamma.\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: '\"Does she live far off?\" said the Wolf.',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        '\"Oh! ay,\" answered Little Red Riding-Hood; \"it is beyond that mill you see there, at the first house in the village.\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        '\"Well,\" said the Wolf, \"and I\\'ll go and see her too. I\\'ll go this way and you go that, and we shall see who will be there soonest.\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        \"The Wolf began to run as fast as he could, taking the nearest way, and the little girl went by that farthest about, diverting herself in gathering nuts, running after butterflies, and making nosegays of such little flowers as she met with. The Wolf was not long before he got to the old woman's house. He knocked at the door--tap, tap.\",\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        '\"Your grandchild, Little Red Riding-Hood,\" replied the Wolf, counterfeiting her voice; \"who has brought you a custard and a little pot of butter sent you by mamma.\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: 'The good grandmother, who was in bed, because she was somewhat ill, cried out',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: '\"Pull the bobbin, and the latch will go up.\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        \"The Wolf pulled the bobbin, and the door opened, and then presently he fell upon the good woman and ate her up in a moment, for it was above three days that he had not touched a bit. He then shut the door and went into the grandmother's bed, expecting Little Red Riding- Hood, who came some time afterward and knocked at the door--tap, tap.\",\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: '\"Who\\'s there?\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        'Little Red Riding-Hood, hearing the big voice of the Wolf, was at first afraid; but believing her grandmother had got a cold and was hoarse, answered:',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        '\" \\'Tis your grandchild, Little Red Riding-Hood, who has brought you a custard and a little pot of butter mamma sends you.\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: 'The Wolf cried out to her, softening his voice as much as he could:',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: '\"Pull the bobbin, and the latch will go up.\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: 'Little Red Riding-Hood pulled the bobbin, and the door opened.',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: 'The Wolf, seeing her come in, said to her, hiding himself under the bed-clothes:',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        '\"Put the custard and the little pot of butter upon the stool, and come and lie down with me.\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        'Little Red Riding-Hood undressed herself and went into bed, where, being greatly amazed to see how her grandmother looked in her night-clothes, she said to her:',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: '\"Grandmamma, what great arms you have got!\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: '\"That is the better to hug thee, my dear.\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: '\"Grandmamma, what great legs you have got!\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: '\"That is to run the better, my child.\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: '\"Grandmamma, what great ears you have got!\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: '\"That is to hear the better, my child.\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: '\"Grandmamma, what great eyes you have got!\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: '\"It is to see the better, my child.\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: '\"Grandmamma, what great teeth you have got!\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text: '\"That is to eat thee up.\"',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n        {\n            componentId: 'paragraph',\n            partId: 'paragraph',\n            id: generateId(),\n            text: '',\n            attributes: {},\n            children: [\n                {\n                    componentId: 'text',\n                    partId: 'text',\n                    id: generateId(),\n                    text:\n                        'And, saying these words, this wicked wolf fell upon Little Red Riding-Hood, and ate her all up.',\n                    attributes: {},\n                    children: [],\n                },\n            ],\n        },\n    ],\n};\n\nexport default doc;\n","import React from 'react';\nimport styled from 'styled-components';\nimport './App.css';\nimport Taleweaver from './Editor';\nimport sample from './samples/littleRedRidingHood';\n\nconst Wrapper = styled.div``;\n\nconst Hero = styled.div`\n    text-align: center;\n    padding: 90px 60px 30px;\n`;\n\nconst BrandWrapper = styled.div``;\n\nconst Brand = styled.span`\n    color: rgba(0, 0, 0, 0.65);\n    font-size: 42px;\n    letter-spacing: 0.02em;\n    padding-bottom: 10px;\n    border-bottom: 2px solid rgba(0, 0, 0, 0.65);\n`;\n\nconst Tagline = styled.h1`\n    font-size: 30px;\n    font-weight: 500;\n    color: rgba(0, 0, 0, 0.85);\n    margin: 90px 0 0;\n`;\n\nconst SupportingTagline = styled.h2`\n    font-size: 20px;\n    font-weight: 400;\n    color: rgba(0, 0, 0, 0.85);\n    margin: 30px 0 0;\n`;\n\nconst Links = styled.div`\n    margin-top: 90px;\n`;\n\nconst Link = styled.a`\n    display: inline-block;\n    padding: 15px 60px;\n    outline: none;\n    color: rgba(0, 0, 0, 0.85);\n    text-decoration: none;\n    font-size: 20px;\n    background: transparent;\n    border-radius: 3px;\n    border: 1px solid rgba(0, 0, 0, 0.15);\n    &:hover {\n        color: rgba(0, 0, 0, 1);\n        background: rgba(0, 0, 0, 0.04);\n        border-color: rgba(0, 0, 0, 0.25);\n    }\n`;\n\nconst DemoHintWrapper = styled.div`\n    text-align: center;\n    margin-top: 90px;\n`;\n\nconst DemoHint = styled.span`\n    text-transform: uppercase;\n    font-weight: 500;\n    font-size: 14px;\n    color: rgba(0, 0, 0, 0.65);\n    border-top: 1px solid rgba(0, 0, 0, 0.45);\n    padding-top: 10px;\n    cursor: default;\n`;\n\nclass App extends React.Component {\n    render() {\n        return (\n            <Wrapper>\n                <Hero>\n                    <BrandWrapper>\n                        <Brand>Taleweaver</Brand>\n                    </BrandWrapper>\n                    <Tagline>Word processing in your browser.</Tagline>\n                    <SupportingTagline>\n                        Open source editor delivering true word processing experience.\n                    </SupportingTagline>\n                    <Links>\n                        <Link href=\"https://github.com/yuzhenmi/taleweaver\">GitHub</Link>\n                    </Links>\n                    <DemoHintWrapper>\n                        <DemoHint>&darr; Check it out &darr;</DemoHint>\n                    </DemoHintWrapper>\n                </Hero>\n                <Taleweaver\n                    initialDoc={sample}\n                    config={{\n                        page: {\n                            width: 816,\n                            height: 1056,\n                            paddingTop: 60,\n                            paddingBottom: 60,\n                            paddingLeft: 60,\n                            paddingRight: 60,\n                        },\n                    }}\n                />\n            </Wrapper>\n        );\n    }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}